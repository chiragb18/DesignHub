import{$ as eo,$a as P,A as ea,Aa as ie,B as Bc,Ba as eu,C as Kt,Ca as Jr,D as Ji,Da as tu,E as Tt,Ea as aa,F as ne,Fa as Me,G as ta,Ga as we,H as _n,Ha as ge,I as V,Ia as pt,J as _e,Ja as At,K as Vc,Ka as nu,L as K,La as Qr,M as W,Ma as ru,N as A,Na as oo,O as Qi,Oa as iu,P as zc,Pa as la,Q as Cn,Qa as ca,R as Xe,Ra as he,S as L,Sa as b,T as U,Ta as C,U as cr,Ua as Pe,V as Ce,Va as tt,W as Kr,Wa as Zt,X as $c,Xa as so,Y as gt,Ya as Ue,Z as ur,Za as E,_ as na,_a as ao,a as p,aa as Hc,ab as wn,b as D,ba as re,bb as Z,c as te,ca as Gc,cb as x,d as kc,da as Wc,db as kt,e as Fc,ea as De,eb as xn,f as Pc,fa as Zr,fb as Ft,g as ft,ga as Ot,gb as Pt,h as Ge,ha as hr,hb as It,i as We,ia as Yc,ib as Jt,j as Ye,ja as ra,jb as ou,k as $,ka as Xc,kb as Sn,l as Ic,la as to,lb as su,m as Zs,ma as qc,mb as gr,n as Rc,na as ia,nb as au,o as ye,oa as no,ob as lu,p as Lc,pa as Kc,pb as ua,q as Xt,qa as Zc,r as Uc,ra as F,s as Zi,sa as dr,t as jc,ta as Jc,u as ar,ua as Qc,v as Js,va as oa,w as Qs,wa as ro,x as lr,xa as sa,y as Nc,ya as io,z as qt,za as fr}from"./chunk-AK5DQ6RF.js";var cu=null;function qe(){return cu}function ha(i){cu??=i}var ei=class{},lo=(()=>{class i{historyGo(t){throw new Error("")}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:()=>A(uu),providedIn:"platform"})}return i})();var uu=(()=>{class i extends lo{_location;_history;_doc=A(Ce);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return qe().getBaseHref(this._doc)}onPopState(t){let n=qe().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){let n=qe().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,r){this._history.pushState(t,n,r)}replaceState(t,n,r){this._history.replaceState(t,n,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:()=>new i,providedIn:"platform"})}return i})();function fu(i,e){return i?e?i.endsWith("/")?e.startsWith("/")?i+e.slice(1):i+e:e.startsWith("/")?i+e:`${i}/${e}`:i:e}function hu(i){let e=i.search(/#|\?|$/);return i[e-1]==="/"?i.slice(0,e-1)+i.slice(e):i}function Qt(i){return i&&i[0]!=="?"?`?${i}`:i}var co=(()=>{class i{historyGo(t){throw new Error("")}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:()=>A(Zf),providedIn:"root"})}return i})(),Kf=new K(""),Zf=(()=>{class i extends co{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,n){super(),this._platformLocation=t,this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??A(Ce).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return fu(this._baseHref,t)}path(t=!1){let n=this._platformLocation.pathname+Qt(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,o){let s=this.prepareExternalUrl(r+Qt(o));this._platformLocation.pushState(t,n,s)}replaceState(t,n,r,o){let s=this.prepareExternalUrl(r+Qt(o));this._platformLocation.replaceState(t,n,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(n){return new(n||i)(W(lo),W(Kf,8))};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),pr=(()=>{class i{_subject=new ft;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let n=this._locationStrategy.getBaseHref();this._basePath=eg(hu(du(n))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+Qt(n))}normalize(t){return i.stripTrailingSlash(Qf(this._basePath,du(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Qt(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Qt(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{let n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n??void 0,complete:r??void 0})}static normalizeQueryParams=Qt;static joinWithSlash=fu;static stripTrailingSlash=hu;static \u0275fac=function(n){return new(n||i)(W(co))};static \u0275prov=V({token:i,factory:()=>Jf(),providedIn:"root"})}return i})();function Jf(){return new pr(W(co))}function Qf(i,e){if(!i||!e.startsWith(i))return e;let t=e.substring(i.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function du(i){return i.replace(/\/index.html$/,"")}function eg(i){if(new RegExp("^(https?:)?//").test(i)){let[,t]=i.split(/\/\/[^\/]+/);return t}return i}var uo=class{$implicit;ngForOf;index;count;constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},fo=(()=>{class i{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let n=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)n.createEmbeddedView(this._template,new uo(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)n.remove(o===null?void 0:o);else if(o!==null){let a=n.get(o);n.move(a,s),gu(a,r)}});for(let r=0,o=n.length;r<o;r++){let a=n.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=n.get(r.currentIndex);gu(o,r)})}static ngTemplateContextGuard(t,n){return!0}static \u0275fac=function(n){return new(n||i)(ie(Jr),ie(sa),ie(au))};static \u0275dir=ge({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return i})();function gu(i,e){i.context.$implicit=e.item}var ti=(()=>{class i{_viewContainer;_context=new ho;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,n){this._viewContainer=t,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){pu(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){pu(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,n){return!0}static \u0275fac=function(n){return new(n||i)(ie(Jr),ie(sa))};static \u0275dir=ge({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return i})(),ho=class{$implicit=null;ngIf=null};function pu(i,e){if(i&&!i.createEmbeddedView)throw new ne(2020,!1)}var mt=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=_e({})}return i})();function da(i,e){e=encodeURIComponent(e);for(let t of i.split(";")){let n=t.indexOf("="),[r,o]=n==-1?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var ni=class{};var mu="browser";var ri=class{_doc;constructor(e){this._doc=e}manager},go=(()=>{class i extends ri{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r,o){return t.addEventListener(n,r,o),()=>this.removeEventListener(t,n,r,o)}removeEventListener(t,n,r,o){return t.removeEventListener(n,r,o)}static \u0275fac=function(n){return new(n||i)(W(Ce))};static \u0275prov=V({token:i,factory:i.\u0275fac})}return i})(),vo=new K(""),va=(()=>{class i{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,n){this._zone=n,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof go));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof go);o&&this._plugins.push(o)}addEventListener(t,n,r,o){return this._findPluginFor(n).addEventListener(t,n,r,o)}getZone(){return this._zone}_findPluginFor(t){let n=this._eventNameToPlugin.get(t);if(n)return n;if(n=this._plugins.find(o=>o.supports(t)),!n)throw new ne(5101,!1);return this._eventNameToPlugin.set(t,n),n}static \u0275fac=function(n){return new(n||i)(W(vo),W(ur))};static \u0275prov=V({token:i,factory:i.\u0275fac})}return i})(),ga="ng-app-id";function vu(i){for(let e of i)e.remove()}function bu(i,e){let t=e.createElement("style");return t.textContent=i,t}function tg(i,e,t,n){let r=i.head?.querySelectorAll(`style[${ga}="${e}"],link[${ga}="${e}"]`);if(r)for(let o of r)o.removeAttribute(ga),o instanceof HTMLLinkElement?n.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function ma(i,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",i),t}var ba=(()=>{class i{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,n,r,o={}){this.doc=t,this.appId=n,this.nonce=r,tg(t,n,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,n){for(let r of t)this.addUsage(r,this.inline,bu);n?.forEach(r=>this.addUsage(r,this.external,ma))}removeStyles(t,n){for(let r of t)this.removeUsage(r,this.inline);n?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,n,r){let o=n.get(t);o?o.usage++:n.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,n){let r=n.get(t);r&&(r.usage--,r.usage<=0&&(vu(r.elements),n.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])vu(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[n,{elements:r}]of this.inline)r.push(this.addElement(t,bu(n,this.doc)));for(let[n,{elements:r}]of this.external)r.push(this.addElement(t,ma(n,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,n){return this.nonce&&n.setAttribute("nonce",this.nonce),t.appendChild(n)}static \u0275fac=function(n){return new(n||i)(W(Ce),W(ra),W(ia,8),W(to))};static \u0275prov=V({token:i,factory:i.\u0275fac})}return i})(),pa={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ya=/%COMP%/g;var _u="%COMP%",ng=`_nghost-${_u}`,rg=`_ngcontent-${_u}`,ig=!0,og=new K("",{factory:()=>ig});function sg(i){return rg.replace(ya,i)}function ag(i){return ng.replace(ya,i)}function Cu(i,e){return e.map(t=>t.replace(ya,i))}var si=(()=>{class i{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,n,r,o,s,a,l=null,c=null){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=c,this.defaultRenderer=new ii(t,s,a,this.tracingService)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,n);return r instanceof mo?r.applyToHost(t):r instanceof oi&&r.applyStyles(),r}getOrCreateRenderer(t,n){let r=this.rendererByCompId,o=r.get(n.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,h=this.tracingService;switch(n.encapsulation){case no.Emulated:o=new mo(l,c,n,this.appId,u,s,a,h);break;case no.ShadowDom:return new po(l,t,n,s,a,this.nonce,h,c);case no.ExperimentalIsolatedShadowDom:return new po(l,t,n,s,a,this.nonce,h);default:o=new oi(l,c,n,u,s,a,h);break}r.set(n.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(n){return new(n||i)(W(va),W(ba),W(ra),W(og),W(Ce),W(ur),W(ia),W(Qc,8))};static \u0275prov=V({token:i,factory:i.\u0275fac})}return i})(),ii=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,n,r){this.eventManager=e,this.doc=t,this.ngZone=n,this.tracingService=r}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(pa[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(yu(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(yu(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){t.remove()}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new ne(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;let o=pa[r];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let r=pa[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(dr.DashCase|dr.Important)?e.style.setProperty(t,n,r&dr.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&dr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n,r){if(typeof e=="string"&&(e=qe().getGlobalEventTarget(this.doc,e),!e))throw new ne(5102,!1);let o=this.decoratePreventDefault(n);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function yu(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var po=class extends ii{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,n,r,o,s,a,l){super(e,r,o,a),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let c=n.styles;c=Cu(n.id,c);for(let h of c){let d=document.createElement("style");s&&d.setAttribute("nonce",s),d.textContent=h,this.shadowRoot.appendChild(d)}let u=n.getExternalStyles?.();if(u)for(let h of u){let d=ma(h,r);s&&d.setAttribute("nonce",s),this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},oi=class extends ii{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,n,r,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let c=n.styles;this.styles=l?Cu(l,c):c,this.styleUrls=n.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Jc.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},mo=class extends oi{contentAttr;hostAttr;constructor(e,t,n,r,o,s,a,l){let c=r+"-"+n.id;super(e,t,n,o,s,a,l,c),this.contentAttr=sg(c),this.hostAttr=ag(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}};var bo=class i extends ei{supportsDOMEvents=!0;static makeCurrent(){ha(new i)}onAndCancel(e,t,n,r){return e.addEventListener(t,n,r),()=>{e.removeEventListener(t,n,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=lg();return t==null?null:cg(t)}resetBaseElement(){ai=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return da(document.cookie,e)}},ai=null;function lg(){return ai=ai||document.head.querySelector("base"),ai?ai.getAttribute("href"):null}function cg(i){return new URL(i,document.baseURI).pathname}var ug=(()=>{class i{build(){return new XMLHttpRequest}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:i.\u0275fac})}return i})(),wu=["alt","control","meta","shift"],hg={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},dg={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},xu=(()=>{class i extends ri{constructor(t){super(t)}supports(t){return i.parseEventName(t)!=null}addEventListener(t,n,r,o){let s=i.parseEventName(n),a=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>qe().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let n=t.toLowerCase().split("."),r=n.shift();if(n.length===0||!(r==="keydown"||r==="keyup"))return null;let o=i._normalizeKey(n.pop()),s="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),s="code."),wu.forEach(c=>{let u=n.indexOf(c);u>-1&&(n.splice(u,1),s+=c+".")}),s+=o,n.length!=0||o.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,n){let r=hg[t.key]||t.key,o="";return n.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),wu.forEach(s=>{if(s!==r){let a=dg[s];a(t)&&(o+=s+".")}}),o+=r,o===n)}static eventCallback(t,n,r){return o=>{i.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>n(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(n){return new(n||i)(W(Ce))};static \u0275prov=V({token:i,factory:i.\u0275fac})}return i})();async function _a(i,e,t){let n=p({rootComponent:i},fg(e,t));return lu(n)}function fg(i,e){return{platformRef:e?.platformRef,appProviders:[...bg,...i?.providers??[]],platformProviders:vg}}function gg(){bo.makeCurrent()}function pg(){return new na}function mg(){return Yc(document),document}var vg=[{provide:to,useValue:mu},{provide:Xc,useValue:gg,multi:!0},{provide:Ce,useFactory:mg}];var bg=[{provide:zc,useValue:"root"},{provide:na,useFactory:pg},{provide:vo,useClass:go,multi:!0},{provide:vo,useClass:xu,multi:!0},si,ba,va,{provide:io,useExisting:si},{provide:ni,useClass:ug},[]];var Su=(()=>{class i{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(n){return new(n||i)(W(Ce))};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var j="primary",bi=Symbol("RouteTitle"),Da=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function _r(i){return new Da(i)}function Ca(i,e,t){for(let n=0;n<i.length;n++){let r=i[n],o=e[n];if(r[0]===":")t[r.substring(1)]=o;else if(r!==o.path)return!1}return!0}function _g(i,e,t){let n=t.path.split("/"),r=n.indexOf("**");if(r===-1){if(n.length>i.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<i.length))return null;let l={},c=i.slice(0,n.length);return Ca(n,c,l)?{consumed:c,posParams:l}:null}if(r!==n.lastIndexOf("**"))return null;let o=n.slice(0,r),s=n.slice(r+1);if(o.length+s.length>i.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let a={};return!Ca(o,i.slice(0,o.length),a)||!Ca(s,i.slice(i.length-s.length),a)?null:{consumed:i,posParams:a}}function So(i){return new Promise((e,t)=>{i.pipe(qt()).subscribe({next:n=>e(n),error:n=>t(n)})})}function Cg(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!vt(i[t],e[t]))return!1;return!0}function vt(i,e){let t=i?Ma(i):void 0,n=e?Ma(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!Iu(i[r],e[r]))return!1;return!0}function Ma(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function Iu(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;let t=[...i].sort(),n=[...e].sort();return t.every((r,o)=>n[o]===r)}else return i===e}function wg(i){return i.length>0?i[i.length-1]:null}function On(i){return Zs(i)?i:Qr(i)?Ye(Promise.resolve(i)):$(i)}function Ru(i){return Zs(i)?So(i):Promise.resolve(i)}var xg={exact:Uu,subset:ju},Lu={exact:Sg,subset:Dg,ignored:()=>!0};function Du(i,e,t){return xg[t.paths](i.root,e.root,t.matrixParams)&&Lu[t.queryParams](i.queryParams,e.queryParams)&&!(t.fragment==="exact"&&i.fragment!==e.fragment)}function Sg(i,e){return vt(i,e)}function Uu(i,e,t){if(!Mn(i.segments,e.segments)||!Co(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!i.children[n]||!Uu(i.children[n],e.children[n],t))return!1;return!0}function Dg(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>Iu(i[t],e[t]))}function ju(i,e,t){return Nu(i,e,e.segments,t)}function Nu(i,e,t,n){if(i.segments.length>t.length){let r=i.segments.slice(0,t.length);return!(!Mn(r,t)||e.hasChildren()||!Co(r,t,n))}else if(i.segments.length===t.length){if(!Mn(i.segments,t)||!Co(i.segments,t,n))return!1;for(let r in e.children)if(!i.children[r]||!ju(i.children[r],e.children[r],n))return!1;return!0}else{let r=t.slice(0,i.segments.length),o=t.slice(i.segments.length);return!Mn(i.segments,r)||!Co(i.segments,r,n)||!i.children[j]?!1:Nu(i.children[j],e,o,n)}}function Co(i,e,t){return e.every((n,r)=>Lu[t](i[r].parameters,n.parameters))}var bt=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Y([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=_r(this.queryParams),this._queryParamMap}toString(){return Tg.serialize(this)}},Y=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return wo(this)}},Dn=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=_r(this.parameters),this._parameterMap}toString(){return Vu(this)}};function Mg(i,e){return Mn(i,e)&&i.every((t,n)=>vt(t.parameters,e[n].parameters))}function Mn(i,e){return i.length!==e.length?!1:i.every((t,n)=>t.path===e[n].path)}function Eg(i,e){let t=[];return Object.entries(i.children).forEach(([n,r])=>{n===j&&(t=t.concat(e(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==j&&(t=t.concat(e(r,n)))}),t}var Io=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:()=>new En,providedIn:"root"})}return i})(),En=class{parse(e){let t=new Ta(e);return new bt(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${li(e.root,!0)}`,n=kg(e.queryParams),r=typeof e.fragment=="string"?`#${Og(e.fragment)}`:"";return`${t}${n}${r}`}},Tg=new En;function wo(i){return i.segments.map(e=>Vu(e)).join("/")}function li(i,e){if(!i.hasChildren())return wo(i);if(e){let t=i.children[j]?li(i.children[j],!1):"",n=[];return Object.entries(i.children).forEach(([r,o])=>{r!==j&&n.push(`${r}:${li(o,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=Eg(i,(n,r)=>r===j?[li(i.children[j],!1)]:[`${r}:${li(n,!1)}`]);return Object.keys(i.children).length===1&&i.children[j]!=null?`${wo(i)}/${t[0]}`:`${wo(i)}/(${t.join("//")})`}}function Bu(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yo(i){return Bu(i).replace(/%3B/gi,";")}function Og(i){return encodeURI(i)}function Ea(i){return Bu(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xo(i){return decodeURIComponent(i)}function Mu(i){return xo(i.replace(/\+/g,"%20"))}function Vu(i){return`${Ea(i.path)}${Ag(i.parameters)}`}function Ag(i){return Object.entries(i).map(([e,t])=>`;${Ea(e)}=${Ea(t)}`).join("")}function kg(i){let e=Object.entries(i).map(([t,n])=>Array.isArray(n)?n.map(r=>`${yo(t)}=${yo(r)}`).join("&"):`${yo(t)}=${yo(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Fg=/^[^\/()?;#]+/;function wa(i){let e=i.match(Fg);return e?e[0]:""}var Pg=/^[^\/()?;=#]+/;function Ig(i){let e=i.match(Pg);return e?e[0]:""}var Rg=/^[^=?&#]+/;function Lg(i){let e=i.match(Rg);return e?e[0]:""}var Ug=/^[^&#]+/;function jg(i){let e=i.match(Ug);return e?e[0]:""}var Ta=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Y([],{}):new Y([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[j]=new Y(e,t)),n}parseSegment(){let e=wa(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ne(4009,!1);return this.capture(e),new Dn(xo(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Ig(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let r=wa(this.remaining);r&&(n=r,this.capture(n))}e[xo(t)]=xo(n)}parseQueryParam(e){let t=Lg(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let s=jg(this.remaining);s&&(n=s,this.capture(n))}let r=Mu(t),o=Mu(n);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=wa(this.remaining),r=this.remaining[n.length];if(r!=="/"&&r!==")"&&r!==";")throw new ne(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=j);let s=this.parseChildren();t[o??j]=Object.keys(s).length===1&&s[j]?s[j]:new Y([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ne(4011,!1)}};function zu(i){return i.segments.length>0?new Y([],{[j]:i}):i}function $u(i){let e={};for(let[n,r]of Object.entries(i.children)){let o=$u(r);if(n===j&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[n]=o)}let t=new Y(i.segments,e);return Ng(t)}function Ng(i){if(i.numberOfChildren===1&&i.children[j]){let e=i.children[j];return new Y(i.segments.concat(e.segments),e.children)}return i}function Cr(i){return i instanceof bt}function Bg(i,e,t=null,n=null,r=new En){let o=Hu(i);return Gu(o,e,t,n,r)}function Hu(i){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new Y(o.url,s);return o===i&&(e=a),a}let n=t(i.root),r=zu(n);return e??r}function Gu(i,e,t,n,r){let o=i;for(;o.parent;)o=o.parent;if(e.length===0)return xa(o,o,o,t,n,r);let s=Vg(e);if(s.toRoot())return xa(o,o,new Y([],{}),t,n,r);let a=zg(s,o,i),l=a.processChildren?ui(a.segmentGroup,a.index,s.commands):Yu(a.segmentGroup,a.index,s.commands);return xa(o,a.segmentGroup,l,t,n,r)}function Do(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function fi(i){return typeof i=="object"&&i!=null&&i.outlets}function Eu(i,e,t){i||="\u0275";let n=new bt;return n.queryParams={[i]:e},t.parse(t.serialize(n)).queryParams[i]}function xa(i,e,t,n,r,o){let s={};for(let[c,u]of Object.entries(n??{}))s[c]=Array.isArray(u)?u.map(h=>Eu(c,h,o)):Eu(c,u,o);let a;i===e?a=t:a=Wu(i,e,t);let l=zu($u(a));return new bt(l,s,r)}function Wu(i,e,t){let n={};return Object.entries(i.children).forEach(([r,o])=>{o===e?n[r]=t:n[r]=Wu(o,e,t)}),new Y(i.segments,n)}var Mo=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Do(n[0]))throw new ne(4003,!1);let r=n.find(fi);if(r&&r!==wg(n))throw new ne(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Vg(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new Mo(!0,0,i);let e=0,t=!1,n=i.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new Mo(t,e,n)}var vr=class{segmentGroup;processChildren;index;constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function zg(i,e,t){if(i.isAbsolute)return new vr(e,!0,0);if(!t)return new vr(e,!1,NaN);if(t.parent===null)return new vr(t,!0,0);let n=Do(i.commands[0])?0:1,r=t.segments.length-1+n;return $g(t,r,i.numberOfDoubleDots)}function $g(i,e,t){let n=i,r=e,o=t;for(;o>r;){if(o-=r,n=n.parent,!n)throw new ne(4005,!1);r=n.segments.length}return new vr(n,!1,r-o)}function Hg(i){return fi(i[0])?i[0].outlets:{[j]:i}}function Yu(i,e,t){if(i??=new Y([],{}),i.segments.length===0&&i.hasChildren())return ui(i,e,t);let n=Gg(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){let o=new Y(i.segments.slice(0,n.pathIndex),{});return o.children[j]=new Y(i.segments.slice(n.pathIndex),i.children),ui(o,0,r)}else return n.match&&r.length===0?new Y(i.segments,{}):n.match&&!i.hasChildren()?Oa(i,e,t):n.match?ui(i,0,r):Oa(i,e,t)}function ui(i,e,t){if(t.length===0)return new Y(i.segments,{});{let n=Hg(t),r={};if(Object.keys(n).some(o=>o!==j)&&i.children[j]&&i.numberOfChildren===1&&i.children[j].segments.length===0){let o=ui(i.children[j],e,t);return new Y(i.segments,o.children)}return Object.entries(n).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=Yu(i.children[o],e,s))}),Object.entries(i.children).forEach(([o,s])=>{n[o]===void 0&&(r[o]=s)}),new Y(i.segments,r)}}function Gg(i,e,t){let n=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return o;let s=i.segments[r],a=t[n];if(fi(a))break;let l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!Ou(l,c,s))return o;n+=2}else{if(!Ou(l,{},s))return o;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}function Oa(i,e,t){let n=i.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(fi(o)){let l=Wg(o.outlets);return new Y(n,l)}if(r===0&&Do(t[0])){let l=i.segments[e];n.push(new Dn(l.path,Tu(t[0]))),r++;continue}let s=fi(o)?o.outlets[j]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&Do(a)?(n.push(new Dn(s,Tu(a))),r+=2):(n.push(new Dn(s,{})),r++)}return new Y(n,{})}function Wg(i){let e={};return Object.entries(i).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=Oa(new Y([],{}),0,n))}),e}function Tu(i){let e={};return Object.entries(i).forEach(([t,n])=>e[t]=`${n}`),e}function Ou(i,e,t){return i==t.path&&vt(e,t.parameters)}var hi="imperative",xe=(function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i})(xe||{}),Ke=class{id;url;constructor(e,t){this.id=e,this.url=t}},wr=class extends Ke{type=xe.NavigationStart;navigationTrigger;restoredState;constructor(e,t,n="imperative",r=null){super(e,t),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},en=class extends Ke{urlAfterRedirects;type=xe.NavigationEnd;constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Ee=(function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i[i.Aborted=4]="Aborted",i})(Ee||{}),Eo=(function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i})(Eo||{}),rt=class extends Ke{reason;code;type=xe.NavigationCancel;constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function Xu(i){return i instanceof rt&&(i.code===Ee.Redirect||i.code===Ee.SupersededByNewNavigation)}var tn=class extends Ke{reason;code;type=xe.NavigationSkipped;constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r}},xr=class extends Ke{error;target;type=xe.NavigationError;constructor(e,t,n,r){super(e,t),this.error=n,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},gi=class extends Ke{urlAfterRedirects;state;type=xe.RoutesRecognized;constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Aa=class extends Ke{urlAfterRedirects;state;type=xe.GuardsCheckStart;constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ka=class extends Ke{urlAfterRedirects;state;shouldActivate;type=xe.GuardsCheckEnd;constructor(e,t,n,r,o){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Fa=class extends Ke{urlAfterRedirects;state;type=xe.ResolveStart;constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Pa=class extends Ke{urlAfterRedirects;state;type=xe.ResolveEnd;constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ia=class{route;type=xe.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ra=class{route;type=xe.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},La=class{snapshot;type=xe.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ua=class{snapshot;type=xe.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ja=class{snapshot;type=xe.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Na=class{snapshot;type=xe.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Sr=class{},Dr=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function Yg(i){return!(i instanceof Sr)&&!(i instanceof Dr)}var Ba=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new yi(this.rootInjector)}},yi=(()=>{class i{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,n){let r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){let n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new Ba(this.rootInjector),this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(n){return new(n||i)(W(Cn))};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),To=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Va(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=Va(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=za(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return za(e,this._root).map(t=>t.value)}};function Va(i,e){if(i===e.value)return e;for(let t of e.children){let n=Va(i,t);if(n)return n}return null}function za(i,e){if(i===e.value)return[e];for(let t of e.children){let n=za(i,t);if(n.length)return n.unshift(e),n}return[]}var je=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function mr(i){let e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}var Oo=class extends To{snapshot;constructor(e,t){super(e),this.snapshot=t,Za(this,e)}toString(){return this.snapshot.toString()}};function qu(i,e){let t=Xg(i,e),n=new Ge([new Dn("",{})]),r=new Ge({}),o=new Ge({}),s=new Ge({}),a=new Ge(""),l=new Tn(n,r,s,a,o,j,i,t.root);return l.snapshot=t.root,new Oo(new je(l,[]),t)}function Xg(i,e){let t={},n={},r={},s=new br([],t,r,"",n,j,i,null,{},e);return new ko("",new je(s,[]))}var Tn=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,n,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(ye(c=>c[bi]))??$(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ye(e=>_r(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ye(e=>_r(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ao(i,e,t="emptyOnly"){let n,{routeConfig:r}=i;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:p(p({},e.params),i.params),data:p(p({},e.data),i.data),resolve:p(p(p(p({},i.data),e.data),r?.data),i._resolvedData)}:n={params:p({},i.params),data:p({},i.data),resolve:p(p({},i.data),i._resolvedData??{})},r&&Zu(r)&&(n.resolve[bi]=r.title),n}var br=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[bi]}constructor(e,t,n,r,o,s,a,l,c,u){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c,this._environmentInjector=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=_r(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=_r(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ko=class extends To{url;constructor(e,t){super(t),this.url=e,Za(this,t)}toString(){return Ku(this._root)}};function Za(i,e){e.value._routerState=i,e.children.forEach(t=>Za(i,t))}function Ku(i){let e=i.children.length>0?` { ${i.children.map(Ku).join(", ")} } `:"";return`${i.value}${e}`}function Sa(i){if(i.snapshot){let e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,vt(e.queryParams,t.queryParams)||i.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&i.fragmentSubject.next(t.fragment),vt(e.params,t.params)||i.paramsSubject.next(t.params),Cg(e.url,t.url)||i.urlSubject.next(t.url),vt(e.data,t.data)||i.dataSubject.next(t.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function $a(i,e){let t=vt(i.params,e.params)&&Mg(i.url,e.url),n=!i.parent!=!e.parent;return t&&!n&&(!i.parent||$a(i.parent,e.parent))}function Zu(i){return typeof i.title=="string"||i.title===null}var qg=new K(""),Ju=(()=>{class i{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=j;activateEvents=new gt;deactivateEvents=new gt;attachEvents=new gt;detachEvents=new gt;routerOutletData=su();parentContexts=A(yi);location=A(Jr);changeDetector=A(gr);inputBinder=A(Ro,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ne(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ne(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ne(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new ne(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new Ha(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=ge({type:i,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Zr]})}return i})(),Ha=class{route;childContexts;parent;outletData;constructor(e,t,n,r){this.route=e,this.childContexts=t,this.parent=n,this.outletData=r}get(e,t){return e===Tn?this.route:e===yi?this.childContexts:e===qg?this.outletData:this.parent.get(e,t)}},Ro=new K("");var Qu=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Me({type:i,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(n,r){n&1&&Pe(0,"router-outlet")},dependencies:[Ju],encapsulation:2})}return i})();function Ja(i){let e=i.children&&i.children.map(Ja),t=e?D(p({},i),{children:e}):p({},i);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==j&&(t.component=Qu),t}function Kg(i,e,t){let n=pi(i,e._root,t?t._root:void 0);return new Oo(n,e)}function pi(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let r=Zg(i,e,t);return new je(n,r)}else{if(i.shouldAttach(e.value)){let o=i.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>pi(i,a)),s}}let n=Jg(e.value),r=e.children.map(o=>pi(i,o));return new je(n,r)}}function Zg(i,e,t){return e.children.map(n=>{for(let r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return pi(i,n,r);return pi(i,n)})}function Jg(i){return new Tn(new Ge(i.url),new Ge(i.params),new Ge(i.queryParams),new Ge(i.fragment),new Ge(i.data),i.outlet,i.component,i)}var mi=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},eh="ngNavigationCancelingError";function Fo(i,e){let{redirectTo:t,navigationBehaviorOptions:n}=Cr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=th(!1,Ee.Redirect);return r.url=t,r.navigationBehaviorOptions=n,r}function th(i,e){let t=new Error(`NavigationCancelingError: ${i||""}`);return t[eh]=!0,t.cancellationCode=e,t}function Qg(i){return nh(i)&&Cr(i.url)}function nh(i){return!!i&&i[eh]}var Ga=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,n,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Sa(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let r=mr(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],n),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(e,t,n){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=n.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,n);else o&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,o=mr(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(n&&n.outlet){let s=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,o=mr(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let r=mr(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],n),this.forwardEvent(new Na(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Ua(e.value.snapshot))}activateRoutes(e,t,n){let r=e.value,o=t?t.value:null;if(Sa(r),r===o)if(r.component){let s=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,n);else if(r.component){let s=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),Sa(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,n)}},Po=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},yr=class{component;route;constructor(e,t){this.component=e,this.route=t}};function ep(i,e,t){let n=i._root,r=e?e._root:null;return ci(n,r,t,[n.value])}function tp(i){let e=i.routeConfig?i.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:i,guards:e}}function Er(i,e){let t=Symbol(),n=e.get(i,t);return n===t?typeof i=="function"&&!Vc(i)?i:e.get(i):n}function ci(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=mr(e);return i.children.forEach(s=>{np(s,o[s.value.outlet],t,n.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>di(a,t.getContext(s),r)),r}function np(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=i.value,s=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=rp(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Po(n)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?ci(i,e,a?a.children:null,n,r):ci(i,e,t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new yr(a.outlet.component,s))}else s&&di(e,a,r),r.canActivateChecks.push(new Po(n)),o.component?ci(i,null,a?a.children:null,n,r):ci(i,null,t,n,r);return r}function rp(i,e,t){if(typeof t=="function")return Xe(e._environmentInjector,()=>t(i,e));switch(t){case"pathParamsChange":return!Mn(i.url,e.url);case"pathParamsOrQueryParamsChange":return!Mn(i.url,e.url)||!vt(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!$a(i,e)||!vt(i.queryParams,e.queryParams);default:return!$a(i,e)}}function di(i,e,t){let n=mr(i),r=i.value;Object.entries(n).forEach(([o,s])=>{r.component?e?di(s,e.children.getContext(o),t):di(s,null,t):di(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new yr(e.outlet.component,r)):t.canDeactivateChecks.push(new yr(null,r)):t.canDeactivateChecks.push(new yr(null,r))}function _i(i){return typeof i=="function"}function ip(i){return typeof i=="boolean"}function op(i){return i&&_i(i.canLoad)}function sp(i){return i&&_i(i.canActivate)}function ap(i){return i&&_i(i.canActivateChild)}function lp(i){return i&&_i(i.canDeactivate)}function cp(i){return i&&_i(i.canMatch)}function rh(i){return i instanceof Rc||i?.name==="EmptyError"}var _o=Symbol("INITIAL_VALUE");function Mr(){return Kt(i=>Lc(i.map(e=>e.pipe(lr(1),Bc(_o)))).pipe(ye(e=>{for(let t of e)if(t!==!0){if(t===_o)return _o;if(t===!1||up(t))return t}return!0}),ar(e=>e!==_o),lr(1)))}function up(i){return Cr(i)||i instanceof mi}function ih(i){return i.aborted?$(void 0).pipe(lr(1)):new Pc(e=>{let t=()=>{e.next(),e.complete()};return i.addEventListener("abort",t),()=>i.removeEventListener("abort",t)})}function oh(i){return Ji(ih(i))}function hp(i){return Xt(e=>{let{targetSnapshot:t,currentSnapshot:n,guards:{canActivateChecks:r,canDeactivateChecks:o}}=e;return o.length===0&&r.length===0?$(D(p({},e),{guardsResult:!0})):dp(o,t,n).pipe(Xt(s=>s&&ip(s)?fp(t,r,i):$(s)),ye(s=>D(p({},e),{guardsResult:s})))})}function dp(i,e,t){return Ye(i).pipe(Xt(n=>bp(n.component,n.route,t,e)),qt(n=>n!==!0,!0))}function fp(i,e,t){return Ye(e).pipe(Qs(n=>Uc(pp(n.route.parent,t),gp(n.route,t),vp(i,n.path),mp(i,n.route))),qt(n=>n!==!0,!0))}function gp(i,e){return i!==null&&e&&e(new ja(i)),$(!0)}function pp(i,e){return i!==null&&e&&e(new La(i)),$(!0)}function mp(i,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return $(!0);let n=t.map(r=>Zi(()=>{let o=e._environmentInjector,s=Er(r,o),a=sp(s)?s.canActivate(e,i):Xe(o,()=>s(e,i));return On(a).pipe(qt())}));return $(n).pipe(Mr())}function vp(i,e){let t=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(o=>tp(o)).filter(o=>o!==null).map(o=>Zi(()=>{let s=o.guards.map(a=>{let l=o.node._environmentInjector,c=Er(a,l),u=ap(c)?c.canActivateChild(t,i):Xe(l,()=>c(t,i));return On(u).pipe(qt())});return $(s).pipe(Mr())}));return $(r).pipe(Mr())}function bp(i,e,t,n){let r=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!r||r.length===0)return $(!0);let o=r.map(s=>{let a=e._environmentInjector,l=Er(s,a),c=lp(l)?l.canDeactivate(i,e,t,n):Xe(a,()=>l(i,e,t,n));return On(c).pipe(qt())});return $(o).pipe(Mr())}function yp(i,e,t,n,r){let o=e.canLoad;if(o===void 0||o.length===0)return $(!0);let s=o.map(a=>{let l=Er(a,i),c=op(l)?l.canLoad(e,t):Xe(i,()=>l(e,t)),u=On(c);return r?u.pipe(oh(r)):u});return $(s).pipe(Mr(),sh(n))}function sh(i){return Fc(Tt(e=>{if(typeof e!="boolean")throw Fo(i,e)}),ye(e=>e===!0))}function _p(i,e,t,n,r){let o=e.canMatch;if(!o||o.length===0)return $(!0);let s=o.map(a=>{let l=Er(a,i),c=cp(l)?l.canMatch(e,t):Xe(i,()=>l(e,t));return On(c).pipe(oh(r))});return $(s).pipe(Mr(),sh(n))}var Rt=class i extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,i.prototype)}},vi=class i extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,i.prototype)}};function Cp(i){throw new ne(4e3,!1)}function wp(i){throw th(!1,Ee.GuardRejected)}var Wa=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),r.numberOfChildren===0)return n;if(r.numberOfChildren>1||!r.children[j])throw Cp(`${e.redirectTo}`);r=r.children[j]}}async applyRedirectCommands(e,t,n,r,o){let s=await xp(t,r,o);if(s instanceof bt)throw new vi(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,n);if(s[0]==="/")throw new vi(a);return a}applyRedirectCreateUrlTree(e,t,n,r){let o=this.createSegmentGroup(e,t.root,n,r);return new bt(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);n[r]=t[a]}else n[r]=o}),n}createSegmentGroup(e,t,n,r){let o=this.createSegments(e,t.segments,n,r),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,n,r)}),new Y(o,s)}createSegments(e,t,n,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,n))}findPosParam(e,t,n){let r=n[t.path.substring(1)];if(!r)throw new ne(4001,!1);return r}findOrReturn(e,t){let n=0;for(let r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}};function xp(i,e,t){if(typeof i=="string")return Promise.resolve(i);let n=i,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,params:c,data:u,title:h,paramMap:d,queryParamMap:f}=e;return So(On(Xe(t,()=>n({params:c,data:u,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:l,title:h,paramMap:d,queryParamMap:f}))))}function Sp(i,e){return i.providers&&!i._injector&&(i._injector=aa(i.providers,e,`Route: ${i.path}`)),i._injector??e}function nt(i){return i.outlet||j}function Dp(i,e){let t=i.filter(n=>nt(n)===e);return t.push(...i.filter(n=>nt(n)!==e)),t}var Ya={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Mp(i,e,t,n,r,o){let s=ah(i,e,t);return s.matched?(n=Sp(e,n),_p(n,e,t,r,o).pipe(ye(a=>a===!0?s:p({},Ya)))):$(s)}function ah(i,e,t){if(e.path==="")return e.pathMatch==="full"&&(i.hasChildren()||t.length>0)?p({},Ya):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||_g)(t,i,e);if(!r)return p({},Ya);let o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=r.consumed.length>0?p(p({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function Au(i,e,t,n){return t.length>0&&Op(i,t,n)?{segmentGroup:new Y(e,Tp(n,new Y(t,i.children))),slicedSegments:[]}:t.length===0&&Ap(i,t,n)?{segmentGroup:new Y(i.segments,Ep(i,t,n,i.children)),slicedSegments:t}:{segmentGroup:new Y(i.segments,i.children),slicedSegments:t}}function Ep(i,e,t,n){let r={};for(let o of t)if(Lo(i,e,o)&&!n[nt(o)]){let s=new Y([],{});r[nt(o)]=s}return p(p({},n),r)}function Tp(i,e){let t={};t[j]=e;for(let n of i)if(n.path===""&&nt(n)!==j){let r=new Y([],{});t[nt(n)]=r}return t}function Op(i,e,t){return t.some(n=>Lo(i,e,n)&&nt(n)!==j)}function Ap(i,e,t){return t.some(n=>Lo(i,e,n))}function Lo(i,e,t){return(i.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function kp(i,e,t){return e.length===0&&!i.children[t]}var Xa=class{};async function Fp(i,e,t,n,r,o,s="emptyOnly",a){return new qa(i,e,t,n,r,s,o,a).recognize()}var Pp=31,qa=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,n,r,o,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=l,this.applyRedirects=new Wa(this.urlSerializer,this.urlTree)}noMatchError(e){return new ne(4002,`'${e.segmentGroup}'`)}async recognize(){let e=Au(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:n}=await this.match(e),r=new je(n,t),o=new ko("",r),s=Bg(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}async match(e){let t=new br([],Object.freeze({}),Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),j,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,j,t),rootSnapshot:t}}catch(n){if(n instanceof vi)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Rt?this.noMatchError(n):n}}async processSegmentGroup(e,t,n,r,o){if(n.segments.length===0&&n.hasChildren())return this.processChildren(e,t,n,o);let s=await this.processSegment(e,t,n,n.segments,r,!0,o);return s instanceof je?[s]:[]}async processChildren(e,t,n,r){let o=[];for(let l of Object.keys(n.children))l==="primary"?o.unshift(l):o.push(l);let s=[];for(let l of o){let c=n.children[l],u=Dp(t,l),h=await this.processSegmentGroup(e,u,c,l,r);s.push(...h)}let a=lh(s);return Ip(a),a}async processSegment(e,t,n,r,o,s,a){for(let l of t)try{return await this.processSegmentAgainstRoute(l._injector??e,t,l,n,r,o,s,a)}catch(c){if(c instanceof Rt||rh(c))continue;throw c}if(kp(n,r,o))return new Xa;throw new Rt(n)}async processSegmentAgainstRoute(e,t,n,r,o,s,a,l){if(nt(n)!==s&&(s===j||!Lo(r,o,n)))throw new Rt(r);if(n.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,r,n,o,s,l);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,r,t,n,o,s,l);throw new Rt(r)}async expandSegmentAgainstRouteUsingRedirect(e,t,n,r,o,s,a){let{matched:l,parameters:c,consumedSegments:u,positionalParamSegments:h,remainingSegments:d}=ah(t,r,o);if(!l)throw new Rt(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Pp&&(this.allowRedirects=!1));let f=new br(o,c,Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,ku(r),nt(r),r.component??r._loadedComponent??null,r,Fu(r),e),g=Ao(f,a,this.paramsInheritanceStrategy);if(f.params=Object.freeze(g.params),f.data=Object.freeze(g.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let v=await this.applyRedirects.applyRedirectCommands(u,r.redirectTo,h,f,e),y=await this.applyRedirects.lineralizeSegments(r,v);return this.processSegment(e,n,t,y.concat(d),s,!1,a)}async matchSegmentAgainstRoute(e,t,n,r,o,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await So(Mp(t,n,r,e,this.urlSerializer,this.abortSignal));if(n.path==="**"&&(t.children={}),!a?.matched)throw new Rt(t);e=n._injector??e;let{routes:l}=await this.getChildConfig(e,n,r),c=n._loadedInjector??e,{parameters:u,consumedSegments:h,remainingSegments:d}=a,f=new br(h,u,Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,ku(n),nt(n),n.component??n._loadedComponent??null,n,Fu(n),e),g=Ao(f,s,this.paramsInheritanceStrategy);f.params=Object.freeze(g.params),f.data=Object.freeze(g.data);let{segmentGroup:v,slicedSegments:y}=Au(t,h,d,l);if(y.length===0&&v.hasChildren()){let T=await this.processChildren(c,l,v,f);return new je(f,T)}if(l.length===0&&y.length===0)return new je(f,[]);let w=nt(n)===o,S=await this.processSegment(c,l,v,y,w?j:o,!0,f);return new je(f,S instanceof je?[S]:[])}async getChildConfig(e,t,n){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let o=t._loadedNgModuleFactory;return o&&!t._loadedInjector&&(t._loadedInjector=o.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await So(yp(e,t,n,this.urlSerializer,this.abortSignal))){let o=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=o.routes,t._loadedInjector=o.injector,t._loadedNgModuleFactory=o.factory,o}throw wp(t)}return{routes:[],injector:e}}};function Ip(i){i.sort((e,t)=>e.value.outlet===j?-1:t.value.outlet===j?1:e.value.outlet.localeCompare(t.value.outlet))}function Rp(i){let e=i.value.routeConfig;return e&&e.path===""}function lh(i){let e=[],t=new Set;for(let n of i){if(!Rp(n)){e.push(n);continue}let r=e.find(o=>n.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...n.children),t.add(r)):e.push(n)}for(let n of t){let r=lh(n.children);e.push(new je(n.value,r))}return e.filter(n=>!t.has(n))}function ku(i){return i.data||{}}function Fu(i){return i.resolve||{}}function Lp(i,e,t,n,r,o,s){return Xt(async a=>{let{state:l,tree:c}=await Fp(i,e,t,n,a.extractedUrl,r,o,s);return D(p({},a),{targetSnapshot:l,urlAfterRedirects:c})})}function Up(i){return Xt(e=>{let{targetSnapshot:t,guards:{canActivateChecks:n}}=e;if(!n.length)return $(e);let r=new Set(n.map(a=>a.route)),o=new Set;for(let a of r)if(!o.has(a))for(let l of ch(a))o.add(l);let s=0;return Ye(o).pipe(Qs(a=>r.has(a)?jp(a,t,i):(a.data=Ao(a,a.parent,i).resolve,$(void 0))),Tt(()=>s++),ea(1),Xt(a=>s===o.size?$(e):We))})}function ch(i){let e=i.children.map(t=>ch(t)).flat();return[i,...e]}function jp(i,e,t){let n=i.routeConfig,r=i._resolve;return n?.title!==void 0&&!Zu(n)&&(r[bi]=n.title),Zi(()=>(i.data=Ao(i,i.parent,t).resolve,Np(r,i,e).pipe(ye(o=>(i._resolvedData=o,i.data=p(p({},i.data),o),null)))))}function Np(i,e,t){let n=Ma(i);if(n.length===0)return $({});let r={};return Ye(n).pipe(Xt(o=>Bp(i[o],e,t).pipe(qt(),Tt(s=>{if(s instanceof mi)throw Fo(new En,s);r[o]=s}))),ea(1),ye(()=>r),Js(o=>rh(o)?We:Ic(o)))}function Bp(i,e,t){let n=e._environmentInjector,r=Er(i,n),o=r.resolve?r.resolve(e,t):Xe(n,()=>r(e,t));return On(o)}function Pu(i){return Kt(e=>{let t=i(e);return t?Ye(t).pipe(ye(()=>e)):$(e)})}var uh=(()=>{class i{buildTitle(t){let n,r=t.root;for(;r!==void 0;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(o=>o.outlet===j);return n}getResolvedTitleForRoute(t){return t.data[bi]}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:()=>A(Vp),providedIn:"root"})}return i})(),Vp=(()=>{class i extends uh{title;constructor(t){super(),this.title=t}updateTitle(t){let n=this.buildTitle(t);n!==void 0&&this.title.setTitle(n)}static \u0275fac=function(n){return new(n||i)(W(Su))};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Uo=new K("",{factory:()=>({})}),jo=new K(""),hh=(()=>{class i{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=A(ou);async loadComponent(t,n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Promise.resolve(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let r=(async()=>{try{let o=await Ru(Xe(t,()=>n.loadComponent())),s=await fh(dh(o));return this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s,s}finally{this.componentLoaders.delete(n)}})();return this.componentLoaders.set(n,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Promise.resolve({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);let r=(async()=>{try{let o=await zp(n,this.compiler,t,this.onLoadEndListener);return n._loadedRoutes=o.routes,n._loadedInjector=o.injector,n._loadedNgModuleFactory=o.factory,o}finally{this.childrenLoaders.delete(n)}})();return this.childrenLoaders.set(n,r),r}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();async function zp(i,e,t,n){let r=await Ru(Xe(t,()=>i.loadChildren())),o=await fh(dh(r)),s;o instanceof tu||Array.isArray(o)?s=o:s=await e.compileModuleAsync(o),n&&n(i);let a,l,c=!1,u;return Array.isArray(s)?(l=s,c=!0):(a=s.create(t).injector,u=s,l=a.get(jo,[],{optional:!0,self:!0}).flat()),{routes:l.map(Ja),injector:a,factory:u}}function $p(i){return i&&typeof i=="object"&&"default"in i}function dh(i){return $p(i)?i.default:i}async function fh(i){return i}var Qa=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:()=>A(Hp),providedIn:"root"})}return i})(),Hp=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),gh=new K("");var Gp=()=>{},ph=new K(""),mh=(()=>{class i{currentNavigation=re(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=re(null);events=new ft;transitionAbortWithErrorSubject=new ft;configLoader=A(hh);environmentInjector=A(Cn);destroyRef=A(Kr);urlSerializer=A(Io);rootContexts=A(yi);location=A(pr);inputBindingEnabled=A(Ro,{optional:!0})!==null;titleStrategy=A(uh);options=A(Uo,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=A(Qa);createViewTransition=A(gh,{optional:!0});navigationErrorHandler=A(ph,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>$(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new Ia(r)),n=r=>this.events.next(new Ra(r));this.configLoader.onLoadEndListener=n,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let n=++this.navigationId;De(()=>{this.transitions?.next(D(p({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:n}))})}setupNavigations(t){return this.transitions=new Ge(null),this.transitions.pipe(ar(n=>n!==null),Kt(n=>{let r=!1,o=new AbortController,s=()=>!r&&this.currentTransition?.id===n.id;return $(n).pipe(Kt(a=>{if(this.navigationId>n.id)return this.cancelNavigationTransition(n,"",Ee.SupersededByNewNavigation),We;this.currentTransition=n;let l=this.lastSuccessfulNavigation();this.currentNavigation.set({id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:l?D(p({},l),{previousNavigation:null}):null,abort:()=>o.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=a.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&u!=="reload")return this.events.next(new tn(a.id,this.urlSerializer.serialize(a.rawUrl),"",Eo.IgnoredSameUrlNavigation)),a.resolve(!1),We;if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return $(a).pipe(Kt(h=>(this.events.next(new wr(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?We:Promise.resolve(h))),Lp(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),Tt(h=>{n.targetSnapshot=h.targetSnapshot,n.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(f=>(f.finalUrl=h.urlAfterRedirects,f));let d=new gi(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(d)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:h,extractedUrl:d,source:f,restoredState:g,extras:v}=a,y=new wr(h,this.urlSerializer.serialize(d),f,g);this.events.next(y);let w=qu(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=n=D(p({},a),{targetSnapshot:w,urlAfterRedirects:d,extras:D(p({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(S=>(S.finalUrl=d,S)),$(n)}else return this.events.next(new tn(a.id,this.urlSerializer.serialize(a.extractedUrl),"",Eo.IgnoredByUrlHandlingStrategy)),a.resolve(!1),We}),ye(a=>{let l=new Aa(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);return this.events.next(l),this.currentTransition=n=D(p({},a),{guards:ep(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),n}),hp(a=>this.events.next(a)),Kt(a=>{if(n.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw Fo(this.urlSerializer,a.guardsResult);let l=new ka(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);if(this.events.next(l),!s())return We;if(!a.guardsResult)return this.cancelNavigationTransition(a,"",Ee.GuardRejected),We;if(a.guards.canActivateChecks.length===0)return $(a);let c=new Fa(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);if(this.events.next(c),!s())return We;let u=!1;return $(a).pipe(Up(this.paramsInheritanceStrategy),Tt({next:()=>{u=!0;let h=new Pa(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(h)},complete:()=>{u||this.cancelNavigationTransition(a,"",Ee.NoDataFromResolver)}}))}),Pu(a=>{let l=u=>{let h=[];if(u.routeConfig?._loadedComponent)u.component=u.routeConfig?._loadedComponent;else if(u.routeConfig?.loadComponent){let d=u._environmentInjector;h.push(this.configLoader.loadComponent(d,u.routeConfig).then(f=>{u.component=f}))}for(let d of u.children)h.push(...l(d));return h},c=l(a.targetSnapshot.root);return c.length===0?$(a):Ye(Promise.all(c).then(()=>a))}),Pu(()=>this.afterPreactivation()),Kt(()=>{let{currentSnapshot:a,targetSnapshot:l}=n,c=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return c?Ye(c).pipe(ye(()=>n)):$(n)}),lr(1),ye(a=>{let l=Kg(t.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);this.currentTransition=n=a=D(p({},a),{targetRouterState:l}),this.currentNavigation.update(c=>(c.targetRouterState=l,c)),this.events.next(new Sr),s()&&(new Ga(t.routeReuseStrategy,n.targetRouterState,n.currentRouterState,c=>this.events.next(c),this.inputBindingEnabled).activate(this.rootContexts),s()&&(r=!0,this.currentNavigation.update(c=>(c.abort=Gp,c)),this.lastSuccessfulNavigation.set(De(this.currentNavigation)),this.events.next(new en(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)))}),Ji(ih(o.signal).pipe(ar(()=>!r&&!n.targetRouterState),Tt(()=>{this.cancelNavigationTransition(n,o.signal.reason+"",Ee.Aborted)}))),Tt({complete:()=>{r=!0}}),Ji(this.transitionAbortWithErrorSubject.pipe(Tt(a=>{throw a}))),Nc(()=>{o.abort(),r||this.cancelNavigationTransition(n,"",Ee.SupersededByNewNavigation),this.currentTransition?.id===n.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Js(a=>{if(r=!0,this.destroyed)return n.resolve(!1),We;if(nh(a))this.events.next(new rt(n.id,this.urlSerializer.serialize(n.extractedUrl),a.message,a.cancellationCode)),Qg(a)?this.events.next(new Dr(a.url,a.navigationBehaviorOptions)):n.resolve(!1);else{let l=new xr(n.id,this.urlSerializer.serialize(n.extractedUrl),a,n.targetSnapshot??void 0);try{let c=Xe(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(c instanceof mi){let{message:u,cancellationCode:h}=Fo(this.urlSerializer,c);this.events.next(new rt(n.id,this.urlSerializer.serialize(n.extractedUrl),u,h)),this.events.next(new Dr(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(l),a}catch(c){this.options.resolveNavigationPromiseOnError?n.resolve(!1):n.reject(c)}}return We}))}))}cancelNavigationTransition(t,n,r){let o=new rt(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),n=De(this.currentNavigation),r=n?.targetBrowserUrl??n?.extractedUrl;return t.toString()!==r?.toString()&&!n?.extras.skipLocationChange}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Wp(i){return i!==hi}var vh=new K("");var Yp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:()=>A(Xp),providedIn:"root"})}return i})(),Ka=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},Xp=(()=>{class i extends Ka{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ot(i)))(r||i)}})();static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),el=(()=>{class i{urlSerializer=A(Io);options=A(Uo,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=A(pr);urlHandlingStrategy=A(Qa);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new bt;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:n,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,n):n,s=r??o;return s instanceof bt?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:n,initialUrl:r}){n&&t?(this.currentUrlTree=n,this.rawUrlTree=this.urlHandlingStrategy.merge(n,r),this.routerState=t):this.rawUrlTree=r}routerState=qu(null,A(Cn));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:()=>A(qp),providedIn:"root"})}return i})(),qp=(()=>{class i extends el{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(n=>{n.type==="popstate"&&setTimeout(()=>{t(n.url,n.state,"popstate")})})}handleRouterEvent(t,n){t instanceof wr?this.updateStateMemento():t instanceof tn?this.commitTransition(n):t instanceof gi?this.urlUpdateStrategy==="eager"&&(n.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(n),n)):t instanceof Sr?(this.commitTransition(n),this.urlUpdateStrategy==="deferred"&&!n.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(n),n)):t instanceof rt&&!Xu(t)?this.restoreHistory(n):t instanceof xr?this.restoreHistory(n,!0):t instanceof en&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:n,id:r}){let{replaceUrl:o,state:s}=n;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=p(p({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",l)}else{let a=p(p({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,n=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(n&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ot(i)))(r||i)}})();static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function bh(i,e){i.events.pipe(ar(t=>t instanceof en||t instanceof rt||t instanceof xr||t instanceof tn),ye(t=>t instanceof en||t instanceof tn?0:(t instanceof rt?t.code===Ee.Redirect||t.code===Ee.SupersededByNewNavigation:!1)?2:1),ar(t=>t!==2),lr(1)).subscribe(()=>{e()})}var yh={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},_h={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},tl=(()=>{class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=A(nu);stateManager=A(el);options=A(Uo,{optional:!0})||{};pendingTasks=A($c);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=A(mh);urlSerializer=A(Io);location=A(pr);urlHandlingStrategy=A(Qa);injector=A(Cn);_events=new ft;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=A(Yp);injectorCleanup=A(vh,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=A(jo,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!A(Ro,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new kc;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(n=>{try{let r=this.navigationTransitions.currentTransition,o=De(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(n,o),n instanceof rt&&n.code!==Ee.Redirect&&n.code!==Ee.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof en)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(n instanceof Dr){let s=n.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(n.url,r.currentRawUrl),l=p({scroll:r.extras.scroll,browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Wp(r.source)},s);this.scheduleNavigation(a,hi,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}Yg(n)&&this._events.next(n)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),hi,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,n,r)=>{this.navigateToSyncWithBrowser(t,r,n)})}navigateToSyncWithBrowser(t,n,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let l=p({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,n,s,o).catch(l=>{this.disposed||this.injector.get(eo)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return De(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Ja),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,n={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=n,c=l?this.currentUrlTree.fragment:s,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=p(p({},this.currentUrlTree.queryParams),o);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=o||null}u!==null&&(u=this.removeEmptyProps(u));let h;try{let d=r?r.snapshot:this.routerState.snapshot.root;h=Hu(d)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return Gu(h,t,u,c??null,this.urlSerializer)}navigateByUrl(t,n={skipLocationChange:!1}){let r=Cr(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,hi,null,n)}navigate(t,n={skipLocationChange:!1}){return Kp(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(ta(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,n){let r;if(n===!0?r=p({},yh):n===!1?r=p({},_h):r=n,Cr(t))return Du(this.currentUrlTree,t,r);let o=this.parseUrl(t);return Du(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((n,[r,o])=>(o!=null&&(n[r]=o),n),{})}scheduleNavigation(t,n,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((h,d)=>{a=h,l=d});let u=this.pendingTasks.add();return bh(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Kp(i){for(let e=0;e<i.length;e++)if(i[e]==null)throw new ne(4008,!1)}var Zp=new K("");function nl(i,...e){return Qi([{provide:jo,multi:!0,useValue:i},[],{provide:Tn,useFactory:Jp},{provide:ru,multi:!0,useFactory:Qp},e.map(t=>t.\u0275providers)])}function Jp(){return A(tl).routerState.root}function Qp(){let i=A(cr);return e=>{let t=i.get(oo);if(e!==t.components[0])return;let n=i.get(tl),r=i.get(em);i.get(tm)===1&&n.initialNavigation(),i.get(nm,null,{optional:!0})?.setUpPreloading(),i.get(Zp,null,{optional:!0})?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var em=new K("",{factory:()=>new ft}),tm=new K("",{factory:()=>1});var nm=new K("");var im="@",om=(()=>{class i{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=A(cr);loadingSchedulerFn=A(sm,{optional:!0});_engine;constructor(t,n,r,o,s){this.doc=t,this.delegate=n,this.zone=r,this.animationType=o,this.moduleImpl=s}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-PMOV6RK6.js").then(r=>r),n;return this.loadingSchedulerFn?n=this.loadingSchedulerFn(t):n=t(),n.catch(r=>{throw new ne(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:o})=>{this._engine=r(this.animationType,this.doc);let s=new o(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(t,n){let r=this.delegate.createRenderer(t,n);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let o=new rl(r);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(s=>{let a=s.createRenderer(t,n);o.use(a),this.scheduler??=this.injector.get(Gc,null,{optional:!0}),this.scheduler?.notify(10)}).catch(s=>{o.use(r)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(t){this._engine?.flush(),this.delegate.componentReplaced?.(t)}static \u0275fac=function(n){eu()};static \u0275prov=V({token:i,factory:i.\u0275fac})}return i})(),rl=class{delegate;replay=[];\u0275type=1;constructor(e){this.delegate=e}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,n,r){this.delegate.insertBefore(e,t,n,r)}removeChild(e,t,n,r){this.delegate.removeChild(e,t,n,r)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){this.shouldReplay(t)&&this.replay.push(r=>r.setProperty(e,t,n)),this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n,r){return this.shouldReplay(t)&&this.replay.push(o=>o.listen(e,t,n,r)),this.delegate.listen(e,t,n,r)}shouldReplay(e){return this.replay!==null&&e.startsWith(im)}},sm=new K("");function Ch(i="animations"){return oa("NgAsyncAnimations"),Qi([{provide:io,useFactory:()=>new om(A(Ce),A(si),A(ur),i)},{provide:qc,useValue:i==="noop"?"NoopAnimations":"BrowserAnimations"}])}var wh=[];var xh={providers:[Hc(),nl(wh),Ch()]};function m(i,e,t){return(e=(function(n){var r=(function(o,s){if(typeof o!="object"||!o)return o;var a=o[Symbol.toPrimitive];if(a!==void 0){var l=a.call(o,s);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(o)})(n,"string");return typeof r=="symbol"?r:r+""})(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}var qo=class{constructor(){m(this,"browserShadowBlurConstant",1),m(this,"DPI",96),m(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),m(this,"perfLimitSizeTotal",2097152),m(this,"maxCacheSideLimit",4096),m(this,"minCacheSideLimit",256),m(this,"disableStyleCopyPaste",!1),m(this,"enableGLFiltering",!0),m(this,"textureSize",4096),m(this,"forceGLPutImageData",!1),m(this,"cachesBoundsOfCurve",!1),m(this,"fontPaths",{}),m(this,"NUM_FRACTION_DIGITS",4)}},H=new class extends qo{constructor(i){super(),this.configure(i)}configure(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,i)}addFonts(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=p(p({},this.fontPaths),i)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(i=>{delete this.fontPaths[i]})}clearFonts(){this.fontPaths={}}restoreDefaults(i){let e=new qo,t=i?.reduce((n,r)=>(n[r]=e[r],n),{})||e;this.configure(t)}},fn=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[i]("fabric",...t)},et=class extends Error{constructor(e,t){super(`fabric: ${e}`,t)}},ml=class extends et{constructor(e){super(`${e} 'options.signal' is in 'aborted' state`)}},vl=class{},bl=class extends vl{testPrecision(e,t){let n=`precision ${t} float;
void main(){}`,r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,n),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))}queryWebGL(e){let t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(t,n)),t.getExtension("WEBGL_lose_context").loseContext(),fn("log",`WebGL: max texture size ${this.maxTextureSize}`))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}},am={},Sh;var St=()=>Sh||(Sh={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new bl,dispose(){},copyPasteData:am}),Vr=()=>St().document,Cs=()=>St().window,Xh=()=>{var i;return Math.max((i=H.devicePixelRatio)!==null&&i!==void 0?i:Cs().devicePixelRatio,1)},Di=new class{constructor(){m(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(i){let{fontFamily:e,fontStyle:t,fontWeight:n}=i;e=e.toLowerCase();let r=this.charWidthsCache;r.has(e)||r.set(e,new Map);let o=r.get(e),s=`${t.toLowerCase()}_${(n+"").toLowerCase()}`;return o.has(s)||o.set(s,new Map),o.get(s)}clearFontCache(i){i?this.charWidthsCache.delete((i||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(i){let{perfLimitSizeTotal:e}=H,t=Math.sqrt(e*i);return[Math.floor(t),Math.floor(e/t)]}},yl="7.1.0";function Wo(){}var gn=Math.PI/2,lm=Math.PI/4,ct=2*Math.PI,Zl=Math.PI/180,ke=Object.freeze([1,0,0,1,0,0]),Jl=16,nn=.4477152502,N="center",X="left",Ie="top",_l="bottom",ue="right",Re="none",Ql=/\r?\n/,qh="moving",ws="scaling",Kh="rotating",ec="rotate",Zh="skewing",Ir="resizing",Jh="modifyPoly",cm="modifyPath",Ko="changed",xs="scale",Fe="scaleX",$e="scaleY",zr="skewX",$r="skewY",pe="fill",ze="stroke",Zo="modified",kn="ltr",Ut="rtl",Cl="normal",Tr="json",il="svg",k=new class{constructor(){this[Tr]=new Map,this[il]=new Map}has(i){return this[Tr].has(i)}getClass(i){let e=this[Tr].get(i);if(!e)throw new et(`No class registered for ${i}`);return e}setClass(i,e){e?this[Tr].set(e,i):(this[Tr].set(i.type,i),this[Tr].set(i.type.toLowerCase(),i))}getSVGClass(i){return this[il].get(i)}setSVGClass(i,e){this[il].set(e??i.type.toLowerCase(),i)}},Jo=new class extends Array{remove(i){let e=this.indexOf(i);e>-1&&this.splice(e,1)}cancelAll(){let i=this.splice(0);return i.forEach(e=>e.abort()),i}cancelByCanvas(i){if(!i)return[];let e=this.filter(t=>{var n;return t.target===i||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===i});return e.forEach(t=>t.abort()),e}cancelByTarget(i){if(!i)return[];let e=this.filter(t=>t.target===i);return e.forEach(t=>t.abort()),e}},wl=class{constructor(){m(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[r,o]=n;this.on(r,o)}),()=>this.off(e);if(t){let n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){let n=[];return Object.entries(e).forEach(r=>{let[o,s]=r;n.push(this.once(o,s))}),()=>n.forEach(r=>r())}if(t){let n=this.on(e,function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];t.call(this,...o),n()});return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){let n=this.__eventListeners[e],r=n.indexOf(t);r>-1&&n.splice(r,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(let n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[r,o]=n;this._removeEventListener(r,o)}):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;let r=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(r)for(let o=0;o<r.length;o++)r[o].call(this,t||{})}},Fn=(i,e)=>{let t=i.indexOf(e);return t!==-1&&i.splice(t,1),i},ut=i=>{if(i===0)return 1;switch(Math.abs(i)/gn){case 1:case 3:return 0;case 2:return-1}return Math.cos(i)},ht=i=>{if(i===0)return 0;let e=i/gn,t=Math.sign(i);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(i)},_=class i{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new i(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new i(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new i(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new i(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new i(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new i(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new i(this.x/e.x,this.y/e.y)}scalarDivide(e){return new i(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new i(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){let t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new i(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new i(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return`${this.x},${this.y}`}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){let t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new i(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tc,n=ht(e),r=ut(e),o=this.subtract(t);return new i(o.x*r-o.y*n,o.x*n+o.y*r).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new i(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}},tc=new _(0,0),Yo=i=>!!i&&Array.isArray(i._objects);function Qh(i){class e extends i{constructor(){super(...arguments),m(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];let s=this._objects.push(...r);return r.forEach(a=>this._onObjectAdded(a)),s}insertAt(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return this._objects.splice(n,0,...o),o.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){let n=this._objects,r=[];for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return s.forEach(l=>{let c=n.indexOf(l);c!==-1&&(n.splice(c,1),r.push(l),this._onObjectRemoved(l))}),r}forEachObject(n){this.getObjects().forEach((r,o,s)=>n(r,o,s))}getObjects(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return r.length===0?[...this._objects]:this._objects.filter(s=>s.isType(...r))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,r){return!!this._objects.includes(n)||!!r&&this._objects.some(o=>o instanceof e&&o.contains(n,!0))}complexity(){return this._objects.reduce((n,r)=>n+=r.complexity?r.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(Fn(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(Fn(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,r){if(!n)return!1;let o=this._objects.indexOf(n);if(o!==0){let s=this.findNewLowerIndex(n,o,r);return Fn(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,r){if(!n)return!1;let o=this._objects.indexOf(n);if(o!==this._objects.length-1){let s=this.findNewUpperIndex(n,o,r);return Fn(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,r){return n!==this._objects[r]&&(Fn(this._objects,n),this._objects.splice(r,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,r,o){let s;if(o){s=r;for(let a=r-1;a>=0;--a)if(n.isOverlapping(this._objects[a])){s=a;break}}else s=r-1;return s}findNewUpperIndex(n,r,o){let s;if(o){s=r;for(let a=r+1;a<this._objects.length;++a)if(n.isOverlapping(this._objects[a])){s=a;break}}else s=r+1;return s}collectObjects(n){let{left:r,top:o,width:s,height:a}=n,{includeIntersecting:l=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=[],u=new _(r,o),h=u.add(new _(s,a));for(let d=this._objects.length-1;d>=0;d--){let f=this._objects[d];f.selectable&&f.visible&&(l&&f.intersectsWithRect(u,h)||f.isContainedWithinRect(u,h)||l&&f.containsPoint(u)||l&&f.containsPoint(h))&&c.push(f)}return c}}return e}var Qo=class extends wl{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(let t in e)this.set(t,e[t])}_setObject(e){for(let t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){let t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}};function Mi(i){return Cs().requestAnimationFrame(i)}function ed(i){return Cs().cancelAnimationFrame(i)}var um=0,pn=()=>um++,Dt=()=>{let i=Vr().createElement("canvas");if(!i||i.getContext===void 0)throw new et("Failed to create `canvas` element");return i},td=()=>Vr().createElement("img"),He=i=>{let e=Dt();return e.width=i.width,e.height=i.height,e},nc=(i,e,t)=>i.toDataURL(`image/${e}`,t),rc=(i,e,t)=>new Promise((n,r)=>{i.toBlob(n,`image/${e}`,t)}),oe=i=>i*Zl,Bt=i=>i/Zl,nd=i=>i.every((e,t)=>e===ke[t]),Se=(i,e,t)=>new _(i).transform(e,t),Ve=i=>{let e=1/(i[0]*i[3]-i[1]*i[2]),t=[e*i[3],-e*i[1],-e*i[2],e*i[0],0,0],{x:n,y:r}=new _(i[4],i[5]).transform(t,!0);return t[4]=-n,t[5]=-r,t},se=(i,e,t)=>[i[0]*e[0]+i[2]*e[1],i[1]*e[0]+i[3]*e[1],i[0]*e[2]+i[2]*e[3],i[1]*e[2]+i[3]*e[3],t?0:i[0]*e[4]+i[2]*e[5]+i[4],t?0:i[1]*e[4]+i[3]*e[5]+i[5]],Ss=(i,e)=>i.reduceRight((t,n)=>n&&t?se(n,t,e):n||t,void 0)||ke.concat(),rd=i=>{let[e,t]=i;return Math.atan2(t,e)},Rr=i=>{let e=rd(i),t=Math.pow(i[0],2)+Math.pow(i[1],2),n=Math.sqrt(t),r=(i[0]*i[3]-i[2]*i[1])/n,o=Math.atan2(i[0]*i[2]+i[1]*i[3],t);return{angle:Bt(e),scaleX:n,scaleY:r,skewX:Bt(o),skewY:0,translateX:i[4]||0,translateY:i[5]||0}},Hr=function(i){return[1,0,0,1,i,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function nr(){let{angle:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=oe(i),r=ut(n),o=ht(n);return[r,o,-o,r,e?e-(r*e-o*t):0,t?t-(o*e+r*t):0]}var Ds=function(i){return[i,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,0,0]},id=i=>Math.tan(oe(i)),ic=i=>[1,0,id(i),1,0,0],oc=i=>[1,id(i),0,1,0,0],ji=i=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:r=!1,skewX:o=0,skewY:s=0}=i,a=Ds(n?-e:e,r?-t:t);return o&&(a=se(a,ic(o),!0)),s&&(a=se(a,oc(s),!0)),a},od=i=>{let{translateX:e=0,translateY:t=0,angle:n=0}=i,r=Hr(e,t);n&&(r=se(r,nr({angle:n})));let o=ji(i);return nd(o)||(r=se(r,o)),r},Ei=function(i){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,r){if(e&&e.aborted)return r(new ml("loadImage"));let o=td(),s;e&&(s=function(l){o.src="",r(l)},e.addEventListener("abort",s,{once:!0}));let a=function(){o.onload=o.onerror=null,s&&e?.removeEventListener("abort",s),n(o)};i?(o.onload=a,o.onerror=function(){s&&e?.removeEventListener("abort",s),r(new et(`Error loading ${o.src}`))},t&&(o.crossOrigin=t),o.src=i):a()})},Lr=function(i){let{signal:e,reviver:t=Wo}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,r)=>{let o=[];e&&e.addEventListener("abort",r,{once:!0}),Promise.all(i.map(s=>k.getClass(s.type).fromObject(s,{signal:e}).then(a=>(t(s,a),o.push(a),a)))).then(n).catch(s=>{o.forEach(a=>{a.dispose&&a.dispose()}),r(s)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},Ni=function(i){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,n)=>{let r=[];e&&e.addEventListener("abort",n,{once:!0});let o=Object.values(i).map(a=>a&&a.type&&k.has(a.type)?Lr([a],{signal:e}).then(l=>{let[c]=l;return r.push(c),c}):a),s=Object.keys(i);Promise.all(o).then(a=>a.reduce((l,c,u)=>(l[s[u]]=c,l),{})).then(t).catch(a=>{r.forEach(l=>{l.dispose&&l.dispose()}),n(a)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},rr=function(i){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in i&&(e[t]=i[t]),e),{})},sc=(i,e)=>Object.keys(i).reduce((t,n)=>(e(i[n],n,i)&&(t[n]=i[n]),t),{}),Q=(i,e)=>parseFloat(Number(i).toFixed(e)),Ur=i=>"matrix("+i.map(e=>Q(e,H.NUM_FRACTION_DIGITS)).join(" ")+")",Qe=i=>!!i&&i.toLive!==void 0,Dh=i=>!!i&&typeof i.toObject=="function",Mh=i=>!!i&&i.offsetX!==void 0&&"source"in i,Pn=i=>!!i&&"multiSelectionStacking"in i;function sd(i){let e=i&&st(i),t=0,n=0;if(!i||!e)return{left:t,top:n};let r=i,o=e.documentElement,s=e.body||{scrollLeft:0,scrollTop:0};for(;r&&(r.parentNode||r.host)&&(r=r.parentNode||r.host,r===e?(t=s.scrollLeft||o.scrollLeft||0,n=s.scrollTop||o.scrollTop||0):(t+=r.scrollLeft||0,n+=r.scrollTop||0),r.nodeType!==1||r.style.position!=="fixed"););return{left:t,top:n}}var st=i=>i.ownerDocument||null,ad=i=>{var e;return((e=i.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},ld=function(i,e,t){let{width:n,height:r}=t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;i.width=n,i.height=r,o>1&&(i.setAttribute("width",(n*o).toString()),i.setAttribute("height",(r*o).toString()),e.scale(o,o))},xl=(i,e)=>{let{width:t,height:n}=e;t&&(i.style.width=typeof t=="number"?`${t}px`:t),n&&(i.style.height=typeof n=="number"?`${n}px`:n)};function Eh(i){return i.onselectstart!==void 0&&(i.onselectstart=()=>!1),i.style.userSelect=Re,i}var es=class{constructor(e){m(this,"_originalCanvasStyle",void 0),m(this,"lower",void 0);let t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){let t=(n=e)&&n.getContext!==void 0?e:e&&Vr().getElementById(e)||Dt();var n;if(t.hasAttribute("data-fabric"))throw new et("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e,{el:r}=this.lower;r.classList.remove("lower-canvas"),r.removeAttribute("data-fabric"),r.setAttribute("width",`${t}`),r.setAttribute("height",`${n}`),r.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){let{el:n,ctx:r}=this.lower;ld(n,r,e,t)}setCSSDimensions(e){xl(this.lower.el,e)}calcOffset(){return(function(e){var t;let n=e&&st(e),r={left:0,top:0};if(!n)return r;let o=((t=ad(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};r.left+=parseInt(o.borderLeftWidth,10)||0,r.top+=parseInt(o.borderTopWidth,10)||0,r.left+=parseInt(o.paddingLeft,10)||0,r.top+=parseInt(o.paddingTop,10)||0;let s={left:0,top:0},a=n.documentElement;e.getBoundingClientRect!==void 0&&(s=e.getBoundingClientRect());let l=sd(e);return{left:s.left+l.left-(a.clientLeft||0)+r.left,top:s.top+l.top-(a.clientTop||0)+r.top}})(this.lower.el)}dispose(){St().dispose(this.lower.el),delete this.lower}},hm={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...ke],patternQuality:"best"},ki=class i extends Qh(Qo){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return i.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new es(e)}add(){let e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let o=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),o}remove(){let e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(fn("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Xh():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){let r=p({width:this.width,height:this.height},e);this.elements.setDimensions(r,this.getRetinaScaling()),this.hasLostContext=!0,this.width=r.width,this.height=r.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){let n=e,r=[...this.viewportTransform],o=Se(e,Ve(r));r[0]=t,r[3]=t;let s=Se(o,r);r[4]+=n.x-s.x,r[5]+=n.y-s.y,this.setViewportTransform(r)}setZoom(e){this.zoomToPoint(new _(0,0),e)}absolutePan(e){let t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new _(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Mi(()=>this.renderAndReset()))}calcViewportBoundaries(){let e=this.width,t=this.height,n=Ve(this.viewportTransform),r=Se({x:0,y:0},n),o=Se({x:e,y:t},n),s=r.min(o),a=r.max(o);return this.vptCoords={tl:s,tr:new _(a.x,s.y),bl:new _(s.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(ed(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;let n=this.viewportTransform,r=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality=this.patternQuality,this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),r&&(r._set("canvas",this),r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,r)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){let n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,r=t.length;n<r;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){let n=this[`${t}Color`],r=this[`${t}Image`],o=this.viewportTransform,s=this[`${t}Vpt`];if(!n&&!r)return;let a=Qe(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?n.toLive(e):n,s&&e.transform(...o),a){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);let l=n.gradientTransform||n.patternTransform;l&&e.transform(...l)}e.fill(),e.restore()}if(r){e.save();let{skipOffscreen:l}=this;this.skipOffscreen=s,s&&e.transform(...o),r.render(e),this.skipOffscreen=l,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenterPoint(){return new _(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new _(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new _(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new _(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new _(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Se(this.getCenterPoint(),Ve(this.viewportTransform))}_centerObject(e,t){e.setXY(t,N,N),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){let n=this.clipPath,r=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return p(p(D(p({version:yl},rr(this,t)),{objects:this._objects.filter(o=>!o.excludeFromExport).map(o=>this._toObject(o,e,t))}),this.__serializeBgOverlay(e,t)),r?{clipPath:r}:null)}_toObject(e,t,n){let r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);let o=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!r),o}__serializeBgOverlay(e,t){let n={},r=this.backgroundImage,o=this.overlayImage,s=this.backgroundColor,a=this.overlayColor;return Qe(s)?s.excludeFromExport||(n.background=s.toObject(t)):s&&(n.background=s),Qe(a)?a.excludeFromExport||(n.overlay=a.toObject(t)):a&&(n.overlay=a),r&&!r.excludeFromExport&&(n.backgroundImage=this._toObject(r,e,t)),o&&!o.excludeFromExport&&(n.overlayImage=this._toObject(o,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;let n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push(`<g clip-path="url(#${this.clipPath.clipPathId})" >
`),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){let n=t.width||`${this.width}`,r=t.height||`${this.height}`,o=H.NUM_FRACTION_DIGITS,s=t.viewBox,a;if(s)a=`viewBox="${s.x} ${s.y} ${s.width} ${s.height}" `;else if(this.svgViewportTransformation){let l=this.viewportTransform;a=`viewBox="${Q(-l[4]/l[0],o)} ${Q(-l[5]/l[3],o)} ${Q(this.width/l[0],o)} ${Q(this.height/l[3],o)}" `}else a=`viewBox="0 0 ${this.width} ${this.height}" `;e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',r,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",yl,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){let t=this.clipPath;return t?(t.clipPathId=`CLIPPATH_${pn()}`,`<clipPath id="${t.clipPathId}" >
${t.toClipPathSVG(e.reviver)}</clipPath>
`):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{let t=this[`${e}Color`];if(Qe(t)){let n=this[`${e}Vpt`],r=this.viewportTransform,o={isType:()=>!1,width:this.width/(n?r[0]:1),height:this.height/(n?r[3]:1)};return t.toSVG(o,{additionalTransform:n?Ur(r):""})}}).join("")}createSVGFontFacesMarkup(){let e=[],t={},n=H.fontPaths;this._objects.forEach(function o(s){e.push(s),Yo(s)&&s._objects.forEach(o)}),e.forEach(o=>{if(!(s=o)||typeof s._renderText!="function")return;var s;let{styles:a,fontFamily:l}=o;!t[l]&&n[l]&&(t[l]=!0,a&&Object.values(a).forEach(c=>{Object.values(c).forEach(u=>{let{fontFamily:h=""}=u;!t[h]&&n[h]&&(t[h]=!0)})}))});let r=Object.keys(t).map(o=>`		@font-face {
			font-family: '${o}';
			src: url('${n[o]}');
		}
`).join("");return r?`	<style type="text/css"><![CDATA[
${r}]]></style>
`:""}_setSVGObjects(e,t){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,t)})}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){let r=this[t];r&&!r.excludeFromExport&&r.toSVG&&e.push(r.toSVG(n))}_setSVGBgOverlayColor(e,t){let n=this[`${t}Color`];if(n)if(Qe(n)){let r=n.repeat||"",o=this.width,s=this.height,a=this[`${t}Vpt`]?Ur(Ve(this.viewportTransform)):"";e.push(`<rect transform="${a} translate(${o/2},${s/2})" x="${n.offsetX-o/2}" y="${n.offsetY-s/2}" width="${r!=="repeat-y"&&r!=="no-repeat"||!Mh(n)?o:n.source.width}" height="${r!=="repeat-x"&&r!=="no-repeat"||!Mh(n)?s:n.source.height}" fill="url(#SVGID_${n.id})"></rect>
`)}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new et("`json` is undefined"));let d=typeof e=="string"?JSON.parse(e):e,{objects:r=[]}=d,o=te(d,["objects"]),{backgroundImage:s,background:a,overlayImage:l,overlay:c,clipPath:u}=o,h=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Lr(r,{reviver:t,signal:n}),Ni({backgroundImage:s,backgroundColor:a,overlayImage:l,overlayColor:c,clipPath:u},{signal:n})]).then(f=>{let[g,v]=f;return this.clear(),this.add(...g),this.set(o),this.set(v),this.renderOnAddRemove=h,this})}clone(e){let t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){let e=He(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:t="png",quality:n=1,multiplier:r=1,enableRetinaScaling:o=!1}=e,s=r*(o?this.getRetinaScaling():1);return nc(this.toCanvasElement(s,e),t,n)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:t="png",quality:n=1,multiplier:r=1,enableRetinaScaling:o=!1}=e,s=r*(o?this.getRetinaScaling():1);return rc(this.toCanvasElement(s,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:r,top:o,filter:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=(t||this.width)*e,l=(n||this.height)*e,c=this.getZoom(),u=this.width,h=this.height,d=this.skipControlsDrawing,f=c*e,g=this.viewportTransform,v=[f,0,0,f,(g[4]-(r||0))*e,(g[5]-(o||0))*e],y=this.enableRetinaScaling,w=He({width:a,height:l}),S=s?this._objects.filter(T=>s(T)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=v,this.width=a,this.height=l,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),S),this.viewportTransform=g,this.width=u,this.height=h,this.calcViewportBoundaries(),this.enableRetinaScaling=y,this.skipControlsDrawing=d,w}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Jo.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{let n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return`#<Canvas (${this.complexity()}): { objects: ${this._objects.length} }>`}};m(ki,"ownDefaults",hm);var dm=["touchstart","touchmove","touchend"],cd=i=>{let e=sd(i.target),t=(function(n){let r=n.changedTouches;return r&&r[0]?r[0]:n})(i);return new _(t.clientX+e.left,t.clientY+e.top)},ts=i=>dm.includes(i.type)||i.pointerType==="touch",Th=i=>{i.preventDefault(),i.stopPropagation()},wt=i=>{let e=0,t=0,n=0,r=0;for(let o=0,s=i.length;o<s;o++){let{x:a,y:l}=i[o];(a>n||!o)&&(n=a),(a<e||!o)&&(e=a),(l>r||!o)&&(r=l),(l<t||!o)&&(t=l)}return{left:e,top:t,width:n-e,height:r-t}},ud=(i,e)=>jr(i,se(e,i.calcOwnMatrix())),jr=(i,e)=>{let l=Rr(e),{translateX:t,translateY:n,scaleX:r,scaleY:o}=l,s=te(l,["translateX","translateY","scaleX","scaleY"]),a=new _(t,n);i.flipX=!1,i.flipY=!1,Object.assign(i,s),i.set({scaleX:r,scaleY:o}),i.setPositionByOrigin(a,N,N)},hd=i=>{i.scaleX=1,i.scaleY=1,i.skewX=0,i.skewY=0,i.flipX=!1,i.flipY=!1,i.rotate(0)},ac=i=>({scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,angle:i.angle,left:i.left,flipX:i.flipX,flipY:i.flipY,top:i.top}),Ms=(i,e,t)=>{let n=i/2,r=e/2,o=[new _(-n,-r),new _(n,-r),new _(-n,r),new _(n,r)].map(a=>a.transform(t)),s=wt(o);return new _(s.width,s.height)},Bi=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ke;return se(Ve(arguments.length>1&&arguments[1]!==void 0?arguments[1]:ke),i)},Vt=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ke,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ke;return i.transform(Bi(e,t))},dd=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ke,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ke;return i.transform(Bi(e,t),!0)},Sl=(i,e,t)=>{let n=Bi(e,t);return jr(i,se(n,i.calcOwnMatrix())),n},fm={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Oe=i=>typeof i=="string"?fm[i]:i-.5,gm=new _(1,0),fd=new _,lc=(i,e)=>i.rotate(e),Fi=(i,e)=>new _(e).subtract(i),ns=i=>i.distanceFrom(fd),rs=(i,e)=>Math.atan2(Fr(i,e),gd(i,e)),cc=i=>rs(gm,i),Es=i=>i.eq(fd)?i:i.scalarDivide(ns(i)),uc=function(i){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Es(new _(-i.y,i.x).scalarMultiply(e?1:-1))},Fr=(i,e)=>i.x*e.y-i.y*e.x,gd=(i,e)=>i.x*e.x+i.y*e.y,Dl=(i,e,t)=>{if(i.eq(e)||i.eq(t))return!0;let n=Fr(e,t),r=Fr(e,i),o=Fr(t,i);return n>=0?r>=0&&o<=0:!(r<=0&&o>=0)},is="not-allowed";function pd(i){return Oe(i.originX)===Oe(N)&&Oe(i.originY)===Oe(N)}function Oh(i){return .5-Oe(i)}var lt=(i,e)=>i[e],hc=(i,e,t,n)=>({e:i,transform:e,pointer:new _(t,n)});function md(i,e,t){let n=t,r=Vt(i.getCenterPoint(),i.canvas.viewportTransform,void 0),o=cc(Fi(r,n))+ct;return Math.round(o%ct/lm)}function Ts(i,e,t,n,r){var o;let{target:s,corner:a}=i,l=s.controls[a],c=((o=s.canvas)===null||o===void 0?void 0:o.getZoom())||1,u=s.padding/c,h=(function(d,f,g,v){let y=d.getRelativeCenterPoint(),w=g!==void 0&&v!==void 0?d.translateToGivenOrigin(y,N,N,g,v):new _(d.left,d.top);return(d.angle?f.rotate(-oe(d.angle),y):f).subtract(w)})(s,new _(n,r),e,t);return h.x>=u&&(h.x-=u),h.x<=-u&&(h.x+=u),h.y>=u&&(h.y-=u),h.y<=u&&(h.y+=u),h.x-=l.offsetX,h.y-=l.offsetY,h}var os=i=>i.replace(/\s+/g," "),Ah={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},ol=(i,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+(e-i)*(2/3-t)*6:i),kh=(i,e,t,n)=>{i/=255,e/=255,t/=255;let r=Math.max(i,e,t),o=Math.min(i,e,t),s,a,l=(r+o)/2;if(r===o)s=a=0;else{let c=r-o;switch(a=l>.5?c/(2-r-o):c/(r+o),r){case i:s=(e-t)/c+(e<t?6:0);break;case e:s=(t-i)/c+2;break;case t:s=(i-e)/c+4}s/=6}return[Math.round(360*s),Math.round(100*a),Math.round(100*l),n]},Fh=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(i)/(i.endsWith("%")?100:1)},No=i=>Math.min(Math.round(i),255).toString(16).toUpperCase().padStart(2,"0"),Ph=i=>{let[e,t,n,r=1]=i,o=Math.round(.3*e+.59*t+.11*n);return[o,o,o,r]},Le=class i{constructor(e){if(m(this,"isUnrecognised",!1),e)if(e instanceof i)this.setSource([...e._source]);else if(Array.isArray(e)){let[t,n,r,o=1]=e;this.setSource([t,n,r,o])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in Ah&&(e=Ah[e]),e==="transparent"?[255,255,255,0]:i.sourceFromHex(e)||i.sourceFromRgb(e)||i.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){let[e,t,n]=this.getSource();return`rgb(${e},${t},${n})`}toRgba(){return`rgba(${this.getSource().join(",")})`}toHsl(){let[e,t,n]=kh(...this.getSource());return`hsl(${e},${t}%,${n}%)`}toHsla(){let[e,t,n,r]=kh(...this.getSource());return`hsla(${e},${t}%,${n}%,${r})`}toHex(){return this.toHexa().slice(0,6)}toHexa(){let[e,t,n,r]=this.getSource();return`${No(e)}${No(t)}${No(n)}${No(Math.round(255*r))}`}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(Ph(this.getSource())),this}toBlackWhite(e){let[t,,,n]=Ph(this.getSource()),r=t<(e||127)?0:255;return this.setSource([r,r,r,n]),this}overlayWith(e){e instanceof i||(e=new i(e));let t=this.getSource(),n=e.getSource(),[r,o,s]=t.map((a,l)=>Math.round(.5*a+.5*n[l]));return this.setSource([r,o,s,t[3]]),this}static fromRgb(e){return i.fromRgba(e)}static fromRgba(e){return new i(i.sourceFromRgb(e))}static sourceFromRgb(e){let t=os(e).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(t){let[n,r,o]=t.slice(1,4).map(s=>{let a=parseFloat(s);return s.endsWith("%")?Math.round(2.55*a):a});return[n,r,o,Fh(t[4])]}}static fromHsl(e){return i.fromHsla(e)}static fromHsla(e){return new i(i.sourceFromHsl(e))}static sourceFromHsl(e){let t=os(e).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!t)return;let n=(i.parseAngletoDegrees(t[1])%360+360)%360/360,r=parseFloat(t[2])/100,o=parseFloat(t[3])/100,s,a,l;if(r===0)s=a=l=o;else{let c=o<=.5?o*(r+1):o+r-o*r,u=2*o-c;s=ol(u,c,n+1/3),a=ol(u,c,n),l=ol(u,c,n-1/3)}return[Math.round(255*s),Math.round(255*a),Math.round(255*l),Fh(t[4])]}static fromHex(e){return new i(i.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){let t=e.slice(e.indexOf("#")+1),n;n=t.length<=4?t.split("").map(l=>l+l):t.match(/.{2}/g);let[r,o,s,a=255]=n.map(l=>parseInt(l,16));return[r,o,s,a/255]}}static parseAngletoDegrees(e){let t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?Bt(n):t.includes("turn")?360*n:n}},Zn=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jl,t=/\D{0,2}$/.exec(i),n=parseFloat(i),r=H.DPI;switch(t?.[0]){case"mm":return n*r/25.4;case"cm":return n*r/2.54;case"in":return n*r;case"pt":return n*r/72;case"pc":return n*r/72*12;case"em":return n*e;default:return n}},vd=i=>{let[e,t]=i.trim().split(" "),[n,r]=(o=e)&&o!==Re?[o.slice(1,4),o.slice(5,8)]:o===Re?[o,o]:["Mid","Mid"];var o;return{meetOrSlice:t||"meet",alignX:n,alignY:r}},Pi=function(i,e){let t,n,r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t=`url(#SVGID_${e.id})`;else{let o=new Le(e),s=o.getAlpha();t=o.toRgb(),s!==1&&(n=s.toString())}else t="none";return r?`${i}: ${t}; ${n?`${i}-opacity: ${n}; `:""}`:`${i}="${t}" ${n?`${i}-opacity="${n}" `:""}`},ss=class{getSvgStyles(e){let t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):Re,o=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=e?"":this.getSvgFilter(),d=Pi(pe,this.fill);return[Pi(ze,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",d,"fill-rule: ",t,"; ","opacity: ",c,";",h,u].join("")}getSvgFilter(){return this.shadow?`filter: url(#SVGID_${this.shadow.id});`:""}getSvgCommons(){return[this.id?`id="${this.id}" `:"",this.clipPath?`clip-path="url(#${this.clipPath.clipPathId})" `:""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=e?this.calcTransformMatrix():this.calcOwnMatrix();return`${`transform="${Ur(n)}`}${t}" `}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),o=e.indexOf("COMMON_PARTS");return e[o]=r,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:r,additionalTransform:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t?"":`style="${this.getSvgStyles()}" `,a=r?`style="${this.getSvgFilter()}" `:"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,h=this.stroke,d=this.fill,f=this.shadow,g=[],v=e.indexOf("COMMON_PARTS"),y;l&&(l.clipPathId=`CLIPPATH_${pn()}`,y=`<clipPath id="${l.clipPathId}" >
${l.toClipPathSVG(n)}</clipPath>
`),u&&g.push("<g ",a,this.getSvgCommons(),` >
`),g.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);let w=[s,c,t?"":this.addPaintOrder()," ",o?`transform="${o}" `:""].join("");return e[v]=w,Qe(d)&&g.push(d.toSVG(this)),Qe(h)&&g.push(h.toSVG(this)),f&&g.push(f.toSVG(this)),l&&g.push(y),g.push(e.join("")),g.push(`</g>
`),u&&g.push(`</g>
`),n?n(g.join("")):g.join("")}addPaintOrder(){return this.paintFirst!==pe?` paint-order="${this.paintFirst}" `:""}};function Os(i){return new RegExp("^("+i.join("|")+")\\b","i")}var Qn="textDecorationThickness",bd=["fontSize","fontWeight","fontFamily","fontStyle"],yd=["underline","overline","linethrough"],_d=[...bd,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],Cd=[..._d,...yd,"textBackgroundColor","direction",Qn],pm=[...bd,...yd,ze,"strokeWidth",pe,"deltaY","textBackgroundColor",Qn],mm={_reNewline:Ql,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:Cl,fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:X,fontStyle:Cl,lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:X,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:kn,CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[Qn]:66.667},Ct="justify",as="justify-left",Ti="justify-right",Oi="justify-center",at=String.raw`[-+]?(?:\d*\.\d+|\d+\.?)(?:[eE][-+]?\d+)?`,sl=String.raw`(?:\s*,?\s+|\s*,\s*)`;var vm=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+at+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+at+"))?\\s+(.*)"),bm={cx:X,x:X,r:"radius",cy:Ie,y:Ie,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":Qn},al="font-size",ll="clip-path",xC=Os(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),SC=Os(["symbol","image","marker","pattern","view","svg"]),Ih=Os(["symbol","g","a","svg","clipPath","defs"]),DC=new RegExp(String.raw`^\s*(${at})${sl}(${at})${sl}(${at})${sl}(${at})\s*$`),Rh="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",Lh=new RegExp("(?:\\s|^)"+Rh+Rh+"("+at+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)"),xt=class i{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=typeof e=="string"?i.parseShadow(e):e;Object.assign(this,i.ownDefaults,t),this.id=pn()}static parseShadow(e){let t=e.trim(),[,n=0,r=0,o=0]=(Lh.exec(t)||[]).map(s=>parseFloat(s)||0);return{color:(t.replace(Lh,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:r,blur:o}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){let t=lc(new _(this.offsetX,this.offsetY),oe(-e.angle)),n=new Le(this.color),r=40,o=40;return e.width&&e.height&&(r=100*Q((Math.abs(t.x)+this.blur)/e.width,H.NUM_FRACTION_DIGITS)+20,o=100*Q((Math.abs(t.y)+this.blur)/e.height,H.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),`<filter id="SVGID_${this.id}" y="-${o}%" height="${100+2*o}%" x="-${r}%" width="${100+2*r}%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="${Q(this.blur?this.blur/2:0,H.NUM_FRACTION_DIGITS)}"></feGaussianBlur>
	<feOffset dx="${Q(t.x,H.NUM_FRACTION_DIGITS)}" dy="${Q(t.y,H.NUM_FRACTION_DIGITS)}" result="oBlur" ></feOffset>
	<feFlood flood-color="${n.toRgb()}" flood-opacity="${n.getAlpha()}"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`}toObject(){let e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=i.ownDefaults;return this.includeDefaultValues?e:sc(e,(n,r)=>n!==t[r])}static async fromObject(e){return new this(e)}};m(xt,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),m(xt,"type","shadow"),k.setClass(xt,"shadow");var er=(i,e,t)=>Math.max(i,Math.min(e,t)),ym=[Ie,X,Fe,$e,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",zr,$r],zt=[pe,ze,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],_m={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:N,originY:N,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:pe,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},cl=(i,e,t,n)=>(i<Math.abs(e)?(i=e,n=t/4):n=e===0&&i===0?t/ct*Math.asin(1):t/ct*Math.asin(e/i),{a:i,c:e,p:t,s:n}),Uh=(i,e,t,n,r)=>i*Math.pow(2,10*(n-=1))*Math.sin((n*r-e)*ct/t),wd=(i,e,t,n)=>-t*Math.cos(i/n*gn)+t+e,Ml=(i,e,t,n)=>(i/=n)<1/2.75?t*(7.5625*i*i)+e:i<2/2.75?t*(7.5625*(i-=1.5/2.75)*i+.75)+e:i<2.5/2.75?t*(7.5625*(i-=2.25/2.75)*i+.9375)+e:t*(7.5625*(i-=2.625/2.75)*i+.984375)+e,jh=(i,e,t,n)=>t-Ml(n-i,0,t,n)+e,Cm=Object.freeze({__proto__:null,defaultEasing:wd,easeInBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(i/=n)*i*((r+1)*i-r)+e},easeInBounce:jh,easeInCirc:(i,e,t,n)=>-t*(Math.sqrt(1-(i/=n)*i)-1)+e,easeInCubic:(i,e,t,n)=>t*(i/n)**3+e,easeInElastic:(i,e,t,n)=>{let r=t,o=0;if(i===0)return e;if((i/=n)===1)return e+t;o||(o=.3*n);let{a:s,s:a,p:l}=cl(r,t,o,1.70158);return-Uh(s,a,l,i,n)+e},easeInExpo:(i,e,t,n)=>i===0?e:t*2**(10*(i/n-1))+e,easeInOutBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(i/=n/2)<1?t/2*(i*i*((1+(r*=1.525))*i-r))+e:t/2*((i-=2)*i*((1+(r*=1.525))*i+r)+2)+e},easeInOutBounce:(i,e,t,n)=>i<n/2?.5*jh(2*i,0,t,n)+e:.5*Ml(2*i-n,0,t,n)+.5*t+e,easeInOutCirc:(i,e,t,n)=>(i/=n/2)<1?-t/2*(Math.sqrt(1-i**2)-1)+e:t/2*(Math.sqrt(1-(i-=2)*i)+1)+e,easeInOutCubic:(i,e,t,n)=>(i/=n/2)<1?t/2*i**3+e:t/2*((i-2)**3+2)+e,easeInOutElastic:(i,e,t,n)=>{let r=t,o=0;if(i===0)return e;if((i/=n/2)===2)return e+t;o||(o=n*(.3*1.5));let{a:s,s:a,p:l,c}=cl(r,t,o,1.70158);return i<1?-.5*Uh(s,a,l,i,n)+e:s*Math.pow(2,-10*(i-=1))*Math.sin((i*n-a)*ct/l)*.5+c+e},easeInOutExpo:(i,e,t,n)=>i===0?e:i===n?e+t:(i/=n/2)<1?t/2*2**(10*(i-1))+e:t/2*-(2**(-10*--i)+2)+e,easeInOutQuad:(i,e,t,n)=>(i/=n/2)<1?t/2*i**2+e:-t/2*(--i*(i-2)-1)+e,easeInOutQuart:(i,e,t,n)=>(i/=n/2)<1?t/2*i**4+e:-t/2*((i-=2)*i**3-2)+e,easeInOutQuint:(i,e,t,n)=>(i/=n/2)<1?t/2*i**5+e:t/2*((i-2)**5+2)+e,easeInOutSine:(i,e,t,n)=>-t/2*(Math.cos(Math.PI*i/n)-1)+e,easeInQuad:(i,e,t,n)=>t*(i/=n)*i+e,easeInQuart:(i,e,t,n)=>t*(i/=n)*i**3+e,easeInQuint:(i,e,t,n)=>t*(i/n)**5+e,easeInSine:(i,e,t,n)=>-t*Math.cos(i/n*gn)+t+e,easeOutBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((i=i/n-1)*i*((r+1)*i+r)+1)+e},easeOutBounce:Ml,easeOutCirc:(i,e,t,n)=>t*Math.sqrt(1-(i=i/n-1)*i)+e,easeOutCubic:(i,e,t,n)=>t*((i/n-1)**3+1)+e,easeOutElastic:(i,e,t,n)=>{let r=t,o=0;if(i===0)return e;if((i/=n)===1)return e+t;o||(o=.3*n);let{a:s,s:a,p:l,c}=cl(r,t,o,1.70158);return s*2**(-10*i)*Math.sin((i*n-a)*ct/l)+c+e},easeOutExpo:(i,e,t,n)=>i===n?e+t:t*-(2**(-10*i/n)+1)+e,easeOutQuad:(i,e,t,n)=>-t*(i/=n)*(i-2)+e,easeOutQuart:(i,e,t,n)=>-t*((i=i/n-1)*i**3-1)+e,easeOutQuint:(i,e,t,n)=>t*((i/n-1)**5+1)+e,easeOutSine:(i,e,t,n)=>t*Math.sin(i/n*gn)+e}),wm=()=>!1,Ii=class{constructor(e){let{startValue:t,byValue:n,duration:r=500,delay:o=0,easing:s=wd,onStart:a=Wo,onChange:l=Wo,onComplete:c=Wo,abort:u=wm,target:h}=e;m(this,"_state","pending"),m(this,"durationProgress",0),m(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=r,this.delay=o,this.easing=s,this._onStart=a,this._onChange=l,this._onComplete=c,this._abort=u,this.target=h,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){let e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>Mi(e),this.delay):Mi(e)}tick(e){let t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;let{value:r,valueProgress:o}=this.calculate(n);this.value=Object.freeze(r),this.valueProgress=o,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Mi(this.tick)))}register(){Jo.push(this)}unregister(){Jo.remove(this)}abort(){this._state="aborted",this.unregister()}},El=class extends Ii{constructor(e){let o=e,{startValue:t=0,endValue:n=100}=o,r=te(o,["startValue","endValue"]);super(D(p({},r),{startValue:t,byValue:n-t}))}calculate(e){let t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}},Tl=class extends Ii{constructor(e){let o=e,{startValue:t=[0],endValue:n=[100]}=o,r=te(o,["startValue","endValue"]);super(D(p({},r),{startValue:t,byValue:n.map((s,a)=>s-t[a])}))}calculate(e){let t=this.startValue.map((n,r)=>this.easing(e,n,this.byValue[r],this.duration,r));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}},xm=(i,e,t,n)=>e+t*(1-Math.cos(i/n*gn)),ul=i=>i&&((e,t,n)=>i(new Le(e).toRgba(),t,n)),Ol=class extends Ii{constructor(e){let h=e,{startValue:t,endValue:n,easing:r=xm,onChange:o,onComplete:s,abort:a}=h,l=te(h,["startValue","endValue","easing","onChange","onComplete","abort"]),c=new Le(t).getSource(),u=new Le(n).getSource();super(D(p({},l),{startValue:c,byValue:u.map((d,f)=>d-c[f]),easing:r,onChange:ul(o),onComplete:ul(s),abort:ul(a)}))}calculate(e){let[t,n,r,o]=this.startValue.map((a,l)=>this.easing(e,a,this.byValue[l],this.duration,l)),s=[...[t,n,r].map(Math.round),er(0,o,1)];return{value:s,valueProgress:s.map((a,l)=>this.byValue[l]!==0?Math.abs((a-this.startValue[l])/this.byValue[l]):0).find(a=>a!==0)||0}}};function dc(i){let e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(i)?new Tl(i):new El(i);return e.start(),e}function xd(i){let e=new Ol(i);return e.start(),e}var Jn=class i{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter(r=>!this.includes(r))),this}static isPointContained(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(r||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(r||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{let o=Fi(t,n),s=Fi(t,e).divide(o);return r?Math.abs(s.x)===Math.abs(s.y):s.x===s.y&&s.x>=0&&s.x<=1}}static isPointInPolygon(e,t){let n=new _(e).setX(Math.min(e.x-1,...t.map(o=>o.x))),r=0;for(let o=0;o<t.length;o++){let s=this.intersectSegmentSegment(t[o],t[(o+1)%t.length],e,n);if(s.includes(e))return!0;r+=+(s.status==="Intersection")}return r%2==1}static intersectLineLine(e,t,n,r){let o=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],s=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],a=t.x-e.x,l=t.y-e.y,c=r.x-n.x,u=r.y-n.y,h=e.x-n.x,d=e.y-n.y,f=c*d-u*h,g=a*d-l*h,v=u*a-c*l;if(v!==0){let y=f/v,w=g/v;return(o||0<=y&&y<=1)&&(s||0<=w&&w<=1)?new i("Intersection").append(new _(e.x+y*a,e.y+y*l)):new i}if(f===0||g===0){let y=o||s||i.isPointContained(e,n,r)||i.isPointContained(t,n,r)||i.isPointContained(n,e,t)||i.isPointContained(r,e,t);return new i(y?"Coincident":void 0)}return new i("Parallel")}static intersectSegmentLine(e,t,n,r){return i.intersectLineLine(e,t,n,r,!1,!0)}static intersectSegmentSegment(e,t,n,r){return i.intersectLineLine(e,t,n,r,!1,!1)}static intersectLinePolygon(e,t,n){let r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],o=new i,s=n.length;for(let a,l,c,u=0;u<s;u++){if(a=n[u],l=n[(u+1)%s],c=i.intersectLineLine(e,t,a,l,r,!1),c.status==="Coincident")return c;o.append(...c.points)}return o.points.length>0&&(o.status="Intersection"),o}static intersectSegmentPolygon(e,t,n){return i.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){let n=new i,r=e.length,o=[];for(let s=0;s<r;s++){let a=e[s],l=e[(s+1)%r],c=i.intersectSegmentPolygon(a,l,t);c.status==="Coincident"?(o.push(c),n.append(a,l)):n.append(...c.points)}return o.length>0&&o.length===e.length?new i("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){let r=t.min(n),o=t.max(n),s=new _(o.x,r.y),a=new _(r.x,o.y);return i.intersectPolygonPolygon(e,[r,s,o,a])}},Al=class extends Qo{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){let e=this.getRelativeXY();return this.group?Se(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=Se(e,Ve(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new _(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){let{tl:e,tr:t,br:n,bl:r}=this.aCoords||(this.aCoords=this.calcACoords()),o=[e,t,n,r];if(this.group){let s=this.group.calcTransformMatrix();return o.map(a=>Se(a,s))}return o}intersectsWithRect(e,t){return Jn.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){let t=Jn.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){let{left:n,top:r,width:o,height:s}=this.getBoundingRect();return n>=e.x&&n+o<=t.x&&r>=e.y&&r+s<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return Jn.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return wt(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Fe,e),this._set($e,e),this.setCoords()}scaleToWidth(e){let t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){let t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Bt(rd(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||ke.concat()}calcACoords(){let e=nr({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),r=Hr(t,n),o=se(r,e),s=this._getTransformedDimensions(),a=s.x/2,l=s.y/2;return{tl:Se({x:-a,y:-l},o),tr:Se({x:a,y:-l},o),bl:Se({x:-a,y:l},o),br:Se({x:a,y:l},o)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Oe(this.originX),Oe(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;let n=this.transformMatrixKey(e),r=this.matrixCache;return r&&r.key.every((o,s)=>o===n[s])?r.value:(this.group&&(t=se(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){let e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key.every((s,a)=>s===e[a]))return t.value;let n=this.getRelativeCenterPoint(),r={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},o=od(r);return this.ownMatrixCache={key:e,value:o},o}_getNonTransformedDimensions(){return new _(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=p({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth,r=n,o=0;this.strokeUniform&&(r=0,o=n);let s=t.width+r,a=t.height+r,l;return l=t.skewX===0&&t.skewY===0?new _(s*t.scaleX,a*t.scaleY):Ms(s,a,ji(t)),l.scalarAdd(o)}translateToGivenOrigin(e,t,n,r,o){let s=e.x,a=e.y,l=Oe(r)-Oe(t),c=Oe(o)-Oe(n);if(l||c){let u=this._getTransformedDimensions();s+=l*u.x,a+=c*u.y}return new _(s,a)}translateToCenterPoint(e,t,n){if(t===N&&n===N)return e;let r=this.translateToGivenOrigin(e,t,n,N,N);return this.angle?r.rotate(oe(this.angle),e):r}translateToOriginPoint(e,t,n){let r=this.translateToGivenOrigin(e,N,N,t,n);return this.angle?r.rotate(oe(this.angle),e):r}getCenterPoint(){let e=this.getRelativeCenterPoint();return this.group?Se(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new _(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.getPositionByOrigin(e,t)}getPositionByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){let r=this.translateToCenterPoint(e,t,n),o=this.translateToOriginPoint(r,this.originX,this.originY);this.set({left:o.x,top:o.y})}_getLeftTopCoords(){return this.getPositionByOrigin(X,Ie)}positionByLeftTop(e){return this.setPositionByOrigin(e,X,Ie)}},Lt=class Xo extends Al{static getDefaults(){return Xo.ownDefaults}get type(){let e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){fn("warn","Setting type has no effect",e)}constructor(e){super(),m(this,"_cacheContext",null),Object.assign(this,Xo.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Dt(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){let t=e.width,n=e.height,r=H.maxCacheSideLimit,o=H.minCacheSideLimit;if(t<=r&&n<=r&&t*n<=H.perfLimitSizeTotal)return t<o&&(e.width=o),n<o&&(e.height=o),e;let s=t/n,[a,l]=Di.limitDimsByArea(s),c=er(o,a,r),u=er(o,l,r);return t>c&&(e.zoomX/=t/c,e.width=c,e.capped=!0),n>u&&(e.zoomY/=n/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){let e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,r=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(r+2),zoomX:e.x,zoomY:e.y,x:n,y:r}}_updateCacheCanvas(){let e=this._cacheCanvas,t=this._cacheContext,{width:n,height:r,zoomX:o,zoomY:s,x:a,y:l}=this._limitCacheSize(this._getCacheCanvasDimensions()),c=n!==e.width||r!==e.height,u=this.zoomX!==o||this.zoomY!==s;if(!e||!t)return!1;if(c||u){n!==e.width||r!==e.height?(e.width=n,e.height=r):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));let h=a/2,d=l/2;return this.cacheTranslationX=Math.round(e.width/2-h)+h,this.cacheTranslationY=Math.round(e.height/2-d)+d,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(o,s),this.zoomX=o,this.zoomY=s,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){let t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new _(Math.abs(this.scaleX),Math.abs(this.scaleY));let e=Rr(this.calcTransformMatrix());return new _(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){let e=this.getObjectScaling();if(this.canvas){let t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Fe&&e!==$e||(t=this._constrainScale(t)),e===Fe&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof xt||(t=new xt(t));let n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){let{zoomX:t,zoomY:n,cacheTranslationX:r,cacheTranslationY:o}=this,{width:s,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:r,cacheTranslationY:o,width:s,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return!!this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return!!this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===ze&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){let r=this.fill,o=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=r,this.stroke=o}createClipPathLayer(e,t){let n=He(t),r=n.getContext("2d");if(r.translate(t.cacheTranslationX,t.cacheTranslationY),r.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach(o=>{o.transform(r)}),t.parentClipPaths.push(e),e.absolutePositioned){let o=Ve(this.calcTransformMatrix());r.transform(o[0],o[1],o[2],o[3],o[4],o[5])}return e.transform(r),e.drawObject(r,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;let r=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,r)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;let t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;let t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){let n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Qe(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(Qe(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;let t=this.shadow,n=this.canvas,r=this.getCanvasRetinaScaling(),[o,,,s]=n?.viewportTransform||ke,a=o*r,l=s*r,c=t.nonScaling?new _(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*H.browserShadowBlurConstant*(a+l)*(c.x+c.y)/4,e.shadowOffsetX=t.offsetX*a*c.x,e.shadowOffsetY=t.offsetY*l*c.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Qe(t))return{offsetX:0,offsetY:0};let n=t.gradientTransform||t.patternTransform,r=-this.width/2+t.offsetX||0,o=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,r,o):e.transform(1,0,0,1,r,o),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:r,offsetY:o}}_renderPaintInOrder(e){this.paintFirst===ze?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){let t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;let r=this._limitCacheSize(this._getCacheCanvasDimensions()),o=this.getCanvasRetinaScaling(),s=r.x/this.scaleX/o,a=r.y/this.scaleY/o,l=He({width:Math.ceil(s),height:Math.ceil(a)}),c=l.getContext("2d");c&&(c.beginPath(),c.moveTo(0,0),c.lineTo(s,0),c.lineTo(s,a),c.lineTo(0,a),c.closePath(),c.translate(s/2,a/2),c.scale(r.zoomX/this.scaleX/o,r.zoomY/this.scaleY/o),this._applyPatternGradientTransform(c,t),c.fillStyle=t.toLive(e),c.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(o*this.scaleX/r.zoomX,o*this.scaleY/r.zoomY),e.strokeStyle=(n=c.createPattern(l,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new _(this.left+this.width/2,this.top+this.height/2)}clone(e){let t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){let t=this.toCanvasElement(e);return new(k.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=ac(this),n=this.group,r=this.shadow,o=Math.abs,s=e.enableRetinaScaling?Xh():1,a=(e.multiplier||1)*s,l=e.canvasProvider||(S=>new ki(S,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&hd(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&Sl(this,this.getViewportTransform()),this.setCoords();let c=Dt(),u=this.getBoundingRect(),h=this.shadow,d=new _;if(h){let S=h.blur,T=h.nonScaling?new _(1,1):this.getObjectScaling();d.x=2*Math.round(o(h.offsetX)+S)*o(T.x),d.y=2*Math.round(o(h.offsetY)+S)*o(T.y)}let f=u.width+d.x,g=u.height+d.y;c.width=Math.ceil(f),c.height=Math.ceil(g);let v=l(c);e.format==="jpeg"&&(v.backgroundColor="#fff"),this.setPositionByOrigin(new _(v.width/2,v.height/2),N,N);let y=this.canvas;v._objects=[this],this.set("canvas",v),this.setCoords();let w=v.toCanvasElement(a||1,e);return this.set("canvas",y),this.shadow=r,n&&(this.group=n),this.set(t),this.setCoords(),v._objects=[],v.destroy(),w}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return nc(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rc(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){let{centeredRotation:t,originX:n,originY:r}=this;if(t){let{x:o,y:s}=this.getRelativeCenterPoint();this.originX=N,this.originY=N,this.left=o,this.top=s}if(this.set("angle",e),t){let{x:o,y:s}=this.getPositionByOrigin(n,r);this.left=o,this.top=s,this.originX=n,this.originY=r}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Jo.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&St().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((n,r)=>{let[o,s]=r;return n[o]=this._animate(o,s,t),n},{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.split("."),o=this.constructor.colorProperties.includes(r[r.length-1]),{abort:s,startValue:a,onChange:l,onComplete:c}=n,u=D(p({},n),{target:this,startValue:a??r.reduce((h,d)=>h[d],this),endValue:t,abort:s?.bind(this),onChange:(h,d,f)=>{r.reduce((g,v,y)=>(y===r.length-1&&(g[v]=h),g[v]),this),l&&l(h,d,f)},onComplete:(h,d,f)=>{this.setCoords(),c&&c(h,d,f)}});return o?xd(u):dc(u)}isDescendantOf(e){let{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){let e=[],t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};let t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let r,o=0;o<t.length;o++){if(r=t[o],r===e)return{fork:[this,...t.slice(0,o)],otherFork:[],common:t.slice(o)};for(let s=0;s<n.length;s++){if(this===n[s])return{fork:[],otherFork:[e,...n.slice(0,s)],common:[this,...t]};if(r===n[s])return{fork:[this,...t.slice(0,o)],otherFork:[e,...n.slice(0,s)],common:t.slice(o)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){let t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;let t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;let n=t.common[0]||this.canvas;if(!n)return;let r=t.fork.pop(),o=t.otherFork.pop(),s=n._objects.indexOf(r),a=n._objects.indexOf(o);return s>-1&&s>a}toObject(){let e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Xo.customProperties,this.constructor.customProperties||[]),t,n=H.NUM_FRACTION_DIGITS,{clipPath:r,fill:o,stroke:s,shadow:a,strokeDashArray:l,left:c,top:u,originX:h,originY:d,width:f,height:g,strokeWidth:v,strokeLineCap:y,strokeDashOffset:w,strokeLineJoin:S,strokeUniform:T,strokeMiterLimit:M,scaleX:O,scaleY:R,angle:B,flipX:I,flipY:z,opacity:le,visible:ce,backgroundColor:q,fillRule:J,paintFirst:G,globalCompositeOperation:ve,skewX:fe,skewY:be}=this;r&&!r.excludeFromExport&&(t=r.toObject(e.concat("inverted","absolutePositioned")));let ee=Et=>Q(Et,n),dt=p(D(p({},rr(this,e)),{type:this.constructor.type,version:yl,originX:h,originY:d,left:ee(c),top:ee(u),width:ee(f),height:ee(g),fill:Dh(o)?o.toObject():o,stroke:Dh(s)?s.toObject():s,strokeWidth:ee(v),strokeDashArray:l&&l.concat(),strokeLineCap:y,strokeDashOffset:w,strokeLineJoin:S,strokeUniform:T,strokeMiterLimit:ee(M),scaleX:ee(O),scaleY:ee(R),angle:ee(B),flipX:I,flipY:z,opacity:ee(le),shadow:a&&a.toObject(),visible:ce,backgroundColor:q,fillRule:J,paintFirst:G,globalCompositeOperation:ve,skewX:ee(fe),skewY:ee(be)}),t?{clipPath:t}:null);return this.includeDefaultValues?dt:this._removeDefaultValues(dt)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){let t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return sc(e,(r,o)=>{if(o===X||o===Ie||o==="type")return!0;let s=n[o];return r!==s&&!(Array.isArray(r)&&Array.isArray(s)&&r.length===0&&s.length===0)})}toString(){return`#<${this.constructor.type}>`}static _fromObject(e){let s=e,{type:t}=s,n=te(s,["type"]),a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:r}=a,o=te(a,["extraParam"]);return Ni(n,o).then(l=>r?(delete l[r],new this(n[r],l)):new this(l))}static fromObject(e,t){return this._fromObject(e,t)}};m(Lt,"stateProperties",ym),m(Lt,"cacheProperties",zt),m(Lt,"ownDefaults",_m),m(Lt,"type","FabricObject"),m(Lt,"colorProperties",[pe,ze,"backgroundColor"]),m(Lt,"customProperties",[]),k.setClass(Lt),k.setClass(Lt,"object");var fc=(i,e)=>{var t;let{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire(`object:${i}`,D(p({},e),{target:n})),n.fire(i,e)},$t=(i,e,t)=>(n,r,o,s)=>{let a=e(n,r,o,s);return a&&fc(i,p(p({},hc(n,r,o,s)),t)),a};function mn(i){return(e,t,n,r)=>{let{target:o,originX:s,originY:a}=t,l=o.getPositionByOrigin(s,a),c=i(e,t,n,r);return o.setPositionByOrigin(l,t.originX,t.originY),c}}var Sd=(i,e,t,n)=>(r,o,s,a)=>{let l=Ts(o,o.originX,o.originY,s,a)[t],c=Oe(o[e]);if(c===0||c>0&&l<0||c<0&&l>0){let{target:u}=o,h=u.strokeWidth/(u.strokeUniform?u[n]:1),d=pd(o)?2:1,f=u[i],g=Math.abs(l*d/u[n])-h;return u.set(i,Math.max(g,1)),f!==u[i]}return!1},Dd=Sd("width","originX","x","scaleX"),Md=Sd("height","originY","y","scaleY"),kl=$t(Ir,mn(Dd)),Sm=$t(Ir,mn(Md));function Ed(i,e,t,n,r){i.save();let{stroke:o,xSize:s,ySize:a,opName:l}=this.commonRenderProps(i,e,t,r,n),c=s;s>a?i.scale(1,a/s):a>s&&(c=a,i.scale(s/a,1)),i.beginPath(),i.arc(0,0,c/2,0,ct,!1),i[l](),o&&i.stroke(),i.restore()}function Td(i,e,t,n,r){i.save();let{stroke:o,xSize:s,ySize:a,opName:l}=this.commonRenderProps(i,e,t,r,n),c=s/2,u=a/2;i[`${l}Rect`](-c,-u,s,a),o&&i.strokeRect(-c,-u,s,a),i.restore()}var Te=class{constructor(e){m(this,"visible",!0),m(this,"actionName",xs),m(this,"angle",0),m(this,"x",0),m(this,"y",0),m(this,"offsetX",0),m(this,"offsetY",0),m(this,"sizeX",0),m(this,"sizeY",0),m(this,"touchSizeX",0),m(this,"touchSizeY",0),m(this,"cursorStyle","crosshair"),m(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,r){var o;let{tl:s,tr:a,br:l,bl:c}=r;return((o=t.canvas)===null||o===void 0?void 0:o.getActiveObject())===t&&t.isControlVisible(e)&&Jn.isPointInPolygon(n,[s,a,l,c])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n,r){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,r;return(n=(r=e._controlsVisibility)===null||r===void 0?void 0:r[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,r){return new _(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,r,o,s){let a=Ss([Hr(n,r),nr({angle:e}),Ds((o?this.touchSizeX:this.sizeX)||t,(o?this.touchSizeY:this.sizeY)||t)]);return{tl:new _(-.5,-.5).transform(a),tr:new _(.5,-.5).transform(a),br:new _(.5,.5).transform(a),bl:new _(-.5,.5).transform(a)}}commonRenderProps(e,t,n,r){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},{cornerSize:s,cornerColor:a,transparentCorners:l,cornerStrokeColor:c}=o,u=s||r.cornerSize,h=this.sizeX||u,d=this.sizeY||u,f=l!==void 0?l:r.transparentCorners,g=f?ze:pe,v=c||r.cornerStrokeColor,y=!f&&!!v;return e.fillStyle=a||r.cornerColor||"",e.strokeStyle=v||"",e.translate(t,n),e.rotate(oe(r.getTotalAngle())),{stroke:y,xSize:h,ySize:d,transparentCorners:f,opName:g}}render(e,t,n,r,o){((r=r||{}).cornerStyle||o.cornerStyle)==="circle"?Ed.call(this,e,t,n,r,o):Td.call(this,e,t,n,r,o)}},Od=(i,e,t)=>t.lockRotation?is:e.cursorStyle,Ad=$t(Kh,mn((i,e,t,n)=>{let{target:r,ex:o,ey:s,theta:a,originX:l,originY:c}=e,u=r.getPositionByOrigin(l,c);if(lt(r,"lockRotation"))return!1;let h=Math.atan2(s-u.y,o-u.x),d=Math.atan2(n-u.y,t-u.x),f=Bt(d-h+a);if(r.snapAngle&&r.snapAngle>0){let v=r.snapAngle,y=r.snapThreshold||v,w=Math.ceil(f/v)*v,S=Math.floor(f/v)*v;Math.abs(f-S)<y?f=S:Math.abs(f-w)<y&&(f=w)}f<0&&(f=360+f),f%=360;let g=r.angle!==f;return r.angle=f,g}));function kd(i,e){let t=e.canvas,n=i[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function Fd(i,e,t){let n=lt(i,"lockScalingX"),r=lt(i,"lockScalingY");if(n&&r||!e&&(n||r)&&t||n&&e==="x"||r&&e==="y")return!0;let{width:o,height:s,strokeWidth:a}=i;return o===0&&a===0&&e!=="y"||s===0&&a===0&&e!=="x"}var Dm=["e","se","s","sw","w","nw","n","ne","e"],Or=(i,e,t,n)=>{let r=kd(i,t);if(Fd(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",r))return is;let o=md(t,0,n);return`${Dm[o]}-resize`};function gc(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},o=e.target,s=r.by,a=kd(i,o),l,c,u,h,d,f;if(Fd(o,s,a))return!1;if(e.gestureScale)c=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(l=Ts(e,e.originX,e.originY,t,n),d=s!=="y"?Math.sign(l.x||e.signX||1):1,f=s!=="x"?Math.sign(l.y||e.signY||1):1,e.signX||(e.signX=d),e.signY||(e.signY=f),lt(o,"lockScalingFlip")&&(e.signX!==d||e.signY!==f))return!1;if(h=o._getTransformedDimensions(),a&&!s){let y=Math.abs(l.x)+Math.abs(l.y),{original:w}=e,S=y/(Math.abs(h.x*w.scaleX/o.scaleX)+Math.abs(h.y*w.scaleY/o.scaleY));c=w.scaleX*S,u=w.scaleY*S}else c=Math.abs(l.x*o.scaleX/h.x),u=Math.abs(l.y*o.scaleY/h.y);pd(e)&&(c*=2,u*=2),e.signX!==d&&s!=="y"&&(e.originX=Oh(e.originX),c*=-1,e.signX=d),e.signY!==f&&s!=="x"&&(e.originY=Oh(e.originY),u*=-1,e.signY=f)}let g=o.scaleX,v=o.scaleY;return s?(s==="x"&&o.set(Fe,c),s==="y"&&o.set($e,u)):(!lt(o,"lockScalingX")&&o.set(Fe,c),!lt(o,"lockScalingY")&&o.set($e,u)),g!==o.scaleX||v!==o.scaleY}var xi=$t(ws,mn((i,e,t,n)=>gc(i,e,t,n))),Pd=$t(ws,mn((i,e,t,n)=>gc(i,e,t,n,{by:"x"}))),Id=$t(ws,mn((i,e,t,n)=>gc(i,e,t,n,{by:"y"}))),hl={x:{counterAxis:"y",scale:Fe,skew:zr,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:$e,skew:$r,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},Mm=["ns","nesw","ew","nwse"],Rd=(i,e,t,n)=>{if(e.x!==0&&lt(t,"lockSkewingY")||e.y!==0&&lt(t,"lockSkewingX"))return is;let r=md(t,0,n)%4;return`${Mm[r]}-resize`};function Ld(i,e,t,n,r){let{target:o}=t,{counterAxis:s,origin:a,lockSkewing:l,skew:c,flip:u}=hl[i];if(lt(o,l))return!1;let{origin:h,flip:d}=hl[s],f=Oe(t[h])*(o[d]?-1:1),g=-Math.sign(f)*(o[u]?-1:1),v=.5*-((o[c]===0&&Ts(t,N,N,n,r)[i]>0||o[c]>0?1:-1)*g)+.5;return $t(Zh,mn((w,S,T,M)=>(function(O,R,B){let qi=R,{target:I,ex:z,ey:le,skewingSide:ce}=qi,q=te(qi,["target","ex","ey","skewingSide"]),{skew:J}=hl[O],G=B.subtract(new _(z,le)).divide(new _(I.scaleX,I.scaleY))[O],ve=I[J],fe=q[J],be=Math.tan(oe(fe)),ee=O==="y"?I._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:I._getTransformedDimensions({scaleX:1,scaleY:1}).y,dt=2*G*ce/Math.max(ee,1)+be,Et=Bt(Math.atan(dt));I.set(J,Et);let Xi=ve!==I[J];if(Xi&&O==="y"){let{skewX:qr,scaleX:Gt}=I,Ki=I._getTransformedDimensions({skewY:ve}),sr=I._getTransformedDimensions(),Wt=qr!==0?Ki.x/sr.x:1;Wt!==1&&I.set(Fe,Wt*Gt)}return Xi})(i,S,new _(T,M))))(e,D(p({},t),{[a]:v,skewingSide:g}),n,r)}var Ud=(i,e,t,n)=>Ld("x",i,e,t,n),jd=(i,e,t,n)=>Ld("y",i,e,t,n);function As(i,e){return i[e.canvas.altActionKey]}var Si=(i,e,t)=>{let n=As(i,t);return e.x===0?n?zr:$e:e.y===0?n?$r:Fe:""},Rn=(i,e,t,n)=>As(i,t)?Rd(0,e,t,n):Or(i,e,t,n),Fl=(i,e,t,n)=>As(i,e.target)?jd(i,e,t,n):Pd(i,e,t,n),Pl=(i,e,t,n)=>As(i,e.target)?Ud(i,e,t,n):Id(i,e,t,n),pc=()=>({ml:new Te({x:-.5,y:0,cursorStyleHandler:Rn,actionHandler:Fl,getActionName:Si}),mr:new Te({x:.5,y:0,cursorStyleHandler:Rn,actionHandler:Fl,getActionName:Si}),mb:new Te({x:0,y:.5,cursorStyleHandler:Rn,actionHandler:Pl,getActionName:Si}),mt:new Te({x:0,y:-.5,cursorStyleHandler:Rn,actionHandler:Pl,getActionName:Si}),tl:new Te({x:-.5,y:-.5,cursorStyleHandler:Or,actionHandler:xi}),tr:new Te({x:.5,y:-.5,cursorStyleHandler:Or,actionHandler:xi}),bl:new Te({x:-.5,y:.5,cursorStyleHandler:Or,actionHandler:xi}),br:new Te({x:.5,y:.5,cursorStyleHandler:Or,actionHandler:xi}),mtr:new Te({x:0,y:-.5,actionHandler:Ad,cursorStyleHandler:Od,offsetY:-40,withConnection:!0,actionName:ec})}),Nd=()=>({mr:new Te({x:.5,y:0,actionHandler:kl,cursorStyleHandler:Rn,actionName:Ir}),ml:new Te({x:-.5,y:0,actionHandler:kl,cursorStyleHandler:Rn,actionName:Ir})}),Bd=()=>p(p({},pc()),Nd()),ls=class i extends Lt{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),i.ownDefaults),this.setOptions(e)}static createControls(){return{controls:pc()}}_updateCacheCanvas(){let e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){let t=e._currentTransform,n=t.target,r=t.action;if(this===n&&r&&r.startsWith(xs))return!1}return super._updateCacheCanvas()}getActiveControl(){let e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;let n=Object.entries(this.oCoords);for(let r=n.length-1;r>=0;r--){let[o,s]=n[r],a=this.controls[o];if(a.shouldActivate(o,this,e,t?s.touchCorner:s.corner))return this.__corner=o,{key:o,control:a,coord:this.oCoords[o]}}}calcOCoords(){let e=this.getViewportTransform(),t=this.getCenterPoint(),n=Hr(t.x,t.y),r=nr({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),o=se(n,r),s=se(e,o),a=se(s,[1/e[0],0,0,1/e[3],0,0]),l=this.group?Rr(this.calcTransformMatrix()):void 0;l&&(l.scaleX=Math.abs(l.scaleX),l.scaleY=Math.abs(l.scaleY));let c=this._calculateCurrentDimensions(l),u={};return this.forEachControl((h,d)=>{let f=h.positionHandler(c,a,this,h);u[d]=Object.assign(f,this._calcCornerCoords(h,f))}),u}_calcCornerCoords(e,t){let n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(let t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();let t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),r=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/r[0],1/r[3]),e.rotate(oe(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=p({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=r.borderColor,this._setLineDash(e,r.borderDashArray),this.strokeBorders(e,t),r.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{hasBorders:n,hasControls:r}=this,o=p({hasBorders:n,hasControls:r},t),s=this.getViewportTransform(),a=o.hasBorders,l=o.hasControls,c=se(s,this.calcTransformMatrix()),u=Rr(c);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(oe(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,t),l&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let r;if(n&&n.forActiveSelection||this.group){let o=Ms(this.width,this.height,ji(t)),s=this.isStrokeAccountedForInDimensions()?tc:(this.strokeUniform?new _().scalarAdd(this.canvas?this.canvas.getZoom():1):new _(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);r=o.add(s).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else r=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,r,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl((r,o)=>{r.withConnection&&r.getVisibility(this,o)&&(n=!0,e.moveTo(r.x*t.x,r.y*t.y),e.lineTo(r.x*t.x+r.offsetX,r.y*t.y+r.offsetY))}),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();let n=this.getCanvasRetinaScaling(),{cornerStrokeColor:r,cornerDashArray:o,cornerColor:s}=this,a=p({cornerStrokeColor:r,cornerDashArray:o,cornerColor:s},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((l,c)=>{if(l.getVisibility(this,c)){let u=this.oCoords[c];l.render(e,u.x,u.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[n,r]=t;return this.setControlVisible(n,r)})}clearContextTop(e){if(!this.canvas)return;let t=this.canvas.contextTop;if(!t)return;let n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);let r=this.width+4,o=this.height+4;return t.clearRect(-r/2,-o/2,r,o),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}};function Vd(i,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(i.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})}),i}m(ls,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});var me=class extends ls{};Vd(me,[ss]),k.setClass(me),k.setClass(me,"object");var zd=(i,e,t,n)=>{let r=2*(n=Math.round(n))+1,{data:o}=i.getImageData(e-n,t-n,r,r);for(let s=3;s<o.length;s+=4)if(o[s]>0)return!1;return!0},cs=class{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new _(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new _(1/this.options.scaleX,1/this.options.scaleY):new _(1,1)}createSideVector(e,t){let n=Fi(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){let t=new _(e);return t.y+=t.x*Math.tan(oe(this.options.skewY)),t.x+=t.y*Math.tan(oe(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}},Em=new _,us=class i extends cs{static getOrthogonalRotationFactor(e,t){let n=t?rs(e,t):cc(e);return Math.abs(n)<gn?-1:1}constructor(e,t,n,r){super(r),m(this,"AB",void 0),m(this,"AC",void 0),m(this,"alpha",void 0),m(this,"bisector",void 0),this.A=new _(e),this.B=new _(t),this.C=new _(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=rs(this.AB,this.AC),this.bisector=Es(lc(this.AB.eq(Em)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,r=this.createSideVector(e,t),o=uc(r),s=i.getOrthogonalRotationFactor(o,this.bisector);return this.scaleUnitVector(o,n*s)}projectBevel(){let e=[];return(this.alpha%ct===0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){let e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),o=this.options.strokeUniform?ns(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return ns(r)/this.strokeProjectionMagnitude<=o&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){let n=[],r=new _(i.getOrthogonalRotationFactor(this.bisector),i.getOrthogonalRotationFactor(new _(this.bisector.y,this.bisector.x)));return[new _(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r),new _(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r)].forEach(o=>{Dl(o,e,t)&&n.push(this.A.add(o))}),n}projectRoundWithSkew(e,t){let n=[],{skewX:r,skewY:o,scaleX:s,scaleY:a,strokeUniform:l}=this.options,c=new _(Math.tan(oe(r)),Math.tan(oe(o))),u=this.strokeProjectionMagnitude,h=l?u/a/Math.sqrt(1/a**2+1/s**2*c.y**2):u/Math.sqrt(1+c.y**2),d=new _(Math.sqrt(Math.max(u**2-h**2,0)),h),f=l?u/Math.sqrt(1+c.x**2*(1/a)**2/(1/s+1/s*c.x*c.y)**2):u/Math.sqrt(1+c.x**2/(1+c.x*c.y)**2),g=new _(f,Math.sqrt(Math.max(u**2-f**2,0)));return[g,g.scalarMultiply(-1),d,d.scalarMultiply(-1)].map(v=>this.applySkew(l?v.multiply(this.strokeUniformScalar):v)).forEach(v=>{Dl(v,e,t)&&n.push(this.applySkew(this.A).add(v))}),n}projectRound(){let e=[];e.push(...this.projectBevel());let t=this.alpha%ct===0,n=this.applySkew(this.A),r=e[t?0:2].subtract(n),o=e[t?1:0].subtract(n),s=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Fr(r,s)>0,l=a?r:o,c=a?o:r;return this.isSkewed()?e.push(...this.projectRoundWithSkew(l,c)):e.push(...this.projectRoundNoSkew(l,c)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}},hs=class extends cs{constructor(e,t,n){super(n),this.A=new _(e),this.T=new _(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,r=this.createSideVector(e,t);return this.scaleUnitVector(uc(r),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){let e=[];if(!this.isSkewed()&&this.A.eq(this.T)){let t=new _(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new us(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){let e=[];if(this.A.eq(this.T)){let t=new _(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{let t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(Es(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),r=this.A.add(n);e.push(r.add(t),r.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}},$d=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2],n=[];if(i.length===0)return n;let r=i.reduce((o,s)=>(o[o.length-1].eq(s)||o.push(new _(s)),o),[new _(i[0])]);if(r.length===1)t=!0;else if(!t){let o=r[0],s=((a,l)=>{for(let c=a.length-1;c>=0;c--)if(l(a[c],c,a))return c;return-1})(r,a=>!a.eq(o));r.splice(s+1)}return r.forEach((o,s,a)=>{let l,c;s===0?(c=a[1],l=t?o:a[a.length-1]):s===a.length-1?(l=a[s-1],c=t?o:a[0]):(l=a[s-1],c=a[s+1]),t&&a.length===1?n.push(...new hs(o,o,e).project()):!t||s!==0&&s!==a.length-1?n.push(...new us(o,l,c,e).project()):n.push(...new hs(o,s===0?c:l,e).project())}),n},mc=i=>{let e={};return Object.keys(i).forEach(t=>{e[t]={},Object.keys(i[t]).forEach(n=>{e[t][n]=p({},i[t][n])})}),e},Hd=i=>i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Ci,ks=i=>{if(Ci||Ci||(Ci="Intl"in Cs()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Ci){let e=Ci.segment(i);return Array.from(e).map(t=>{let{segment:n}=t;return n})}return Tm(i)},Tm=i=>{let e=[];for(let t,n=0;n<i.length;n++)(t=Om(i,n))!==!1&&e.push(t);return e},Om=(i,e)=>{let t=i.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return i.charAt(e);if(55296<=t&&t<=56319){if(i.length<=e+1)throw"High surrogate without following low surrogate";let r=i.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return i.charAt(e)+i.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";let n=i.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1},Am=Object.freeze({__proto__:null,capitalize:function(i){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return`${i.charAt(0).toUpperCase()}${e?i.slice(1):i.slice(1).toLowerCase()}`},escapeXml:Hd,graphemeSplit:ks}),Fs=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return i.fill!==e.fill||i.stroke!==e.stroke||i.strokeWidth!==e.strokeWidth||i.fontSize!==e.fontSize||i.fontFamily!==e.fontFamily||i.fontWeight!==e.fontWeight||i.fontStyle!==e.fontStyle||i.textDecorationThickness!==e.textDecorationThickness||i.textBackgroundColor!==e.textBackgroundColor||i.deltaY!==e.deltaY||t&&(i.overline!==e.overline||i.underline!==e.underline||i.linethrough!==e.linethrough)},Gd=(i,e)=>{let t=e.split(`
`),n=[],r=-1,o={};i=mc(i);for(let s=0;s<t.length;s++){let a=ks(t[s]);if(i[s])for(let l=0;l<a.length;l++){r++;let c=i[s][l];c&&Object.keys(c).length>0&&(Fs(o,c,!0)?n.push({start:r,end:r+1,style:c}):n[n.length-1].end++),o=c||{}}else r+=a.length,o={}}return n},Wd=(i,e)=>{if(!Array.isArray(i))return mc(i);let t=e.split(Ql),n={},r=-1,o=0;for(let s=0;s<t.length;s++){let a=ks(t[s]);for(let l=0;l<a.length;l++)r++,i[o]&&i[o].start<=r&&r<i[o].end&&(n[s]=n[s]||{},n[s][l]=p({},i[o].style),r===i[o].end-1&&o++)}return n},vn=["display","transform",pe,"fill-opacity","fill-rule","opacity",ze,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Nh(i,e){let t=i.nodeName,n=i.getAttribute("class"),r=i.getAttribute("id"),o="(?![a-zA-Z\\-]+)",s;if(s=new RegExp("^"+t,"i"),e=e.replace(s,""),r&&e.length&&(s=new RegExp("#"+r+o,"i"),e=e.replace(s,"")),n&&e.length){let a=n.split(" ");for(let l=a.length;l--;)s=new RegExp("\\."+a[l]+o,"i"),e=e.replace(s,"")}return e.length===0}function km(i,e){let t=!0,n=Nh(i,e.pop());return n&&e.length&&(t=(function(r,o){let s,a=!0;for(;r.parentElement&&r.parentElement.nodeType===1&&o.length;)a&&(s=o.pop()),a=Nh(r=r.parentElement,s);return o.length===0})(i,e)),n&&t&&e.length===0}function Fm(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={};for(let n in e)km(i,n.split(" "))&&(t=p(p({},t),e[n]));return t}var Pm=i=>{var e;return(e=bm[i])!==null&&e!==void 0?e:i},Im=new RegExp(`(${at})`,"gi"),Ae=`(${at})`,Rm=String.raw`(skewX)\(${Ae}\)`,Lm=String.raw`(skewY)\(${Ae}\)`,Um=String.raw`(rotate)\(${Ae}(?: ${Ae} ${Ae})?\)`,jm=String.raw`(scale)\(${Ae}(?: ${Ae})?\)`,Nm=String.raw`(translate)\(${Ae}(?: ${Ae})?\)`,vc=`(?:${String.raw`(matrix)\(${Ae} ${Ae} ${Ae} ${Ae} ${Ae} ${Ae}\)`}|${Nm}|${Um}|${jm}|${Rm}|${Lm})`,Bm=`(?:${vc}*)`,Vm=String.raw`^\s*(?:${Bm}?)\s*$`,zm=new RegExp(Vm),$m=new RegExp(vc),Hm=new RegExp(vc,"g");function Il(i){let e=[];if(!(i=(t=>os(t.replace(Im," $1 ").replace(/,/gi," ")))(i).replace(/\s*([()])\s*/gi,"$1"))||i&&!zm.test(i))return[...ke];for(let t of i.matchAll(Hm)){let n=$m.exec(t[0]);if(!n)continue;let r=ke,o=n.filter(g=>!!g),[,s,...a]=o,[l,c,u,h,d,f]=a.map(g=>parseFloat(g));switch(s){case"translate":r=Hr(l,c);break;case ec:r=nr({angle:l},{x:c,y:u});break;case xs:r=Ds(l,c);break;case zr:r=ic(l);break;case $r:r=oc(l);break;case"matrix":r=[l,c,u,h,d,f]}e.push(r)}return Ss(e)}function Gm(i,e,t,n){let r=Array.isArray(e),o,s=e;if(i!==pe&&i!==ze||e!==Re){if(i==="strokeUniform")return e==="non-scaling-stroke";if(i==="strokeDashArray")s=e===Re?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(i==="transformMatrix")s=t&&t.transformMatrix?se(t.transformMatrix,Il(e)):Il(e);else if(i==="visible")s=e!==Re&&e!=="hidden",t&&t.visible===!1&&(s=!1);else if(i==="opacity")s=parseFloat(e),t&&t.opacity!==void 0&&(s*=t.opacity);else if(i==="textAnchor")s=e==="start"?X:e==="end"?ue:N;else if(i==="charSpacing"||i===Qn)o=Zn(e,n)/n*1e3;else if(i==="paintFirst"){let a=e.indexOf(pe),l=e.indexOf(ze);s=pe,(a>-1&&l>-1&&l<a||a===-1&&l>-1)&&(s=ze)}else{if(i==="href"||i==="xlink:href"||i==="font"||i==="id")return e;if(i==="imageSmoothing")return e==="optimizeQuality";o=r?e.map(Zn):Zn(e,n)}}else s="";return!r&&isNaN(o)?s:o}function Wm(i,e){i.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;let[n,r]=t.split(":");e[n.trim().toLowerCase()]=r.trim()})}function Ym(i){let e={},t=i.getAttribute("style");return t&&(typeof t=="string"?Wm(t,e):(function(n,r){Object.entries(n).forEach(o=>{let[s,a]=o;a!==void 0&&(r[s.toLowerCase()]=a)})})(t,e)),e}var Xm={stroke:"strokeOpacity",fill:"fillOpacity"};function Ht(i,e,t){if(!i)return{};let n,r={},o=Jl;i.parentNode&&Ih.test(i.parentNode.nodeName)&&(r=Ht(i.parentElement,e,t),r.fontSize&&(n=o=Zn(r.fontSize)));let s=p(p(p({},e.reduce((c,u)=>{let h=i.getAttribute(u);return h&&(c[u]=h),c},{})),Fm(i,t)),Ym(i));s[ll]&&i.setAttribute(ll,s[ll]),s[al]&&(n=Zn(s[al],o),s[al]=`${n}`);let a={};for(let c in s){let u=Pm(c),h=Gm(u,s[c],r,n);a[u]=h}a&&a.font&&(function(c,u){let h=c.match(vm);if(!h)return;let d=h[1],f=h[3],g=h[4],v=h[5],y=h[6];d&&(u.fontStyle=d),f&&(u.fontWeight=isNaN(parseFloat(f))?f:parseFloat(f)),g&&(u.fontSize=Zn(g)),y&&(u.fontFamily=y),v&&(u.lineHeight=v===Cl?1:v)})(a.font,a);let l=p(p({},r),a);return Ih.test(i.nodeName)?l:(function(c){let u=me.getDefaults();return Object.entries(Xm).forEach(h=>{let[d,f]=h;if(c[f]===void 0||c[d]==="")return;if(c[d]===void 0){if(!u[d])return;c[d]=u[d]}if(c[d].indexOf("url(")===0)return;let g=new Le(c[d]);c[d]=g.setAlpha(Q(g.getAlpha()*c[f],2)).toRgba()}),c})(l)}var Yd=["rx","ry"],Be=class i extends me{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,i.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){let{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){let{width:t,height:n}=this,r=-t/2,o=-n/2,s=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,n/2):0,l=s!==0||a!==0;e.beginPath(),e.moveTo(r+s,o),e.lineTo(r+t-s,o),l&&e.bezierCurveTo(r+t-nn*s,o,r+t,o+nn*a,r+t,o+a),e.lineTo(r+t,o+n-a),l&&e.bezierCurveTo(r+t,o+n-nn*a,r+t-nn*s,o+n,r+t-s,o+n),e.lineTo(r+s,o+n),l&&e.bezierCurveTo(r+nn*s,o+n,r,o+n-nn*a,r,o+n-a),e.lineTo(r,o+a),l&&e.bezierCurveTo(r,o+nn*a,r+nn*s,o,r+s,o),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Yd,...e])}_toSVG(){let{width:e,height:t,rx:n,ry:r}=this;return["<rect ","COMMON_PARTS",`x="${-e/2}" y="${-t/2}" rx="${n}" ry="${r}" width="${e}" height="${t}" />
`]}static async fromElement(e,t,n){let u=Ht(e,this.ATTRIBUTE_NAMES,n),{left:r=0,top:o=0,width:s=0,height:a=0,visible:l=!0}=u,c=te(u,["left","top","width","height","visible"]);return new this(D(p(p({},t),c),{left:r,top:o,width:s,height:a,visible:!!(l&&s&&a)}))}};m(Be,"type","Rect"),m(Be,"cacheProperties",[...zt,...Yd]),m(Be,"ownDefaults",{rx:0,ry:0}),m(Be,"ATTRIBUTE_NAMES",[...vn,"x","y","rx","ry","width","height"]),k.setClass(Be),k.setSVGClass(Be);var jt="initialization",ds="added",bc="removed",fs="imperative",Xd=(i,e)=>{let{strokeUniform:t,strokeWidth:n,width:r,height:o,group:s}=e,a=s&&s!==i?Bi(s.calcTransformMatrix(),i.calcTransformMatrix()):null,l=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),c=!e.isStrokeAccountedForInDimensions(),u=t&&c?dd(new _(n,n),void 0,i.calcTransformMatrix()):tc,h=!t&&c?n:0,d=Ms(r+h,o+h,Ss([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[l.subtract(d),l.add(d)]},Nr=class{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:r}=e;return t===jt||t===fs||!!n&&r!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==jt&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){let{type:n,target:r}=t;if(n===fs&&t.overrides)return t.overrides;if(e.length===0)return;let{left:o,top:s,width:a,height:l}=wt(e.map(h=>Xd(r,h)).reduce((h,d)=>h.concat(d),[])),c=new _(a,l),u=new _(o,s).add(c.scalarDivide(2));if(n===jt){let h=this.getInitialSize(t,{size:c,center:u});return{center:u,relativeCorrection:new _(0,0),size:h}}return{center:u.transform(r.calcOwnMatrix()),size:c}}};m(Nr,"type","strategy");var Ri=class extends Nr{shouldPerformLayout(e){return!0}};m(Ri,"type","fit-content"),k.setClass(Ri);var qd="layoutManager",tr=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Ri;m(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){let t=D(p({bubbles:!0,strategy:this.strategy},e),{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);let n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){let{target:n}=t;return[Zo,qh,Ir,Kh,ws,Zh,Ko,Jh,cm].map(r=>e.on(r,o=>this.performLayout(r===Zo?{type:"object_modified",trigger:r,e:o,target:n}:{type:"object_modifying",trigger:r,e:o,target:n})))}subscribe(e,t){this.unsubscribe(e,t);let n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){let{target:t,type:n}=e,{canvas:r}=t;if(n===jt||n===ds?this.subscribeTargets(e):n===bc&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),n===fs&&e.deep){let o=e,{strategy:s}=o,a=te(o,["strategy"]);t.forEachObject(l=>l.layoutManager&&l.layoutManager.performLayout(D(p({},a),{bubbles:!1,target:l})))}}getLayoutResult(e){let{target:t,strategy:n,type:r}=e,o=n.calcLayoutResult(e,t.getObjects());if(!o)return;let s=r===jt?new _:t.getRelativeCenterPoint(),{center:a,correction:l=new _,relativeCorrection:c=new _}=o,u=s.subtract(a).add(l).transform(r===jt?ke:Ve(t.calcOwnMatrix()),!0).add(c);return{result:o,prevCenter:s,nextCenter:a,offset:u}}commitLayout(e,t){let{target:n}=e,{result:{size:r},nextCenter:o}=t;var s,a;n.set({width:r.x,height:r.y}),this.layoutObjects(e,t),e.type===jt?n.set({left:(s=e.x)!==null&&s!==void 0?s:o.x+r.x*Oe(n.originX),top:(a=e.y)!==null&&a!==void 0?a:o.y+r.y*Oe(n.originY)}):(n.setPositionByOrigin(o,N,N),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){let{target:n}=e;n.forEachObject(r=>{r.group===n&&this.layoutObject(e,t,r)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:r}=t;n.set({left:n.left+r.x,top:n.top+r.y})}onAfterLayout(e,t){let u=e,{target:n,strategy:r,bubbles:o,prevStrategy:s}=u,a=te(u,["target","strategy","bubbles","prevStrategy"]),{canvas:l}=n;n.fire("layout:after",{context:e,result:t}),l&&l.fire("object:layout:after",{context:e,result:t,target:n});let c=n.parent;o&&c!=null&&c.layoutManager&&((a.path||(a.path=[])).push(n),c.layoutManager.performLayout(D(p({},a),{target:c}))),n.set("dirty",!0)}dispose(){let{_subscriptions:e}=this;e.forEach(t=>t.forEach(n=>n())),e.clear()}toObject(){return{type:qd,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}};k.setClass(tr,qd);var Rl=class extends tr{performLayout(){}},dn=class i extends Qh(me){static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),m(this,"_activeObjects",[]),m(this,"__objectSelectionTracker",void 0),m(this,"__objectSelectionDisposer",void 0),Object.assign(this,i.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(r=>{this.enterGroup(r,!1)}),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new tr,this.layoutManager.performLayout({type:jt,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(fn("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(fn("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,n,r)=>this.canEnterGroup(t)&&r.indexOf(t)===n)}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=this._filterObjectsBeforeEnteringGroup(t),o=super.add(...r);return this._onAfterObjectsChange(ds,r),o}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let o=this._filterObjectsBeforeEnteringGroup(n),s=super.insertAt(e,...o);return this._onAfterObjectsChange(ds,o),s}remove(){let e=super.remove(...arguments);return this._onAfterObjectsChange(bc,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){let n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach(r=>{r._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t,r=this._activeObjects;if(e)r.push(n),this._set("dirty",!0);else if(r.length>0){let o=r.indexOf(n);o>-1&&(r.splice(o,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&jr(e,se(Ve(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);let n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(jr(e,se(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);let n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){let e=me.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let o=0;o<this._objects.length;o++){var r;let s=this._objects[o];(r=this.canvas)!==null&&r!==void 0&&r.preserveObjectStacking&&s.group!==this?(e.save(),e.transform(...Ve(this.calcTransformMatrix())),s.render(e),e.restore()):s.group===this&&s.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(p({target:this,type:fs},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){let n=this.includeDefaultValues;return this._objects.filter(function(r){return!r.excludeFromExport}).map(function(r){let o=r.includeDefaultValues;r.includeDefaultValues=n;let s=r[e||"toObject"](t);return r.includeDefaultValues=o,s})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.layoutManager.toObject();return D(p(p({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{objects:this.__serializeObjects("toObject",e)})}toString(){return`#<Group: (${this.complexity()})>`}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";let t=Be.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';let r=t.join("");return e?e(r):r}_toSVG(e){let t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){let e=this.opacity!==void 0&&this.opacity!==1?`opacity: ${this.opacity};`:"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){let t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let a=e,{type:n,objects:r=[],layoutManager:o}=a,s=te(a,["type","objects","layoutManager"]);return Promise.all([Lr(r,t),Ni(s,t)]).then(l=>{let[c,u]=l,h=new this(c,D(p(p({},s),u),{layoutManager:new Rl}));if(o){let d=k.getClass(o.type),f=k.getClass(o.strategy);h.layoutManager=new d(new f)}else h.layoutManager=new tr;return h.layoutManager.subscribeTargets({type:jt,target:h,targets:h.getObjects()}),h.setCoords(),h})}};m(dn,"type","Group"),m(dn,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),k.setClass(dn);var Kd=(i,e)=>Math.min(e.width/i.width,e.height/i.height),Zd=(i,e)=>Math.max(e.width/i.width,e.height/i.height),Ll="\\s*,?\\s*",wi=`${Ll}(${at})`,qm=`${wi}${wi}${wi}${Ll}([01])${Ll}([01])${wi}${wi}`,Km={m:"l",M:"L"},Zm=(i,e,t,n,r,o,s,a,l,c,u)=>{let h=ut(i),d=ht(i),f=ut(e),g=ht(e),v=t*r*f-n*o*g+s,y=n*r*f+t*o*g+a;return["C",c+l*(-t*r*d-n*o*h),u+l*(-n*r*d+t*o*h),v+l*(t*r*g+n*o*f),y+l*(n*r*g-t*o*f),v,y]},Bh=(i,e,t,n)=>{let r=Math.atan2(e,i),o=Math.atan2(n,t);return o>=r?o-r:2*Math.PI-(r-o)};function Ul(i,e,t,n,r,o,s,a){let l;if(H.cachesBoundsOfCurve&&(l=[...arguments].join(),Di.boundsOfCurveCache[l]))return Di.boundsOfCurveCache[l];let c=Math.sqrt,u=Math.abs,h=[],d=[[0,0],[0,0]],f=6*i-12*t+6*r,g=-3*i+9*t-9*r+3*s,v=3*t-3*i;for(let M=0;M<2;++M){if(M>0&&(f=6*e-12*n+6*o,g=-3*e+9*n-9*o+3*a,v=3*n-3*e),u(g)<1e-12){if(u(f)<1e-12)continue;let z=-v/f;0<z&&z<1&&h.push(z);continue}let O=f*f-4*v*g;if(O<0)continue;let R=c(O),B=(-f+R)/(2*g);0<B&&B<1&&h.push(B);let I=(-f-R)/(2*g);0<I&&I<1&&h.push(I)}let y=h.length,w=y,S=Qd(i,e,t,n,r,o,s,a);for(;y--;){let{x:M,y:O}=S(h[y]);d[0][y]=M,d[1][y]=O}d[0][w]=i,d[1][w]=e,d[0][w+1]=s,d[1][w+1]=a;let T=[new _(Math.min(...d[0]),Math.min(...d[1])),new _(Math.max(...d[0]),Math.max(...d[1]))];return H.cachesBoundsOfCurve&&(Di.boundsOfCurveCache[l]=T),T}var Jm=(i,e,t)=>{let[n,r,o,s,a,l,c,u]=t,h=((d,f,g,v,y,w,S)=>{if(g===0||v===0)return[];let T=0,M=0,O=0,R=Math.PI,B=S*Zl,I=ht(B),z=ut(B),le=.5*(-z*d-I*f),ce=.5*(-z*f+I*d),q=g**2,J=v**2,G=ce**2,ve=le**2,fe=q*J-q*G-J*ve,be=Math.abs(g),ee=Math.abs(v);if(fe<0){let Yt=Math.sqrt(1-fe/(q*J));be*=Yt,ee*=Yt}else O=(y===w?-1:1)*Math.sqrt(fe/(q*G+J*ve));let dt=O*be*ce/ee,Et=-O*ee*le/be,Xi=z*dt-I*Et+.5*d,qi=I*dt+z*Et+.5*f,qr=Bh(1,0,(le-dt)/be,(ce-Et)/ee),Gt=Bh((le-dt)/be,(ce-Et)/ee,(-le-dt)/be,(-ce-Et)/ee);w===0&&Gt>0?Gt-=2*R:w===1&&Gt<0&&(Gt+=2*R);let Ki=Math.ceil(Math.abs(Gt/R*2)),sr=[],Wt=Gt/Ki,qf=8/3*Math.sin(Wt/4)*Math.sin(Wt/4)/Math.sin(Wt/2),Ks=qr+Wt;for(let Yt=0;Yt<Ki;Yt++)sr[Yt]=Zm(qr,Ks,z,I,be,ee,Xi,qi,qf,T,M),T=sr[Yt][5],M=sr[Yt][6],qr=Ks,Ks+=Wt;return sr})(c-i,u-e,r,o,a,l,s);for(let d=0,f=h.length;d<f;d++)h[d][1]+=i,h[d][2]+=e,h[d][3]+=i,h[d][4]+=e,h[d][5]+=i,h[d][6]+=e;return h},Jd=i=>{let e=0,t=0,n=0,r=0,o=[],s,a=0,l=0;for(let c of i){let u=[...c],h;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],h=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],h=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],h=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],n=u[1],r=u[2],h=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":a=u[3],l=u[4],e=u[5],t=u[6],h=["C",u[1],u[2],a,l,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":s==="C"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[3],t=u[4],h=["C",a,l,u[1],u[2],e,t],a=h[3],l=h[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":a=u[1],l=u[2],e=u[3],t=u[4],h=["Q",a,l,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":s==="Q"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[1],t=u[2],h=["Q",a,l,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":Jm(e,t,u).forEach(d=>o.push(d)),e=u[6],t=u[7];break;case"z":case"Z":e=n,t=r,h=["Z"]}h?(o.push(h),s=h[0]):s=""}return o},gs=(i,e,t,n)=>Math.sqrt((t-i)**2+(n-e)**2),Qd=(i,e,t,n,r,o,s,a)=>l=>{let c=l**3,u=(f=>3*f**2*(1-f))(l),h=(f=>3*f*(1-f)**2)(l),d=(f=>(1-f)**3)(l);return new _(s*c+r*u+t*h+i*d,a*c+o*u+n*h+e*d)},ef=i=>i**2,tf=i=>2*i*(1-i),nf=i=>(1-i)**2,Qm=(i,e,t,n,r,o,s,a)=>l=>{let c=ef(l),u=tf(l),h=nf(l),d=3*(h*(t-i)+u*(r-t)+c*(s-r)),f=3*(h*(n-e)+u*(o-n)+c*(a-o));return Math.atan2(f,d)},e0=(i,e,t,n,r,o)=>s=>{let a=ef(s),l=tf(s),c=nf(s);return new _(r*a+t*l+i*c,o*a+n*l+e*c)},t0=(i,e,t,n,r,o)=>s=>{let a=1-s,l=2*(a*(t-i)+s*(r-t)),c=2*(a*(n-e)+s*(o-n));return Math.atan2(c,l)},Vh=(i,e,t)=>{let n=new _(e,t),r=0;for(let o=1;o<=100;o+=1){let s=i(o/100);r+=gs(n.x,n.y,s.x,s.y),n=s}return r},n0=(i,e)=>{let t,n=0,r=0,o={x:i.x,y:i.y},s=p({},o),a=.01,l=0,c=i.iterator,u=i.angleFinder;for(;r<e&&a>1e-4;)s=c(n),l=n,t=gs(o.x,o.y,s.x,s.y),t+r>e?(n-=a,a/=2):(o=s,n+=a,r+=t);return D(p({},s),{angle:u(l)})},yc=i=>{let e,t,n=0,r=0,o=0,s=0,a=0,l=[];for(let c of i){let u={x:r,y:o,command:c[0],length:0};switch(c[0]){case"M":t=u,t.x=s=r=c[1],t.y=a=o=c[2];break;case"L":t=u,t.length=gs(r,o,c[1],c[2]),r=c[1],o=c[2];break;case"C":e=Qd(r,o,c[1],c[2],c[3],c[4],c[5],c[6]),t=u,t.iterator=e,t.angleFinder=Qm(r,o,c[1],c[2],c[3],c[4],c[5],c[6]),t.length=Vh(e,r,o),r=c[5],o=c[6];break;case"Q":e=e0(r,o,c[1],c[2],c[3],c[4]),t=u,t.iterator=e,t.angleFinder=t0(r,o,c[1],c[2],c[3],c[4]),t.length=Vh(e,r,o),r=c[3],o=c[4];break;case"Z":t=u,t.destX=s,t.destY=a,t.length=gs(r,o,s,a),r=s,o=a}n+=t.length,l.push(t)}return l.push({length:n,x:r,y:o}),l},rf=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:yc(i),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;let r=t[n],o=e/r.length,s=i[n];switch(r.command){case"M":return{x:r.x,y:r.y,angle:0};case"Z":return D(p({},new _(r.x,r.y).lerp(new _(r.destX,r.destY),o)),{angle:Math.atan2(r.destY-r.y,r.destX-r.x)});case"L":return D(p({},new _(r.x,r.y).lerp(new _(s[1],s[2]),o)),{angle:Math.atan2(s[2]-r.y,s[1]-r.x)});case"C":case"Q":return n0(r,e)}},r0=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),zh=new RegExp(qm,"g"),i0=new RegExp(at,"gi"),o0={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},of=i=>{var e;let t=[],n=(e=i.match(r0))!==null&&e!==void 0?e:[];for(let r of n){let o=r[0];if(o==="z"||o==="Z"){t.push([o]);continue}let s=o0[o.toLowerCase()],a=[];if(o==="a"||o==="A"){zh.lastIndex=0;for(let l=null;l=zh.exec(r);)a.push(...l.slice(1))}else a=r.match(i0)||[];for(let l=0;l<a.length;l+=s){let c=new Array(s),u=Km[o];c[0]=l>0&&u?u:o;for(let h=0;h<s;h++)c[h+1]=parseFloat(a[l+h]);t.push(c)}}return t},sf=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new _(i[0]),n=new _(i[1]),r=1,o=0,s=[],a=i.length,l=a>2,c;for(l&&(r=i[2].x<n.x?-1:i[2].x===n.x?0:1,o=i[2].y<n.y?-1:i[2].y===n.y?0:1),s.push(["M",t.x-r*e,t.y-o*e]),c=1;c<a;c++){if(!t.eq(n)){let u=t.midPointFrom(n);s.push(["Q",t.x,t.y,u.x,u.y])}t=i[c],c+1<i.length&&(n=i[c+1])}return l&&(r=t.x>i[c-2].x?1:t.x===i[c-2].x?0:-1,o=t.y>i[c-2].y?1:t.y===i[c-2].y?0:-1),s.push(["L",t.x+r*e,t.y+o*e]),s},_c=(i,e)=>i.map(t=>t.map((n,r)=>r===0||e===void 0?n:Q(n,e)).join(" ")).join(" "),s0=(i,e)=>Math.floor(Math.random()*(e-i+1))+i,a0=(i,e)=>{let t=i._findCenterFromElement();i.transformMatrix&&((n=>{if(n.transformMatrix){let{scaleX:r,scaleY:o,angle:s,skewX:a}=Rr(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set(Fe,r),n.set($e,o),n.angle=s,n.skewX=a,n.skewY=0}})(i),t=t.transform(i.transformMatrix)),delete i.transformMatrix,e&&(i.scaleX*=e.scaleX,i.scaleY*=e.scaleY,i.cropX=e.cropX,i.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,i.width=e.width,i.height=e.height),i.setPositionByOrigin(t,N,N)},Ps=Object.freeze({__proto__:null,addTransformToObject:ud,animate:dc,animateColor:xd,applyTransformToObject:jr,calcAngleBetweenVectors:rs,calcDimensionsMatrix:ji,calcPlaneChangeMatrix:Bi,calcVectorRotation:cc,cancelAnimFrame:ed,capValue:er,composeMatrix:od,copyCanvasElement:i=>{var e;let t=He(i);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(i,0,0),t},cos:ut,createCanvasElement:Dt,createImage:td,createRotateMatrix:nr,createScaleMatrix:Ds,createSkewXMatrix:ic,createSkewYMatrix:oc,createTranslateMatrix:Hr,createVector:Fi,crossProduct:Fr,degreesToRadians:oe,dotProduct:gd,ease:Cm,enlivenObjectEnlivables:Ni,enlivenObjects:Lr,findScaleToCover:Zd,findScaleToFit:Kd,getBoundsOfCurve:Ul,getOrthonormalVector:uc,getPathSegmentsInfo:yc,getPointOnPath:rf,getPointer:cd,getRandomInt:s0,getRegularPolygonPath:(i,e)=>{let t=2*Math.PI/i,n=-gn;i%2==0&&(n+=t/2);let r=new Array(i+1);for(let o=0;o<i;o++){let s=o*t+n,{x:a,y:l}=new _(ut(s),ht(s)).scalarMultiply(e);r[o]=[o===0?"M":"L",a,l]}return r[i]=["Z"],r},getSmoothPathFromPoints:sf,getSvgAttributes:i=>{let e=["instantiated_by_use","style","id","class"];switch(i){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:Es,groupSVGElements:(i,e)=>i&&i.length===1?i[0]:new dn(i,e),hasStyleChanged:Fs,invertTransform:Ve,isBetweenVectors:Dl,isIdentityMatrix:nd,isTouchEvent:ts,isTransparent:zd,joinPath:_c,loadImage:Ei,magnitude:ns,makeBoundingBoxFromPoints:wt,makePathSimpler:Jd,matrixToSVG:Ur,mergeClipPaths:(i,e)=>{var t;let n=i,r=e;n.inverted&&!r.inverted&&(n=e,r=i),Sl(r,(t=r.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());let o=n.inverted&&r.inverted;return o&&(n.inverted=r.inverted=!1),new dn([n],{clipPath:r,inverted:o})},multiplyTransformMatrices:se,multiplyTransformMatrixArray:Ss,parsePath:of,parsePreserveAspectRatioAttribute:vd,parseUnit:Zn,pick:rr,projectStrokeOnPoints:$d,qrDecompose:Rr,radiansToDegrees:Bt,removeFromArray:Fn,removeTransformFromObject:(i,e)=>{let t=Ve(e),n=se(t,i.calcOwnMatrix());jr(i,n)},removeTransformMatrixForSvgParsing:a0,requestAnimFrame:Mi,resetObjectTransform:hd,rotateVector:lc,saveObjectTransform:ac,sendObjectToPlane:Sl,sendPointToPlane:Vt,sendVectorToPlane:dd,sin:ht,sizeAfterTransform:Ms,string:Am,stylesFromArray:Wd,stylesToArray:Gd,toBlob:rc,toDataURL:nc,toFixed:Q,transformPath:(i,e,t)=>(t&&(e=se(e,[1,0,0,1,-t.x,-t.y])),i.map(n=>{let r=[...n];for(let o=1;o<n.length-1;o+=2){let{x:s,y:a}=Se({x:n[o],y:n[o+1]},e);r[o]=s,r[o+1]=a}return r})),transformPoint:Se});function jl(i,e){let t=i.style;t&&Object.entries(e).forEach(n=>{let[r,o]=n;return t.setProperty(r,o)})}var Nl=class extends es{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),m(this,"upper",void 0),m(this,"container",void 0);let{el:r}=this.lower,o=this.createUpperCanvas();this.upper={el:o,ctx:o.getContext("2d")},this.applyCanvasStyle(r,{allowTouchScrolling:t}),this.applyCanvasStyle(o,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});let s=this.createContainerElement();s.classList.add(n),r.parentNode&&r.parentNode.replaceChild(s,r),s.append(r,o),this.container=s}createUpperCanvas(){let{el:e}=this.lower,t=Dt();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){let e=Vr().createElement("div");return e.setAttribute("data-fabric","wrapper"),jl(e,{position:"relative"}),Eh(e),e}applyCanvasStyle(e,t){let{styles:n,allowTouchScrolling:r}=t;jl(e,D(p({},n),{"touch-action":r?"manipulation":Re})),Eh(e)}setDimensions(e,t){super.setDimensions(e,t);let{el:n,ctx:r}=this.upper;ld(n,r,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),xl(this.upper.el,e),xl(this.container,e)}cleanupDOM(e){let t=this.container,{el:n}=this.lower,{el:r}=this.upper;super.cleanupDOM(e),t.removeChild(r),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),St().dispose(this.upper.el),delete this.upper,delete this.container}},af=(i,e,t,n)=>{let{target:r,offsetX:o,offsetY:s}=e,a=t-o,l=n-s,c=!lt(r,"lockMovementX")&&r.left!==a,u=!lt(r,"lockMovementY")&&r.top!==l;return c&&r.set(X,a),u&&r.set(Ie,l),(c||u)&&fc(qh,hc(i,e,t,n)),c||u},lf=Jh,$h=i=>function(e,t,n){let{points:r,pathOffset:o}=n;return new _(r[i]).subtract(o).transform(se(n.getViewportTransform(),n.calcTransformMatrix()))},cf=(i,e,t,n)=>{let{target:r,pointIndex:o}=e,s=r,a=Vt(new _(t,n),void 0,s.calcOwnMatrix());return s.points[o]=a.add(s.pathOffset),s.setDimensions(),s.set("dirty",!0),!0},uf=(i,e)=>function(t,n,r,o){let s=n.target,a=new _(s.points[(i>0?i:s.points.length)-1]),l=a.subtract(s.pathOffset).transform(s.calcOwnMatrix()),c=e(t,D(p({},n),{pointIndex:i}),r,o),u=a.subtract(s.pathOffset).transform(s.calcOwnMatrix()).subtract(l);return s.left-=u.x,s.top-=u.y,c},Hh=i=>$t(lf,uf(i,cf)),Bl=(i,e,t)=>{let{path:n,pathOffset:r}=i,o=n[e];return new _(o[t]-r.x,o[t+1]-r.y).transform(se(i.getViewportTransform(),i.calcTransformMatrix()))};function l0(i,e,t){let{commandIndex:n,pointIndex:r}=this;return Bl(t,n,r)}function c0(i,e,t,n){let{target:r}=e,{commandIndex:o,pointIndex:s}=this,a=((l,c,u,h,d)=>{let{path:f,pathOffset:g}=l,v=f[(h>0?h:f.length)-1],y=new _(v[d],v[d+1]),w=y.subtract(g).transform(l.calcOwnMatrix()),S=Vt(new _(c,u),void 0,l.calcOwnMatrix());f[h][d]=S.x+g.x,f[h][d+1]=S.y+g.y,l.setDimensions();let T=y.subtract(l.pathOffset).transform(l.calcOwnMatrix()).subtract(w);return l.left-=T.x,l.top-=T.y,l.set("dirty",!0),!0})(r,t,n,o,s);return fc(this.actionName,D(p({},hc(i,e,t,n)),{commandIndex:o,pointIndex:s})),a}var ps=class extends Te{constructor(e){super(e)}render(e,t,n,r,o){let s=D(p({},r),{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,t,n,s,o)}},Vl=class extends ps{constructor(e){super(e)}render(e,t,n,r,o){let{path:s}=o,{commandIndex:a,pointIndex:l,connectToCommandIndex:c,connectToPointIndex:u}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);let[h]=s[a],d=Bl(o,c,u);if(h==="Q"){let f=Bl(o,a,l+2);e.moveTo(f.x,f.y),e.lineTo(t,n)}else e.moveTo(t,n);e.lineTo(d.x,d.y),e.stroke(),e.restore(),super.render(e,t,n,r,o)}},Bo=(i,e,t,n,r,o)=>new(t?Vl:ps)(p(p({commandIndex:i,pointIndex:e,actionName:"modifyPath",positionHandler:l0,actionHandler:c0,connectToCommandIndex:r,connectToPointIndex:o},n),t?n.controlPointStyle:n.pointStyle)),MC=Object.freeze({__proto__:null,changeHeight:Sm,changeObjectHeight:Md,changeObjectWidth:Dd,changeWidth:kl,createObjectDefaultControls:pc,createPathControls:function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={},n="M";return i.path.forEach((r,o)=>{let s=r[0];switch(s!=="Z"&&(t[`c_${o}_${s}`]=Bo(o,r.length-2,!1,e)),s){case"C":t[`c_${o}_C_CP_1`]=Bo(o,1,!0,e,o-1,(a=>a==="C"?5:a==="Q"?3:1)(n)),t[`c_${o}_C_CP_2`]=Bo(o,3,!0,e,o,5);break;case"Q":t[`c_${o}_Q_CP_1`]=Bo(o,1,!0,e,o,3)}n=s}),t},createPolyActionHandler:Hh,createPolyControls:function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={};for(let n=0;n<(typeof i=="number"?i:i.points.length);n++)t[`p${n}`]=new Te(p({actionName:lf,positionHandler:$h(n),actionHandler:Hh(n)},e));return t},createPolyPositionHandler:$h,createResizeControls:Nd,createTextboxDefaultControls:Bd,dragHandler:af,factoryPolyActionHandler:uf,getLocalPoint:Ts,polyActionHandler:cf,renderCircleControl:Ed,renderSquareControl:Td,rotationStyleHandler:Od,rotationWithSnapping:Ad,scaleCursorStyleHandler:Or,scaleOrSkewActionName:Si,scaleSkewCursorStyleHandler:Rn,scalingEqually:xi,scalingX:Pd,scalingXOrSkewingY:Fl,scalingY:Id,scalingYOrSkewingX:Pl,skewCursorStyleHandler:Rd,skewHandlerX:Ud,skewHandlerY:jd,wrapWithFireEvent:$t,wrapWithFixedAnchor:mn}),ms=class i extends ki{constructor(){super(...arguments),m(this,"_hoveredTargets",[]),m(this,"_currentTransform",null),m(this,"_groupSelector",null),m(this,"contextTopDirty",!1)}static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new Nl(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){let e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){let e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;let t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){let r=this.targetFindTolerance,o=this.pixelFindContext;this.clearContext(o),o.save(),o.translate(-t+r,-n+r),o.transform(...this.viewportTransform);let s=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(o),e.selectionBackgroundColor=s,o.restore();let a=Math.round(r*this.getRetinaScaling());return zd(o,a,a,a)}_isSelectionKeyPressed(e){let t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(n=>!!n&&e[n]===!0):e[t])}_shouldClearSelection(e,t){let n=this.getActiveObjects(),r=this._activeObject;return!!(!t||t&&r&&n.length>1&&n.indexOf(t)===-1&&r!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&r&&r!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let r;return t===xs||t===Fe||t===$e||t===Ir?r=this.centeredScaling||e.centeredScaling:t===ec&&(r=this.centeredRotation||e.centeredRotation),r?!n:n}_getOriginFromCorner(e,t){let n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=ue:["mr","tr","br"].includes(t)&&(n.x=X),["tl","mt","tr"].includes(t)?n.y=_l:["bl","mb","br"].includes(t)&&(n.y=Ie)),n}_setupCurrentTransform(e,t,n){var r;let o=t.group?Vt(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:s="",control:a}=t.getActiveControl()||{},l=n&&a?(r=a.getActionHandler(e,t,a))===null||r===void 0?void 0:r.bind(a):af,c=((I,z,le,ce)=>{if(!z||!I)return"drag";let q=ce.controls[z];return q.getActionName(le,q,ce)})(n,s,e,t),u=e[this.centeredKey],h=this._shouldCenterTransform(t,c,u)?{x:N,y:N}:this._getOriginFromCorner(t,s),{scaleX:d,scaleY:f,skewX:g,skewY:v,left:y,top:w,angle:S,width:T,height:M,cropX:O,cropY:R}=t,B={target:t,action:c,actionHandler:l,actionPerformed:!1,corner:s,scaleX:d,scaleY:f,skewX:g,skewY:v,offsetX:o.x-y,offsetY:o.y-w,originX:h.x,originY:h.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:oe(S),width:T,height:M,shiftKey:e.shiftKey,altKey:u,original:D(p({},ac(t)),{originX:h.x,originY:h.y,cropX:O,cropY:R})};this._currentTransform=B,this.fire("before:transform",{e,transform:B})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){let{x:t,y:n,deltaX:r,deltaY:o}=this._groupSelector,s=new _(t,n).transform(this.viewportTransform),a=new _(t+r,n+o).transform(this.viewportTransform),l=this.selectionLineWidth/2,c=Math.min(s.x,a.x),u=Math.min(s.y,a.y),h=Math.max(s.x,a.x),d=Math.max(s.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(c,u,h-c,d-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,c+=l,u+=l,h-=l,d-=l,me.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(c,u,h-c,d-u))}findTarget(e){if(this._targetInfo)return this._targetInfo;if(this.skipTargetFind)return{subTargets:[],currentSubTargets:[]};let t=this.getScenePoint(e),n=this._activeObject,r=this.getActiveObjects(),o=this.searchPossibleTargets(this._objects,t),{subTargets:s,container:a,target:l}=o,c=D(p({},o),{currentSubTargets:s,currentContainer:a,currentTarget:l});if(!n)return c;let u=D(p({},this.searchPossibleTargets([n],t)),{currentSubTargets:s,currentContainer:a,currentTarget:l});return n.findControl(this.getViewportPoint(e),ts(e))?D(p({},u),{target:n}):u.target&&(r.length>1||!this.preserveObjectStacking||this.preserveObjectStacking&&e[this.altSelectionKey])?u:c}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords(),r=this.getZoom(),o=e.padding/r;if(o){let[s,a,l,c]=n,u=Math.atan2(a.y-s.y,a.x-s.x),h=ut(u)*o,d=ht(u)*o,f=h+d,g=h-d;n=[new _(s.x-g,s.y-f),new _(a.x+f,a.y-g),new _(l.x+g,l.y+f),new _(c.x-f,c.y+g)]}return Jn.isPointInPolygon(t,n)}_checkTarget(e,t){if(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;{let n=t.transform(this.viewportTransform);if(!this.isTargetTransparent(e,n.x,n.y))return!0}}return!1}_searchPossibleTargets(e,t,n){let r=e.length;for(;r--;){let o=e[r];if(this._checkTarget(o,t)){if(Yo(o)&&o.subTargetCheck){let{target:s}=this._searchPossibleTargets(o._objects,t,n);s&&n.push(s)}return{target:o,subTargets:n}}}return{subTargets:[]}}searchPossibleTargets(e,t){let n=this._searchPossibleTargets(e,t,[]);n.container=n.target;let{container:r,subTargets:o}=n;if(r&&Yo(r)&&r.interactive&&o[0]){for(let s=o.length-1;s>0;s--){let a=o[s];if(!Yo(a)||!a.interactive)return n.target=a,n}return n.target=o[0],n}return n}getViewportPoint(e){return this._viewportPoint?this._viewportPoint:this._getPointerImpl(e,!0)}getScenePoint(e){return this._scenePoint?this._scenePoint:this._getPointerImpl(e)}_getPointerImpl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],n=this.upperCanvasEl,r=n.getBoundingClientRect(),o=cd(e),s=r.width||0,a=r.height||0;s&&a||(Ie in r&&_l in r&&(a=Math.abs(r.top-r.bottom)),ue in r&&X in r&&(s=Math.abs(r.right-r.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,t||(o=Vt(o,void 0,this.viewportTransform));let l=this.getRetinaScaling();l!==1&&(o.x/=l,o.y/=l);let c=s===0||a===0?new _(1,1):new _(n.width/s,n.height/a);return o.multiply(c)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Dt(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){let e=this._activeObject;return Pn(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,r=!1,o=this.getActiveObjects(),s=[],a=[];e.forEach(l=>{o.includes(l)||(n=!0,l.fire("deselected",{e:t,target:l}),a.push(l))}),o.forEach(l=>{e.includes(l)||(n=!0,l.fire("selected",{e:t,target:l}),s.push(l))}),e.length>0&&o.length>0?(r=!0,n&&this.fire("selection:updated",{e:t,selected:s,deselected:a})):o.length>0?(r=!0,this.fire("selection:created",{e:t,selected:s})):e.length>0&&(r=!0,this.fire("selection:cleared",{e:t,deselected:a})),r&&(this._objectsToRender=void 0)}setActiveObject(e,t){let n=this.getActiveObjects(),r=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),r}_setActiveObject(e,t){let n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Pn(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){let n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),Pn(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){let t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});let r=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),r}endCurrentTransform(e){let t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){let t=this._currentTransform,n=t.target,r={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",r),n.fire(Zo,r))}setViewportTransform(e){super.setViewportTransform(e);let t=this._activeObject;t&&t.setCoords()}destroy(){let e=this._activeObject;Pn(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){let t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){let r=this._realizeGroupTransformOnObject(e),o=super._toObject(e,t,n);return e.set(r),o}_realizeGroupTransformOnObject(e){let{group:t}=e;if(t&&Pn(t)&&this._activeObject===t){let n=rr(e,["angle","flipX","flipY",X,Fe,$e,zr,$r,Ie]);return ud(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){let r=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(r)}};m(ms,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!0,fireRightClick:!0,fireMiddleClick:!0,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!0});var zl=class{constructor(e){m(this,"targets",[]),m(this,"__disposer",void 0);let t=()=>{let{hiddenTextarea:r}=e.getActiveObject()||{};r&&r.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Fn(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}},Ne={passive:!1},An=(i,e)=>({viewportPoint:i.getViewportPoint(e),scenePoint:i.getScenePoint(e)}),rn=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return i.addEventListener(...t)},Ze=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return i.removeEventListener(...t)},u0={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}},Br=class extends ms{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),m(this,"_isClick",void 0),m(this,"textEditingManager",new zl(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(rn)}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],n=this.upperCanvasEl,r=this._getEventPrefix();e(ad(n),"resize",this._onResize),e(n,r+"down",this._onMouseDown),e(n,`${r}move`,this._onMouseMove,Ne),e(n,`${r}out`,this._onMouseOut),e(n,`${r}enter`,this._onMouseEnter),e(n,"wheel",this._onMouseWheel,{passive:!1}),e(n,"contextmenu",this._onContextMenu),t||(e(n,"click",this._onClick),e(n,"dblclick",this._onClick)),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,Ne)}removeListeners(){this.addOrRemove(Ze);let e=this._getEventPrefix(),t=st(this.upperCanvasEl);Ze(t,`${e}up`,this._onMouseUp),Ze(t,"touchend",this._onTouchEnd,Ne),Ze(t,`${e}move`,this._onMouseMove,Ne),Ze(t,"touchmove",this._onMouseMove,Ne),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_onMouseOut(e){let t=this._hoveredTarget,n=p({e},An(this,e));this.fire("mouse:out",D(p({},n),{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",p({},n)),this._hoveredTargets.forEach(r=>{this.fire("mouse:out",D(p({},n),{target:r})),r&&r.fire("mouseout",p({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){let{target:t}=this.findTarget(e);this._currentTransform||t||(this.fire("mouse:over",p({e},An(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;let t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;let n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void rn(this.upperCanvasEl,"drag",this._onDragProgress)}Th(e)}_renderDragEffects(e,t,n){let r=!1,o=this._dropTarget;o&&o!==t&&o!==n&&(o.clearContextTop(),r=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();let s=this.contextTop;s.save(),s.transform(...this.viewportTransform),t&&(s.save(),t.transform(s),t.renderDragSourceEffect(e),s.restore(),r=!0),n&&(s.save(),n.transform(s),n.renderDropTargetEffect(e),s.restore(),r=!0),s.restore(),r&&(this.contextTopDirty=!0)}_onDragEnd(e){let{currentSubTargets:t}=this.findTarget(e),n=!!e.dataTransfer&&e.dataTransfer.dropEffect!==Re,r=n?this._activeObject:void 0,o={e,target:this._dragSource,subTargets:t,dragSource:this._dragSource,didDrop:n,dropTarget:r};Ze(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",o),this._dragSource&&this._dragSource.fire("dragend",o),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){let t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}_onDragOver(e){let t="dragover",{currentContainer:n,currentSubTargets:r}=this.findTarget(e),o=this._dragSource,s={e,target:n,subTargets:r,dragSource:o,canDrop:!1,dropTarget:void 0},a;this.fire(t,s),this._fireEnterLeaveEvents(e,n,s),n&&(n.canDrop(e)&&(a=n),n.fire(t,s));for(let l=0;l<r.length;l++){let c=r[l];c.canDrop(e)&&(a=c),c.fire(t,s)}this._renderDragEffects(e,o,a),this._dropTarget=a}_onDragEnter(e){let{currentContainer:t,currentSubTargets:n}=this.findTarget(e),r={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",r),this._fireEnterLeaveEvents(e,t,r)}_onDragLeave(e){let{currentSubTargets:t}=this.findTarget(e),n={e,target:this._draggedoverTarget,subTargets:t,dragSource:this._dragSource};this.fire("dragleave",n),this._fireEnterLeaveEvents(e,void 0,n),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this._hoveredTargets=[]}_onDrop(e){let{currentContainer:t,currentSubTargets:n}=this.findTarget(e),r=this._basicEventHandler("drop:before",p({e,target:t,subTargets:n,dragSource:this._dragSource},An(this,e)));r.didDrop=!1,r.dropTarget=void 0,this._basicEventHandler("drop",r),this.fire("drop:after",r)}_onContextMenu(e){let{target:t,subTargets:n}=this.findTarget(e),r=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&Th(e),this._basicEventHandler("contextmenu",r),!1}_onClick(e){let t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}fireEventFromPointerEvent(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._cacheTransformEventData(e);let{target:o,subTargets:s}=this.findTarget(e),a=p(D(p({e,target:o,subTargets:s},An(this,e)),{transform:this._currentTransform}),r);this.fire(t,a),o&&o.fire(n,a);for(let l=0;l<s.length;l++)s[l]!==o&&s[l].fire(n,a);this._resetTransformEventData()}getPointerId(e){let t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){this._cacheTransformEventData(e);let t=!this.allowTouchScrolling,n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e);let{target:r}=this.findTarget(e);(this.isDrawingMode||n&&r===n)&&(t=!0),t&&e.preventDefault();let o=this.upperCanvasEl,s=this._getEventPrefix(),a=st(o);rn(a,"touchend",this._onTouchEnd,Ne),t&&rn(a,"touchmove",this._onMouseMove,Ne),Ze(o,`${s}down`,this._onMouseDown),this._resetTransformEventData()}_onMouseDown(e){this._cacheTransformEventData(e),this.__onMouseDown(e);let t=this.upperCanvasEl,n=this._getEventPrefix();Ze(t,`${n}move`,this._onMouseMove,Ne);let r=st(t);rn(r,`${n}up`,this._onMouseUp),rn(r,`${n}move`,this._onMouseMove,Ne),this._resetTransformEventData()}_onTouchEnd(e){if(e.touches.length>0)return;this._cacheTransformEventData(e),this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;let t=this._getEventPrefix(),n=st(this.upperCanvasEl);Ze(n,"touchend",this._onTouchEnd,Ne),Ze(n,"touchmove",this._onMouseMove,Ne),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{rn(this.upperCanvasEl,`${t}down`,this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this._cacheTransformEventData(e),this.__onMouseUp(e);let t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){let r=st(this.upperCanvasEl);Ze(r,`${n}up`,this._onMouseUp),Ze(r,`${n}move`,this._onMouseMove,Ne),rn(t,`${n}move`,this._onMouseMove,Ne)}this._resetTransformEventData()}_onMouseMove(e){this._cacheTransformEventData(e);let t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e),this._resetTransformEventData()}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){let t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._handleEvent(e,"up:before");let n=this._currentTransform,r=this._isClick,{target:o}=this.findTarget(e),{button:s}=e;if(s)return void((this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"up"));if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,l,c=!1;if(n&&(this._finalizeCurrentTransform(e),c=n.actionPerformed),!r){let u=o===this._activeObject;this.handleSelection(e),c||(c=this._shouldRender(o)||!u&&o===this._activeObject)}if(o){let u=o.findControl(this.getViewportPoint(e),ts(e)),{key:h,control:d}=u||{};if(l=h,o.selectable&&o!==this._activeObject&&o.activeOn==="up")this.setActiveObject(o,e),c=!0;else if(d){let f=d.getMouseUpHandler(e,o,d);f&&(a=this.getScenePoint(e),f.call(d,e,n,a.x,a.y))}o.isMoving=!1}if(n&&(n.target!==o||n.corner!==l)){let u=n.target&&n.target.controls[n.corner],h=u&&u.getMouseUpHandler(e,n.target,u);a=a||this.getScenePoint(e),h&&h.call(u,e,n,a.x,a.y)}this._setCursorFromEvent(e,o),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,o&&(o.__corner=void 0),c?this.requestRenderAll():r||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){let{target:n,subTargets:r=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let o=0;o<r.length;o++)r[o]!==n&&r[o].fire(e,t);return t}_handleEvent(e,t,n){let{target:r,subTargets:o}=this.findTarget(e),s=p(D(p({e,target:r,subTargets:o},An(this,e)),{transform:this._currentTransform}),t==="down:before"||t==="down"?n:{});t!=="up:before"&&t!=="up"||(s.isClick=this._isClick),this.fire(`mouse:${t}`,s),r&&r.fire(`mouse${t}`,s);for(let a=0;a<o.length;a++)o[a]!==r&&o[a].fire(`mouse${t}`,s)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){let t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._handleEvent(e,"down:before");let{target:t}=this.findTarget(e),n=!!t&&t===this._activeObject,{button:r}=e;if(r)return void((this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down",{alreadySelected:n}));if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let o=this._shouldRender(t),s=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,s=!0,o=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){let a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(n=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);let a=t.findControl(this.getViewportPoint(e),ts(e));if(t===this._activeObject&&(a||!s)){this._setupCurrentTransform(e,t,n);let l=a?a.control:void 0,c=this.getScenePoint(e),u=l&&l.getMouseDownHandler(e,t,l);u&&u.call(l,e,this._currentTransform,c.x,c.y)}}o&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:n}),o&&this.requestRenderAll()}_resetTransformEventData(){this._targetInfo=this._viewportPoint=this._scenePoint=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._viewportPoint=this.getViewportPoint(e),this._scenePoint=Vt(this._viewportPoint,void 0,this.viewportTransform),this._targetInfo=this.findTarget(e),this._currentTransform&&(this._targetInfo.target=this._currentTransform.target)}__onMouseMove(e){if(this._isClick=!1,this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;let t=this._groupSelector;if(t){let n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{let{target:n}=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move")}_fireOverOutEvents(e,t){let{_hoveredTarget:n,_hoveredTargets:r}=this,{subTargets:o}=this.findTarget(e),s=Math.max(r.length,o.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let a=0;a<s;a++)o[a]===t||r[a]&&r[a]===n||this.fireSyntheticInOutEvents("mouse",{e,target:o[a],oldTarget:r[a]});this._hoveredTarget=t,this._hoveredTargets=o}_fireEnterLeaveEvents(e,t,n){let r=this._draggedoverTarget,o=this._hoveredTargets,{subTargets:s}=this.findTarget(e),a=Math.max(o.length,s.length);this.fireSyntheticInOutEvents("drag",D(p({},n),{target:t,oldTarget:r,fireCanvas:!0}));for(let l=0;l<a;l++)this.fireSyntheticInOutEvents("drag",D(p({},n),{target:s[l],oldTarget:o[l]}));this._draggedoverTarget=t}fireSyntheticInOutEvents(e,t){let f=t,{target:n,oldTarget:r,fireCanvas:o,e:s}=f,a=te(f,["target","oldTarget","fireCanvas","e"]),{targetIn:l,targetOut:c,canvasIn:u,canvasOut:h}=u0[e],d=r!==n;if(r&&d){let g=p(D(p({},a),{e:s,target:r,nextTarget:n}),An(this,s));o&&this.fire(h,g),r.fire(c,g)}if(n&&d){let g=p(D(p({},a),{e:s,target:n,previousTarget:r}),An(this,s));o&&this.fire(u,g),n.fire(l,g)}}_transformObject(e){let t=this.getScenePoint(e),n=this._currentTransform,r=n.target,o=r.group?Vt(t,void 0,r.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,o),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){let{action:r,actionHandler:o,target:s}=t,a=!!o&&o(e,t,n.x,n.y);a&&s.setCoords(),r==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor,r=Pn(this._activeObject)?this._activeObject:null,o=(!r||t.group!==r)&&t.findControl(this.getViewportPoint(e));if(o){let{control:s,coord:a}=o;this.setCursor(s.cursorStyleHandler(e,s,t,a))}else{if(t.subTargetCheck){let{subTargets:s}=this.findTarget(e);s.concat().reverse().forEach(a=>{n=a.hoverCursor||n})}this.setCursor(n)}}handleMultiSelection(e,t){let n=this._activeObject,r=Pn(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||r)&&(r||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(r){let o=n.getObjects(),s=[];if(t===n){let a=this.getScenePoint(e),l=this.searchPossibleTargets(o,a);if(l.target?(t=l.target,s=l.subTargets):(l=this.searchPossibleTargets(this._objects,a),t=l.target,s=l.subTargets),!t||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=s,n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=s),this._fireSelectionEvents(o,e)}else{n.isEditing&&n.exitEditing();let o=new(k.getClass("ActiveSelection"))([],{canvas:this});o.multiSelectAdd(n,t),this._hoveredTarget=o,this._setActiveObject(o,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;let{x:t,y:n,deltaX:r,deltaY:o}=this._groupSelector,s=new _(t,n),a=s.add(new _(r,o)),l=s.min(a),c=s.max(a).subtract(l),u=this.collectObjects({left:l.x,top:l.y,width:c.x,height:c.y},{includeIntersecting:!this.selectionFullyContained}),h=s.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter(d=>!d.onSelect({e})).reverse():u;if(h.length===1)this.setActiveObject(h[0],e);else if(h.length>1){let d=k.getClass("ActiveSelection");this.setActiveObject(new d(h,{canvas:this}),e)}return this._groupSelector=null,!0}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,{upper:n}=this.elements;n.ctx=void 0;let r=super.toCanvasElement(e,t);return n.ctx=n.el.getContext("2d"),r}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}},hf={x1:0,y1:0,x2:0,y2:0},h0=D(p({},hf),{r1:0,r2:0}),Ar=(i,e)=>isNaN(i)&&typeof e=="number"?e:i;function df(i){return i&&/%$/.test(i)&&Number.isFinite(parseFloat(i))}function ff(i,e){let t=typeof i=="number"?i:typeof i=="string"?parseFloat(i)/(df(i)?100:1):NaN;return er(0,Ar(t,e),1)}var d0=/\s*;\s*/,f0=/\s*:\s*/;function g0(i,e){let t,n,r=i.getAttribute("style");if(r){let s=r.split(d0);s[s.length-1]===""&&s.pop();for(let a=s.length;a--;){let[l,c]=s[a].split(f0).map(u=>u.trim());l==="stop-color"?t=c:l==="stop-opacity"&&(n=c)}}t=t||i.getAttribute("stop-color")||"rgb(0,0,0)",n=Ar(parseFloat(n||i.getAttribute("stop-opacity")||""),1);let o=new Le(t);return o.setAlpha(o.getAlpha()*n*e),{offset:ff(i.getAttribute("offset"),0),color:o.toRgba()}}function p0(i,e){let t=[],n=i.getElementsByTagName("stop"),r=ff(e,1);for(let o=n.length;o--;)t.push(g0(n[o],r));return t}function gf(i){return i.nodeName==="linearGradient"||i.nodeName==="LINEARGRADIENT"?"linear":"radial"}function pf(i){return i.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function it(i,e){return i.getAttribute(e)}function m0(i,e){return(function(t,n){let r,{width:o,height:s,gradientUnits:a}=n;return Object.entries(t).reduce((l,c)=>{let[u,h]=c;if(h==="Infinity")r=1;else if(h==="-Infinity")r=0;else{let d=typeof h=="string";r=d?parseFloat(h):h,d&&df(h)&&(r*=.01,a==="pixels"&&(u!=="x1"&&u!=="x2"&&u!=="r2"||(r*=o),u!=="y1"&&u!=="y2"||(r*=s)))}return l[u]=r,l},{})})(gf(i)==="linear"?(function(t){return{x1:it(t,"x1")||0,y1:it(t,"y1")||0,x2:it(t,"x2")||"100%",y2:it(t,"y2")||0}})(i):(function(t){return{x1:it(t,"fx")||it(t,"cx")||"50%",y1:it(t,"fy")||it(t,"cy")||"50%",r1:0,x2:it(t,"cx")||"50%",y2:it(t,"cy")||"50%",r2:it(t,"r")||"50%"}})(i),D(p({},e),{gradientUnits:pf(i)}))}var an=class{constructor(e){let{type:t="linear",gradientUnits:n="pixels",coords:r={},colorStops:o=[],offsetX:s=0,offsetY:a=0,gradientTransform:l,id:c}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:p(p({},t==="radial"?h0:hf),r),colorStops:o,offsetX:s,offsetY:a,gradientTransform:l,id:c?`${c}_${pn()}`:pn()})}addColorStop(e){for(let t in e)this.colorStops.push({offset:parseFloat(t),color:e[t]});return this}toObject(e){return D(p({},rr(this,e)),{type:this.type,coords:p({},this.coords),colorStops:this.colorStops.map(t=>p({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],r=this.gradientTransform?this.gradientTransform.concat():ke.concat(),o=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",s=this.colorStops.map(h=>p({},h)).sort((h,d)=>h.offset-d.offset),a=-this.offsetX,l=-this.offsetY;var c;o==="objectBoundingBox"?(a/=e.width,l/=e.height):(a+=e.width/2,l+=e.height/2),(c=e)&&typeof c._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,l-=e.pathOffset.y),r[4]-=a,r[5]-=l;let u=[`id="SVGID_${this.id}"`,`gradientUnits="${o}"`,`gradientTransform="${t?t+" ":""}${Ur(r)}"`,""].join(" ");if(this.type==="linear"){let{x1:h,y1:d,x2:f,y2:g}=this.coords;n.push("<linearGradient ",u,' x1="',h,'" y1="',d,'" x2="',f,'" y2="',g,`">
`)}else if(this.type==="radial"){let{x1:h,y1:d,x2:f,y2:g,r1:v,r2:y}=this.coords,w=v>y;n.push("<radialGradient ",u,' cx="',w?h:f,'" cy="',w?d:g,'" r="',w?v:y,'" fx="',w?f:h,'" fy="',w?g:d,`">
`),w&&(s.reverse(),s.forEach(T=>{T.offset=1-T.offset}));let S=Math.min(v,y);if(S>0){let T=S/Math.max(v,y);s.forEach(M=>{M.offset+=T*(1-M.offset)})}}return s.forEach(h=>{let{color:d,offset:f}=h;n.push(`<stop offset="${100*f}%" style="stop-color:${d};"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){let{x1:t,y1:n,x2:r,y2:o,r1:s,r2:a}=this.coords,l=this.type==="linear"?e.createLinearGradient(t,n,r,o):e.createRadialGradient(t,n,s,r,o,a);return this.colorStops.forEach(c=>{let{color:u,offset:h}=c;l.addColorStop(h,u)}),l}static async fromObject(e){let{colorStops:t,gradientTransform:n}=e;return new this(D(p({},e),{colorStops:t?t.map(r=>p({},r)):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){let r=pf(e),o=t._findCenterFromElement();return new this(p({id:e.getAttribute("id")||void 0,type:gf(e),coords:m0(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:p0(e,n.opacity),gradientUnits:r,gradientTransform:Il(e.getAttribute("gradientTransform")||"")},r==="pixels"?{offsetX:t.width/2-o.x,offsetY:t.height/2-o.y}:{offsetX:0,offsetY:0}))}};m(an,"type","Gradient"),k.setClass(an,"gradient"),k.setClass(an,"linear"),k.setClass(an,"radial");var Ai=class{get type(){return"pattern"}set type(e){fn("warn","Setting type has no effect",e)}constructor(e){m(this,"repeat","repeat"),m(this,"offsetX",0),m(this,"offsetY",0),m(this,"crossOrigin",""),this.id=pn(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],{repeat:t,crossOrigin:n}=this;return D(p({},rr(this,e)),{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:Q(this.offsetX,H.NUM_FRACTION_DIGITS),offsetY:Q(this.offsetY,H.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e,{source:r,repeat:o,id:s}=this,a=Ar(this.offsetX/t,0),l=Ar(this.offsetY/n,0);return[`<pattern id="SVGID_${s}" x="${a}" y="${l}" width="${o==="repeat-y"||o==="no-repeat"?1+Math.abs(a||0):Ar(r.width/t,0)}" height="${o==="repeat-x"||o==="no-repeat"?1+Math.abs(l||0):Ar(r.height/n,0)}">`,`<image x="0" y="0" width="${r.width}" height="${r.height}" xlink:href="${this.sourceToString()}"></image>`,"</pattern>",""].join(`
`)}static async fromObject(e,t){let l=e,{type:n,source:r,patternTransform:o}=l,s=te(l,["type","source","patternTransform"]),a=await Ei(r,D(p({},t),{crossOrigin:s.crossOrigin}));return new this(D(p({},s),{patternTransform:o&&o.slice(0),source:a}))}};m(Ai,"type","Pattern"),k.setClass(Ai),k.setClass(Ai,"pattern");var $l=class{constructor(e){m(this,"color","rgb(0, 0, 0)"),m(this,"width",1),m(this,"shadow",null),m(this,"strokeLineCap","round"),m(this,"strokeLineJoin","round"),m(this,"strokeMiterLimit",10),m(this,"strokeDashArray",null),m(this,"limitedToCanvasSize",!1),this.canvas=e}_setBrushStyles(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])}_saveAndTransform(e){let t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}needsFullRender(){return new Le(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;let e=this.canvas,t=this.shadow,n=e.contextTop,r=e.getZoom()*e.getRetinaScaling();n.shadowColor=t.color,n.shadowBlur=t.blur*r,n.shadowOffsetX=t.offsetX*r,n.shadowOffsetY=t.offsetY*r}_resetShadow(){let e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}_isOutSideCanvas(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}},sn=class i extends me{constructor(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:t,left:n,top:r}=s,o=te(s,["path","left","top"]);super(),Object.assign(this,i.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof n=="number"&&this.set(X,n),typeof r=="number"&&this.set(Ie,r)}_setPath(e,t){this.path=Jd(Array.isArray(e)?e:of(e)),this.setBoundingBox(t)}_findCenterFromElement(){let e=this._calcBoundsFromPath();return new _(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){let t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(let r of this.path)switch(r[0]){case"L":e.lineTo(r[1]+t,r[2]+n);break;case"M":e.moveTo(r[1]+t,r[2]+n);break;case"C":e.bezierCurveTo(r[1]+t,r[2]+n,r[3]+t,r[4]+n,r[5]+t,r[6]+n);break;case"Q":e.quadraticCurveTo(r[1]+t,r[2]+n,r[3]+t,r[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return`#<Path (${this.complexity()}): { "top": ${this.top}, "left": ${this.left} }>`}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return D(p({},super.toObject(e)),{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){return["<path ","COMMON_PARTS",`d="${_c(this.path,H.NUM_FRACTION_DIGITS)}" stroke-linecap="round" />
`]}_getOffsetTransform(){let e=H.NUM_FRACTION_DIGITS;return` translate(${Q(-this.pathOffset.x,e)}, ${Q(-this.pathOffset.y,e)})`}toClipPathSVG(e){let t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){let t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{width:t,height:n,pathOffset:r}=this._calcDimensions();this.set({width:t,height:n,pathOffset:r}),e&&this.setPositionByOrigin(r,N,N)}_calcBoundsFromPath(){let e=[],t=0,n=0,r=0,o=0;for(let s of this.path)switch(s[0]){case"L":r=s[1],o=s[2],e.push({x:t,y:n},{x:r,y:o});break;case"M":r=s[1],o=s[2],t=r,n=o;break;case"C":e.push(...Ul(r,o,s[1],s[2],s[3],s[4],s[5],s[6])),r=s[5],o=s[6];break;case"Q":e.push(...Ul(r,o,s[1],s[2],s[1],s[2],s[3],s[4])),r=s[3],o=s[4];break;case"Z":r=t,o=n}return wt(e)}_calcDimensions(){let e=this._calcBoundsFromPath();return D(p({},e),{pathOffset:new _(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){let s=Ht(e,this.ATTRIBUTE_NAMES,n),{d:r}=s,o=te(s,["d"]);return new this(r,D(p(p({},o),t),{left:void 0,top:void 0}))}};m(sn,"type","Path"),m(sn,"cacheProperties",[...zt,"path","fillRule"]),m(sn,"ATTRIBUTE_NAMES",[...vn,"d"]),k.setClass(sn),k.setSVGClass(sn);var Li=class i extends $l{constructor(e){super(e),m(this,"decimate",.4),m(this,"drawStraightLine",!1),m(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(e,t,n){let r=t.midPointFrom(n);return e.quadraticCurveTo(t.x,t.y,r.x,r.y),r}onMouseDown(e,t){let{e:n}=t;this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],this._prepareForDrawing(e),this._addPoint(e),this._render())}onMouseMove(e,t){let{e:n}=t;if(this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(e))&&this._addPoint(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{let r=this._points,o=r.length,s=this.canvas.contextTop;this._saveAndTransform(s),this.oldEnd&&(s.beginPath(),s.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=i.drawSegment(s,r[o-2],r[o-1]),s.stroke(),s.restore()}}onMouseUp(e){let{e:t}=e;return!this.canvas._isMainEvent(t)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(e){this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)}_addPoint(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,t=this._points[0],n=this._points[1];if(this._saveAndTransform(e),e.beginPath(),this._points.length===2&&t.x===n.x&&t.y===n.y){let r=this.width/1e3;t.x-=r,n.x+=r}e.moveTo(t.x,t.y);for(let r=1;r<this._points.length;r++)i.drawSegment(e,t,n),t=this._points[r],n=this._points[r+1];e.lineTo(t.x,t.y),e.stroke(),e.restore()}convertPointsToSVGPath(e){let t=this.width/1e3;return sf(e,t)}createPath(e){let t=new sn(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new xt(this.shadow)),t}decimatePoints(e,t){if(e.length<=2)return e;let n,r=e[0],o=this.canvas.getZoom(),s=Math.pow(t/o,2),a=e.length-1,l=[r];for(let c=1;c<a-1;c++)n=Math.pow(r.x-e[c].x,2)+Math.pow(r.y-e[c].y,2),n>=s&&(r=e[c],l.push(r));return l.push(e[a]),l}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));let e=this.convertPointsToSVGPath(this._points);if((function(n){return _c(n)==="M 0 0 Q 0 0 0 0 L 0 0"})(e))return void this.canvas.requestRenderAll();let t=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.requestRenderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t})}},mf=["radius","startAngle","endAngle","counterClockwise"],_t=class i extends me{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,i.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,oe(this.startAngle),oe(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Fe)}getRadiusY(){return this.get("radius")*this.get($e)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...mf,...e])}_toSVG(){let e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',`${this.radius}`,`" />
`];{let{radius:t}=this,n=oe(this.startAngle),r=oe(this.endAngle),o=ut(n)*t,s=ht(n)*t,a=ut(r)*t,l=ht(r)*t;return[`<path d="M ${o} ${s} A ${t} ${t} 0 ${e>180?1:0} ${this.counterClockwise?0:1} ${a} ${l}" `,"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){let l=Ht(e,this.ATTRIBUTE_NAMES,n),{left:r=0,top:o=0,radius:s=0}=l,a=te(l,["left","top","radius"]);return new this(D(p({},a),{radius:s,left:r-s,top:o-s}))}static fromObject(e){return super._fromObject(e)}};m(_t,"type","Circle"),m(_t,"cacheProperties",[...zt,...mf]),m(_t,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),m(_t,"ATTRIBUTE_NAMES",["cx","cy","r",...vn]),k.setClass(_t),k.setSVGClass(_t);var Hl=["x1","x2","y1","y2"],In=class i extends me{constructor(){let[e,t,n,r]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,i.ownDefaults),this.setOptions(o),this.x1=e,this.x2=n,this.y1=t,this.y2=r,this._setWidthHeight();let{left:s,top:a}=o;typeof s=="number"&&this.set(X,s),typeof a=="number"&&this.set(Ie,a)}_setWidthHeight(){let{x1:e,y1:t,x2:n,y2:r}=this;this.width=Math.abs(n-e),this.height=Math.abs(r-t);let{left:o,top:s,width:a,height:l}=wt([{x:e,y:t},{x:n,y:r}]),c=new _(o+a/2,s+l/2);this.setPositionByOrigin(c,N,N)}_set(e,t){return super._set(e,t),Hl.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();let t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;let n=e.strokeStyle;var r;Qe(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(r=this.stroke)!==null&&r!==void 0?r:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new _((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return p(p({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){let e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){let{x1:e,x2:t,y1:n,y2:r,width:o,height:s}=this,a=e<=t?-1:1,l=n<=r?-1:1;return{x1:a*o/2,x2:a*-o/2,y1:l*s/2,y2:l*-s/2}}_toSVG(){let{x1:e,x2:t,y1:n,y2:r}=this.calcLinePoints();return["<line ","COMMON_PARTS",`x1="${e}" y1="${n}" x2="${t}" y2="${r}" />
`]}static async fromElement(e,t,n){let c=Ht(e,this.ATTRIBUTE_NAMES,n),{x1:r=0,y1:o=0,x2:s=0,y2:a=0}=c,l=te(c,["x1","y1","x2","y2"]);return new this([r,o,s,a],l)}static fromObject(e){let a=e,{x1:t,y1:n,x2:r,y2:o}=a,s=te(a,["x1","y1","x2","y2"]);return this._fromObject(D(p({},s),{points:[t,n,r,o]}),{extraParam:"points"})}};m(In,"type","Line"),m(In,"cacheProperties",[...zt,...Hl]),m(In,"ATTRIBUTE_NAMES",vn.concat(Hl)),k.setClass(In),k.setSVGClass(In);var ln=class i extends me{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,i.ownDefaults),this.setOptions(e)}_render(e){let t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){let e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',`${-e} ${t},0 ${-t},${e} ${t}`,'" />']}};m(ln,"type","Triangle"),m(ln,"ownDefaults",{width:100,height:100}),k.setClass(ln),k.setSVGClass(ln);var vf=["rx","ry"],on=class i extends me{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,i.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Fe)}getRy(){return this.get("ry")*this.get($e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...vf,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",`cx="0" cy="0" rx="${this.rx}" ry="${this.ry}" />
`]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,ct,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){let r=Ht(e,this.ATTRIBUTE_NAMES,n);return r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,new this(r)}};m(on,"type","Ellipse"),m(on,"cacheProperties",[...zt,...vf]),m(on,"ownDefaults",{rx:0,ry:0}),m(on,"ATTRIBUTE_NAMES",[...vn,"cx","cy","rx","ry"]),k.setClass(on),k.setSVGClass(on);var bf={exactBoundingBox:!1},yt=class i extends me{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),m(this,"strokeDiff",void 0),Object.assign(this,i.ownDefaults),this.setOptions(t),this.points=e;let{left:n,top:r}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(X,n),typeof r=="number"&&this.set(Ie,r)}isOpen(){return!0}_projectStrokeOnPoints(e){return $d(this.points,e,this.isOpen())}_calcDimensions(e){e=p({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});let t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(c=>c.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new _,strokeOffset:new _,strokeDiff:new _};let n=wt(t),r=ji(D(p({},e),{scaleX:1,scaleY:1})),o=wt(this.points.map(c=>Se(c,r,!0))),s=new _(this.scaleX,this.scaleY),a=n.left+n.width/2,l=n.top+n.height/2;return this.exactBoundingBox&&(a-=l*Math.tan(oe(this.skewX)),l-=a*Math.tan(oe(this.skewY))),D(p({},n),{pathOffset:new _(a,l),strokeOffset:new _(o.left,o.top).subtract(new _(n.left,n.top)).multiply(s),strokeDiff:new _(n.width,n.height).subtract(new _(o.width,o.height)).multiply(s)})}_findCenterFromElement(){let e=wt(this.points);return new _(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{left:t,top:n,width:r,height:o,pathOffset:s,strokeOffset:a,strokeDiff:l}=this._calcDimensions();this.set({width:r,height:o,pathOffset:s,strokeOffset:a,strokeDiff:l}),e&&this.setPositionByOrigin(new _(t+r/2,n+o/2),N,N)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new _(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let s;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var t,n;let{width:a,height:l}=this._calcDimensions(e);s=new _((t=e.width)!==null&&t!==void 0?t:a,(n=e.height)!==null&&n!==void 0?n:l)}else{var r,o;s=new _((r=e.width)!==null&&r!==void 0?r:this.width,(o=e.height)!==null&&o!==void 0?o:this.height)}return s.multiply(new _(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){let n=this.initialized&&this[e]!==t,r=super._set(e,t);return this.exactBoundingBox&&n&&((e===Fe||e===$e)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),r}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return D(p({},super.toObject(e)),{points:this.points.map(t=>{let{x:n,y:r}=t;return{x:n,y:r}})})}_toSVG(){let e=[],t=this.pathOffset.x,n=this.pathOffset.y,r=H.NUM_FRACTION_DIGITS;for(let o=0,s=this.points.length;o<s;o++)e.push(Q(this.points[o].x-t,r),",",Q(this.points[o].y-n,r)," ");return[`<${this.constructor.type.toLowerCase()} `,"COMMON_PARTS",`points="${e.join("")}" />
`]}_render(e){let t=this.points.length,n=this.pathOffset.x,r=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-r);for(let o=0;o<t;o++){let s=this.points[o];e.lineTo(s.x-n,s.y-r)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){let r=(function(c){if(!c)return[];let u=c.replace(/,/g," ").trim().split(/\s+/),h=[];for(let d=0;d<u.length;d+=2)h.push({x:parseFloat(u[d]),y:parseFloat(u[d+1])});return h})(e.getAttribute("points")),l=Ht(e,this.ATTRIBUTE_NAMES,n),{left:o,top:s}=l,a=te(l,["left","top"]);return new this(r,p(p({},a),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}};m(yt,"ownDefaults",bf),m(yt,"type","Polyline"),m(yt,"layoutProperties",[zr,$r,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),m(yt,"cacheProperties",[...zt,"points"]),m(yt,"ATTRIBUTE_NAMES",[...vn]),k.setClass(yt),k.setSVGClass(yt);var cn=class extends yt{isOpen(){return!1}};m(cn,"ownDefaults",bf),m(cn,"type","Polygon"),k.setClass(cn),k.setSVGClass(cn);var vs=class extends me{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;let t=e===void 0?this.styles:{line:this.styles[e]};for(let n in t)for(let r in t[n])for(let o in t[n][r])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;let n=t===void 0?this.styles:{0:this.styles[t]};for(let r in n)for(let o in n[r])if(n[r][o][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;let t=this.styles,n,r,o=0,s=!0,a=0;for(let l in t){n=0;for(let c in t[l]){let u=t[l][c]||{};o++,u[e]!==void 0?(r?u[e]!==r&&(s=!1):r=u[e],u[e]===this[e]&&delete u[e]):s=!1,Object.keys(u).length!==0?n++:delete t[l][c]}n===0&&delete t[l]}for(let l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;s&&o===a&&(this[e]=r,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;let t=this.styles,n,r,o;for(r in t){for(o in n=t[r],n)delete n[o][e],Object.keys(n[o]).length===0&&delete n[o];Object.keys(n).length===0&&delete t[r]}}_extendStyles(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);let o=sc(p(p({},this._getStyleDeclaration(n,r)),t),s=>s!==void 0);this._setStyleDeclaration(n,r,o)}getSelectionStyles(e,t,n){let r=[];for(let o=e;o<(t||e);o++)r.push(this.getStyleAtPosition(o,n));return r}getStyleAtPosition(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,r):this._getStyleDeclaration(n,r)}setSelectionStyles(e,t,n){for(let r=t;r<(n||t);r++)this._extendStyles(r,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;let r=this.styles&&this.styles[e];return r&&(n=r[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return p(p({},rr(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}};m(vs,"_styleProperties",pm);var v0=/  +/g,b0=/"/g;function dl(i,e,t,n,r){return`		${(function(o,s){let{left:a,top:l,width:c,height:u}=s,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:H.NUM_FRACTION_DIGITS,d=Pi(pe,o,!1),[f,g,v,y]=[a,l,c,u].map(w=>Q(w,h));return`<rect ${d} x="${f}" y="${g}" width="${v}" height="${y}"></rect>`})(i,{left:e,top:t,width:n,height:r})}
`}var fl,Je=class i extends vs{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(e,t){super(),m(this,"__charBounds",[]),Object.assign(this,i.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){let e=this.path;e&&(e.segmentsInfo=yc(e.path))}_splitText(){let e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Ct)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,r,o,s,a;for(let l=0,c=this._textLines.length;l<c;l++)if((this.textAlign===Ct||l!==c-1&&!this.isEndOfWrapping(l))&&(r=0,o=this._textLines[l],t=this.getLineWidth(l),t<this.width&&(a=this.textLines[l].match(this._reSpacesAndTabs)))){n=a.length,e=(this.width-t)/n;for(let u=0;u<=o.length;u++)s=this.__charBounds[l][u],this._reSpaceAndTab.test(o[u])?(s.width+=e,s.kernedWidth+=e,s.left+=r,r+=e):s.left+=r}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){let n=t?this._unwrappedTextLines:this._textLines,r;for(r=0;r<n.length;r++){if(e<=n[r].length)return{lineIndex:r,charIndex:e};e-=n[r].length+this.missingNewlineOffset(r,t)}return{lineIndex:r-1,charIndex:n[r-1].length<e?n[r-1].length:e}}toString(){return`#<Text (${this.complexity()}): { "text": "${this.text}", "fontFamily": "${this.fontFamily}" }>`}_getCacheCanvasDimensions(){let e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){let t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===ze?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case N:e.textBaseline="middle";break;case"ascender":e.textBaseline=Ie;break;case"descender":e.textBaseline=_l}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){let r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,n,r,o,s){this._renderChars(e,t,n,r,o,s)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;let t=e.fillStyle,n=this._getLeftOffset(),r=this._getTopOffset();for(let o=0,s=this._textLines.length;o<s;o++){let a=this.getHeightOfLine(o);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",o)){r+=a;continue}let l=this._textLines[o].length,c=this._getLineLeftOffset(o),u,h,d=0,f=0,g=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),v=this.getHeightOfLineImpl(o);for(let y=0;y<l;y++){let w=this.__charBounds[o][y];h=this.getValueOfPropertyAt(o,y,"textBackgroundColor"),this.path?(e.save(),e.translate(w.renderLeft,w.renderTop),e.rotate(w.angle),e.fillStyle=h,h&&e.fillRect(-w.width/2,-v*(1-this._fontSizeFraction),w.width,v),e.restore()):h!==g?(u=n+c+f,this.direction===Ut&&(u=this.width-u-d),e.fillStyle=g,g&&e.fillRect(u,r,d,v),f=w.left,d=w.width,g=h):d+=w.kernedWidth}h&&!this.path&&(u=n+c+f,this.direction===Ut&&(u=this.width-u-d),e.fillStyle=h,e.fillRect(u,r,d,v)),r+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,r){let o=Di.getFontCache(t),s=this._getFontDeclaration(t),a=n?n+e:e,l=n&&s===this._getFontDeclaration(r),c=t.fontSize/this.CACHE_FONT_SIZE,u,h,d,f;if(n&&o.has(n)&&(d=o.get(n)),o.has(e)&&(f=u=o.get(e)),l&&o.has(a)&&(h=o.get(a),f=h-d),u===void 0||d===void 0||h===void 0){let g=(function(){return fl||(fl=He({width:0,height:0}).getContext("2d")),fl})();this._setTextStyles(g,t,!0),u===void 0&&(f=u=g.measureText(e).width,o.set(e,u)),d===void 0&&l&&n&&(d=g.measureText(n).width,o.set(n,d)),l&&h===void 0&&(h=g.measureText(a).width,o.set(a,h),f=h-d)}return{width:u*c,kernedWidth:f*c}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){let t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,r=0,o=this.pathSide===ue,s=this.path,a=this._textLines[e],l=a.length,c=new Array(l);this.__charBounds[e]=c;for(let u=0;u<l;u++){let h=a[u];n=this._getGraphemeBox(h,e,u,t),c[u]=n,r+=n.kernedWidth,t=h}if(c[l]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},s&&s.segmentsInfo){let u=0,h=s.segmentsInfo[s.segmentsInfo.length-1].length;switch(this.textAlign){case X:u=o?h-r:0;break;case N:u=(h-r)/2;break;case ue:u=o?0:h-r}u+=this.pathStartOffset*(o?-1:1);for(let d=o?l-1:0;o?d>=0:d<l;o?d--:d++)n=c[d],u>h?u%=h:u<0&&(u+=h),this._setGraphemeOnPath(u,n),u+=n.kernedWidth}return{width:r,numOfSpaces:0}}_setGraphemeOnPath(e,t){let n=e+t.kernedWidth/2,r=this.path,o=rf(r.path,n,r.segmentsInfo);t.renderLeft=o.x-r.pathOffset.x,t.renderTop=o.y-r.pathOffset.y,t.angle=o.angle+(this.pathSide===ue?Math.PI:0)}_getGraphemeBox(e,t,n,r,o){let s=this.getCompleteStyleDeclaration(t,n),a=r?this.getCompleteStyleDeclaration(t,n-1):{},l=this._measureChar(e,s,r,a),c,u=l.kernedWidth,h=l.width;this.charSpacing!==0&&(c=this._getWidthOfCharSpacing(),h+=c,u+=c);let d={width:h,left:0,height:s.fontSize,kernedWidth:u,deltaY:s.deltaY};if(n>0&&!o){let f=this.__charBounds[t][n-1];d.left=f.left+f.width+l.kernedWidth-l.width}return d}getHeightOfLineImpl(e){let t=this.__lineHeights;if(t[e])return t[e];let n=this.getHeightOfChar(e,0);for(let r=1,o=this._textLines[e].length;r<o;r++)n=Math.max(this.getHeightOfChar(e,r),n);return t[e]=n*this._fontSizeMult}getHeightOfLine(e){return this.getHeightOfLineImpl(e)*this.lineHeight}calcTextHeight(){let e=0;for(let t=0,n=this._textLines.length;t<n;t++)e+=t===n-1?this.getHeightOfLineImpl(t):this.getHeightOfLine(t);return e}_getLeftOffset(){return this.direction===kn?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0,r=this._getLeftOffset(),o=this._getTopOffset();for(let s=0,a=this._textLines.length;s<a;s++)this._renderTextLine(t,e,this._textLines[s],r+this._getLineLeftOffset(s),o+n+this.getHeightOfLineImpl(s),s),n+=this.getHeightOfLine(s);e.restore()}_renderTextFill(e){(this.fill||this.styleHas(pe))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,r,o,s){let a=this.textAlign.includes(Ct),l=this.path,c=!a&&this.charSpacing===0&&this.isEmptyStyles(s)&&!l,u=this.direction===kn,h=this.direction===kn?1:-1,d=t.direction,f,g,v,y,w,S="",T=0;if(t.save(),d!==this.direction&&(t.canvas.setAttribute("dir",u?kn:Ut),t.direction=u?kn:Ut,t.textAlign=u?X:ue),o-=this.getHeightOfLineImpl(s)*this._fontSizeFraction,c)return this._renderChar(e,t,s,0,n.join(""),r,o),void t.restore();for(let M=0,O=n.length-1;M<=O;M++)y=M===O||this.charSpacing||l,S+=n[M],v=this.__charBounds[s][M],T===0?(r+=h*(v.kernedWidth-v.width),T+=v.width):T+=v.kernedWidth,a&&!y&&this._reSpaceAndTab.test(n[M])&&(y=!0),y||(f=f||this.getCompleteStyleDeclaration(s,M),g=this.getCompleteStyleDeclaration(s,M+1),y=Fs(f,g,!1)),y&&(l?(t.save(),t.translate(v.renderLeft,v.renderTop),t.rotate(v.angle),this._renderChar(e,t,s,M,S,-T/2,0),t.restore()):(w=r,this._renderChar(e,t,s,M,S,w,o)),S="",f=g,r+=h*T,T=0);t.restore()}_applyPatternGradientTransformText(e){let t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,r=He({width:t,height:n}),o=r.getContext("2d");return r.width=t,r.height=n,o.beginPath(),o.moveTo(0,0),o.lineTo(t,0),o.lineTo(t,n),o.lineTo(0,n),o.closePath(),o.translate(t/2,n/2),o.fillStyle=e.toLive(o),this._applyPatternGradientTransform(o,e),o.fill(),o.createPattern(r,"no-repeat")}handleFiller(e,t,n){let r,o;return Qe(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(r=-this.width/2,o=-this.height/2,e.translate(r,o),e[t]=this._applyPatternGradientTransformText(n),{offsetX:r,offsetY:o}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:r}=t;return e.lineWidth=r,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,r,o,s,a){let l=this._getStyleDeclaration(n,r),c=this.getCompleteStyleDeclaration(n,r),u=e==="fillText"&&c.fill,h=e==="strokeText"&&c.stroke&&c.strokeWidth;if(h||u){if(t.save(),t.font=this._getFontDeclaration(c),l.textBackgroundColor&&this._removeShadow(t),l.deltaY&&(a+=l.deltaY),u){let d=this._setFillStyles(t,c);t.fillText(o,s-d.offsetX,a-d.offsetY)}if(h){let d=this._setStrokeStyles(t,c);t.strokeText(o,s-d.offsetX,a-d.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){let r=this.get2DCursorLocation(e,!0),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),s=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),a={fontSize:o*n.size,deltaY:s+o*n.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){let t=this.getLineWidth(e),n=this.width-t,r=this.textAlign,o=this.direction,s=this.isEndOfWrapping(e),a=0;return r===Ct||r===Oi&&!s||r===Ti&&!s||r===as&&!s?0:(r===N&&(a=n/2),r===ue&&(a=n),r===Oi&&(a=n/2),r===Ti&&(a=n),o===Ut&&(r===ue||r===Ti?a=0:r===X||r===as?a=-n:r!==N&&r!==Oi||(a=-n/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];let{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var r;return(r=this._getStyleDeclaration(e,t)[n])!==null&&r!==void 0?r:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset(),r=this._getLeftOffset(),o=this.path,s=this._getWidthOfCharSpacing(),a=t==="linethrough"?.5:t==="overline"?1:0,l=this.offsets[t];for(let c=0,u=this._textLines.length;c<u;c++){let h=this.getHeightOfLine(c);if(!this[t]&&!this.styleHas(t,c)){n+=h;continue}let d=this._textLines[c],f=h/this.lineHeight,g=this._getLineLeftOffset(c),v=0,y=0,w=this.getValueOfPropertyAt(c,0,t),S=this.getValueOfPropertyAt(c,0,pe),T=this.getValueOfPropertyAt(c,0,Qn),M=w,O=S,R=T,B=n+f*(1-this._fontSizeFraction),I=this.getHeightOfChar(c,0),z=this.getValueOfPropertyAt(c,0,"deltaY");for(let q=0,J=d.length;q<J;q++){let G=this.__charBounds[c][q];M=this.getValueOfPropertyAt(c,q,t),O=this.getValueOfPropertyAt(c,q,pe),R=this.getValueOfPropertyAt(c,q,Qn);let ve=this.getHeightOfChar(c,q),fe=this.getValueOfPropertyAt(c,q,"deltaY");if(o&&M&&O){let be=this.fontSize*R/1e3;e.save(),e.fillStyle=S,e.translate(G.renderLeft,G.renderTop),e.rotate(G.angle),e.fillRect(-G.kernedWidth/2,l*ve+fe-a*be,G.kernedWidth,be),e.restore()}else if((M!==w||O!==S||ve!==I||R!==T||fe!==z)&&y>0){let be=this.fontSize*T/1e3,ee=r+g+v;this.direction===Ut&&(ee=this.width-ee-y),w&&S&&T&&(e.fillStyle=S,e.fillRect(ee,B+l*I+z-a*be,y,be)),v=G.left,y=G.width,w=M,T=R,S=O,I=ve,z=fe}else y+=G.kernedWidth}let le=r+g+v;this.direction===Ut&&(le=this.width-le-y),e.fillStyle=O;let ce=this.fontSize*R/1e3;M&&O&&R&&e.fillRect(le,B+l*I+z-a*ce,y-s,ce),n+=h}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:r=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,s=e.includes("'")||e.includes('"')||e.includes(",")||i.genericFonts.includes(e.toLowerCase())?e:`"${e}"`;return[t,n,`${o?this.CACHE_FONT_SIZE:r}px`,s].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return ks(e)}_splitTextIntoLines(e){let t=e.split(this._reNewline),n=new Array(t.length),r=[`
`],o=[];for(let s=0;s<t.length;s++)n[s]=this.graphemeSplit(t[s]),o=o.concat(n[s],r);return o.pop(),{_unwrappedLines:n,lines:t,graphemeText:o,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return p(D(p({},super.toObject([...Cd,...e])),{styles:Gd(this.styles,this.text)}),this.path?{path:this.path.toObject()}:{})}set(e,t){let{textLayoutProperties:n}=this.constructor;super.set(e,t);let r=!1,o=!1;if(typeof e=="object")for(let s in e)s==="path"&&this.setPathInfo(),r=r||n.includes(s),o=o||s==="path";else r=n.includes(e),o=e==="path";return o&&this.setPathInfo(),r&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){let r=Ht(e,i.ATTRIBUTE_NAMES,n),T=p(p({},t),r),{textAnchor:o=X,textDecoration:s="",dx:a=0,dy:l=0,top:c=0,left:u=0,fontSize:h=Jl,strokeWidth:d=1}=T,f=te(T,["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"]),g=new this(os(e.textContent||"").trim(),p({left:u+a,top:c+l,underline:s.includes("underline"),overline:s.includes("overline"),linethrough:s.includes("line-through"),strokeWidth:0,fontSize:h},f)),v=g.getScaledHeight()/g.height,y=((g.height+g.strokeWidth)*g.lineHeight-g.height)*v,w=g.getScaledHeight()+y,S=0;return o===N&&(S=g.getScaledWidth()/2),o===ue&&(S=g.getScaledWidth()),g.set({left:g.left-S,top:g.top-(w-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:d}),g}static fromObject(e){return this._fromObject(D(p({},e),{styles:Wd(e.styles||{},e.text)}),{extraParam:"text"})}};m(Je,"textLayoutProperties",_d),m(Je,"cacheProperties",[...zt,...Cd]),m(Je,"ownDefaults",mm),m(Je,"type","Text"),m(Je,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),m(Je,"ATTRIBUTE_NAMES",vn.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),Vd(Je,[class extends ss{_toSVG(){let i=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(i){let e=this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:i,withShadow:!0,additionalTransform:Ur(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(i){let{textBgRects:e,textSpans:t}=i,n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',`font-family="${this.fontFamily.replace(b0,"'")}" `,`font-size="${this.fontSize}" `,this.fontStyle?`font-style="${this.fontStyle}" `:"",this.fontWeight?`font-weight="${this.fontWeight}" `:"",n?`text-decoration="${n}" `:"",this.direction==="rtl"?`direction="${this.direction}" `:"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(i,e){let t=[],n=[],r,o=i;this.backgroundColor&&n.push(...dl(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let s=0,a=this._textLines.length;s<a;s++)r=this._getLineLeftOffset(s),this.direction==="rtl"&&(r+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",s))&&this._setSVGTextLineBg(n,s,e+r,o),this._setSVGTextLineText(t,s,e+r,o),o+=this.getHeightOfLine(s);return{textSpans:t,textBgRects:n}}_createTextCharSpan(i,e,t,n,r){let o=H.NUM_FRACTION_DIGITS,s=this.getSvgSpanStyles(e,i!==i.trim()||!!i.match(v0)),a=s?`style="${s}"`:"",l=e.deltaY,c=l?` dy="${Q(l,o)}" `:"",{angle:u,renderLeft:h,renderTop:d,width:f}=r,g="";if(h!==void 0){let v=f/2;u&&(g=` rotate="${Q(Bt(u),o)}"`);let y=nr({angle:Bt(u)});y[4]=h,y[5]=d;let w=new _(-v,0).transform(y);t=w.x,n=w.y}return`<tspan x="${Q(t,o)}" y="${Q(n,o)}" ${c}${g}${a}>${Hd(i)}</tspan>`}_setSVGTextLineText(i,e,t,n){let r=this.getHeightOfLine(e),o=this.textAlign.includes(Ct),s=this._textLines[e],a,l,c,u,h,d="",f=0;n+=r*(1-this._fontSizeFraction)/this.lineHeight;for(let g=0,v=s.length-1;g<=v;g++)h=g===v||this.charSpacing||this.path,d+=s[g],c=this.__charBounds[e][g],f===0?(t+=c.kernedWidth-c.width,f+=c.width):f+=c.kernedWidth,o&&!h&&this._reSpaceAndTab.test(s[g])&&(h=!0),h||(a=a||this.getCompleteStyleDeclaration(e,g),l=this.getCompleteStyleDeclaration(e,g+1),h=Fs(a,l,!0)),h&&(u=this._getStyleDeclaration(e,g),i.push(this._createTextCharSpan(d,u,t,n,c)),d="",a=l,this.direction==="rtl"?t-=f:t+=f,f=0)}_setSVGTextLineBg(i,e,t,n){let r=this._textLines[e],o=this.getHeightOfLine(e)/this.lineHeight,s,a=0,l=0,c=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<r.length;u++){let{left:h,width:d,kernedWidth:f}=this.__charBounds[e][u];s=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),s!==c?(c&&i.push(...dl(c,t+l,n,a,o)),l=h,a=d,c=s):a+=f}s&&i.push(...dl(c,t+l,n,a,o))}getSvgStyles(i){return`${super.getSvgStyles(i)} text-decoration-thickness: ${Q(this.textDecorationThickness*this.getObjectScaling().y/10,H.NUM_FRACTION_DIGITS)}%; white-space: pre;`}getSvgSpanStyles(i,e){let{fontFamily:t,strokeWidth:n,stroke:r,fill:o,fontSize:s,fontStyle:a,fontWeight:l,textDecorationThickness:c,linethrough:u,overline:h,underline:d}=i,f=this.getSvgTextDecoration({underline:d??this.underline,overline:h??this.overline,linethrough:u??this.linethrough}),g=c||this.textDecorationThickness;return[r?Pi(ze,r):"",n?`stroke-width: ${n}; `:"",t?`font-family: ${t.includes("'")||t.includes('"')?t:`'${t}'`}; `:"",s?`font-size: ${s}px; `:"",a?`font-style: ${a}; `:"",l?`font-weight: ${l}; `:"",f?`text-decoration: ${f}; text-decoration-thickness: ${Q(g*this.getObjectScaling().y/10,H.NUM_FRACTION_DIGITS)}%; `:"",o?Pi(pe,o):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(i){return["overline","underline","line-through"].filter(e=>i[e.replace("-","")]).join(" ")}}]),k.setClass(Je),k.setSVGClass(Je);var Gl=class{constructor(e){m(this,"target",void 0),m(this,"__mouseDownInPlace",!1),m(this,"__dragStartFired",!1),m(this,"__isDraggingOver",!1),m(this,"__dragStartSelection",void 0),m(this,"__dragImageDisposer",void 0),m(this,"_dispose",void 0),this.target=e;let t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){let t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){let t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:r,selectionEnd:o}=t,s=this.target,a=s.canvas,l=new _(s.flipX?-1:1,s.flipY?-1:1),c=s._getCursorBoundaries(r),u=new _(c.left+c.leftOffset,c.top+c.topOffset).multiply(l).transform(s.calcTransformMatrix()),h=a.getScenePoint(e).subtract(u),d=s.getCanvasRetinaScaling(),f=s.getBoundingRect(),g=u.subtract(new _(f.left,f.top)),v=a.viewportTransform,y=g.add(h).transform(v,!0),w=s.backgroundColor,S=mc(s.styles);s.backgroundColor="";let T={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};s.setSelectionStyles(T,0,r),s.setSelectionStyles(T,o,s.text.length),s.dirty=!0;let M=s.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});s.backgroundColor=w,s.styles=S,s.dirty=!0,jl(M,{position:"fixed",left:-M.width+"px",border:Re,width:M.width/d+"px",height:M.height/d+"px"}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{M.remove()},st(e.target||this.target.hiddenTextarea).body.appendChild(M),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(M,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;let t=this.target,n=this.isActive();if(n&&e.dataTransfer){let r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},o=t._text.slice(r.selectionStart,r.selectionEnd).join(""),s=p({text:t.text,value:o},r);e.dataTransfer.setData("text/plain",o),e.dataTransfer.setData("application/fabric",JSON.stringify({value:o,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,s)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){let t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){let{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;let{e:n}=e,r=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let o=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(o&&!r){let s=this.target,a=s.canvas,l=s.getSelectionStartFromPointer(n),{styles:c}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},u=o[Math.max(0,o.length-1)],h=0;if(this.__dragStartSelection){let d=this.__dragStartSelection.selectionStart,f=this.__dragStartSelection.selectionEnd;l>d&&l<=f?l=d:l>f&&(l-=f-d),s.removeChars(d,f),delete this.__dragStartSelection}s._reNewline.test(u)&&(s._reNewline.test(s._text[l])||l===s._text.length)&&(o=o.trimEnd()),e.didDrop=!0,e.dropTarget=s,s.insertChars(o,c,l),a.setActiveObject(s),s.enterEditing(n),s.selectionStart=Math.min(l+h,s._text.length),s.selectionEnd=Math.min(s.selectionStart+o.length,s._text.length),s.hiddenTextarea.value=s.text,s._updateTextarea(),s.hiddenTextarea.focus(),s.fire(Ko,{index:l+h,action:"drop"}),a.fire("text:changed",{target:s}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;let r=this.target,o=this.target.canvas,{selectionStart:s,selectionEnd:a}=this.__dragStartSelection,l=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||Re;l===Re?(r.selectionStart=s,r.selectionEnd=a,r._updateTextarea(),r.hiddenTextarea.focus()):(r.clearContextTop(),l==="move"&&(r.removeChars(s,a),r.selectionStart=r.selectionEnd=s,r.hiddenTextarea&&(r.hiddenTextarea.value=r.text),r._updateTextarea(),r.fire(Ko,{index:s,action:"dragend"}),o.fire("text:changed",{target:r}),o.requestRenderAll()),r.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}},Gh=/[ \n\.,;!\?\-]/,Wl=class extends Je{constructor(){super(...arguments),m(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:r,onComplete:o}=e;return dc({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:r,onComplete:o,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:s=>{this._currentCursorOpacity=s,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){let n=this._text,r=e>0&&this._reSpace.test(n[e])&&(t===-1||!Ql.test(n[e-1]))?e-1:e,o=n[r];for(;r>0&&r<n.length&&!Gh.test(o);)r+=t,o=n[r];return t===-1&&Gh.test(o)&&r++,r}selectWord(e){e=e??this.selectionStart;let t=this.searchWordBoundary(e,-1),n=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e??this.selectionStart;let t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;let t=this.hiddenTextarea;st(t).activeElement!==t&&t.focus();let n=this.getSelectionStartFromPointer(e),r=this.selectionStart,o=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&r!==o||r!==n&&o!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===o||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){let r=n.slice(0,e),o=this.graphemeSplit(r).length;if(e===t)return{selectionStart:o,selectionEnd:o};let s=n.slice(e,t);return{selectionStart:o,selectionEnd:o+this.graphemeSplit(s).length}}fromGraphemeToStringSelection(e,t,n){let r=n.slice(0,e).join("").length;return e===t?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){let e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){let{hiddenTextarea:e,direction:t,textAlign:n,inCompositionMode:r}=this;if(!e)return;let o=n!==Ct?n.replace("justify-",""):t===kn?X:ue,s=this.getPositionByOrigin(o,"top");this.cursorOffsetCache={},this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setPositionByOrigin(s,o,"top"),this.setCoords();let a=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=a.selectionEnd,r||(this.selectionStart=a.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){let e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};let e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),r=n.lineIndex,o=n.charIndex,s=this.getValueOfPropertyAt(r,o,"fontSize")*this.lineHeight,a=t.leftOffset,l=this.getCanvasRetinaScaling(),c=this.canvas.upperCanvasEl,u=c.width/l,h=c.height/l,d=u-s,f=h-s,g=new _(t.left+a,t.top+t.topOffset+s).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new _(c.clientWidth/u,c.clientHeight/h));return g.x<0&&(g.x=0),g.x>d&&(g.x=d),g.y<0&&(g.y=0),g.y>f&&(g.y=f),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:`${g.x}px`,top:`${g.y}px`,fontSize:`${s}px`,charHeight:s}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}exitEditingImpl(){let e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){let e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(Zo),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(let e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e,!0),{lineIndex:o,charIndex:s}=this.get2DCursorLocation(t,!0);if(n!==o){if(this.styles[n])for(let a=r;a<this._unwrappedTextLines[n].length;a++)delete this.styles[n][a];if(this.styles[o])for(let a=s;a<this._unwrappedTextLines[o].length;a++){let l=this.styles[o][a];l&&(this.styles[n]||(this.styles[n]={}),this.styles[n][r+a-s]=l)}for(let a=n+1;a<=o;a++)delete this.styles[a];this.shiftLineStyles(o,n-o)}else if(this.styles[n]){let a=this.styles[n],l=s-r;for(let c=r;c<s;c++)delete a[c];for(let c in this.styles[n]){let u=parseInt(c,10);u>=s&&(a[u-l]=a[c],delete a[c])}}}shiftLineStyles(e,t){let n=Object.assign({},this.styles);for(let r in this.styles){let o=parseInt(r,10);o>e&&(this.styles[o+t]=n[o],n[o-t]||delete this.styles[o])}}insertNewlineStyleObject(e,t,n,r){let o={},s=this._unwrappedTextLines[e].length,a=s===t,l=!1;n||(n=1),this.shiftLineStyles(e,n);let c=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(let h in this.styles[e]){let d=parseInt(h,10);d>=t&&(l=!0,o[d-t]=this.styles[e][h],a&&t===0||delete this.styles[e][h])}let u=!1;for(l&&!a&&(this.styles[e+n]=o,u=!0),(u||s>t)&&n--;n>0;)r&&r[n-1]?this.styles[e+n]={0:p({},r[n-1])}:c?this.styles[e+n]={0:p({},c)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,r){this.styles||(this.styles={});let o=this.styles[e],s=o?p({},o):{};n||(n=1);for(let l in s){let c=parseInt(l,10);c>=t&&(o[c+n]=s[c],s[c-n]||delete o[c])}if(this._forceClearCache=!0,r){for(;n--;)Object.keys(r[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=p({},r[n]));return}if(!o)return;let a=o[t?t-1:1];for(;a&&n--;)this.styles[e][t+n]=p({},a)}insertNewStyleBlock(e,t,n){let r=this.get2DCursorLocation(t,!0),o=[0],s,a=0;for(let l=0;l<e.length;l++)e[l]===`
`?(a++,o[a]=0):o[a]++;for(o[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,o[0],n),n=n&&n.slice(o[0]+1)),a&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+o[0],a),s=1;s<a;s++)o[s]>0?this.insertCharStyleObject(r.lineIndex+s,0,o[s],n):n&&this.styles[r.lineIndex+s]&&n[0]&&(this.styles[r.lineIndex+s][0]=n[0]),n=n&&n.slice(o[s]+1);o[s]>0&&this.insertCharStyleObject(r.lineIndex+s,0,o[s],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;r>n&&this.removeStyleFromTo(n,r);let o=this.graphemeSplit(e);this.insertNewStyleBlock(o,n,t),this._text=[...this._text.slice(0,n),...o,...this._text.slice(r)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=X:this._selectionDirection===ue&&(this._selectionDirection=X,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===ue?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=ue:this._selectionDirection===X&&(this._selectionDirection=ue,this.selectionStart=t),this.selectionEnd=n)}},Yl=class extends Wl{initHiddenTextarea(){let e=this.canvas&&st(this.canvas.getElement())||Vr(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map(s=>{let[a,l]=s;return t.setAttribute(a,l)});let{top:n,left:r,fontSize:o}=this._calcTextareaPosition();t.style.cssText=`position: absolute; top: ${n}; left: ${r}; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ${o};`,(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(s=>{let[a,l]=s;return t.addEventListener(a,this[l].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;let t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){let t=this.fromPaste,{value:n,selectionStart:r,selectionEnd:o}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;let s=()=>{this.updateFromTextArea(),this.fire(Ko),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void s();let a=this._splitTextIntoLines(n).graphemeText,l=this._text.length,c=a.length,u=this.selectionStart,h=this.selectionEnd,d=u!==h,f,g,v,y,w=c-l,S=this.fromStringToGraphemeSelection(r,o,n),T=u>S.selectionStart;d?(g=this._text.slice(u,h),w+=h-u):c<l&&(g=T?this._text.slice(h+w,h):this._text.slice(u,u-w));let M=a.slice(S.selectionEnd-w,S.selectionEnd);if(g&&g.length&&(M.length&&(f=this.getSelectionStyles(u,u+1,!1),f=M.map(()=>f[0])),d?(v=u,y=h):T?(v=h-g.length,y=h):(v=h,y=h+g.length),this.removeStyleFromTo(v,y)),M.length){let{copyPasteData:O}=St();t&&M.join("")===O.copiedText&&!H.disableStyleCopyPaste&&(f=O.copiedTextStyle),this.insertNewStyleBlock(M,u,f)}s()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e,{selectionStart:n,selectionEnd:r}=t;this.compositionStart=n,this.compositionEnd=r,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;let{copyPasteData:e}=St();e.copiedText=this.getSelectedText(),H.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,r=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],r+=n.left+n.width),r}getDownCursorOffset(e,t){let n=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(n),o=r.lineIndex;if(o===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;let s=r.charIndex,a=this._getWidthBeforeCursor(o,s),l=this._getIndexOnLine(o+1,a);return this._textLines[o].slice(s).length+l+1+this.missingNewlineOffset(o)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){let n=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(n),o=r.lineIndex;if(o===0||e.metaKey||e.keyCode===33)return-n;let s=r.charIndex,a=this._getWidthBeforeCursor(o,s),l=this._getIndexOnLine(o-1,a),c=this._textLines[o].slice(0,s),u=this.missingNewlineOffset(o-1);return-this._textLines[o-1].length+l-c.length+(1-u)}_getIndexOnLine(e,t){let n=this._textLines[e],r,o,s=this._getLineLeftOffset(e),a=0;for(let l=0,c=n.length;l<c;l++)if(r=this.__charBounds[e][l].width,s+=r,s>t){o=!0;let u=s-r,h=s,d=Math.abs(u-t);a=Math.abs(h-t)<d?l:l-1;break}return o||(a=n.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){let n=this[`get${e}CursorOffset`](t,this._selectionDirection===ue);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){let r=this.text.length;this.selectionStart=er(0,this.selectionStart,r),this.selectionEnd=er(0,this.selectionEnd,r),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){let t=this._selectionDirection===X?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let r;if(e.altKey)r=this[`findWordBoundary${n}`](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;r=this[`findLineBoundary${n}`](this[t])}return r!==void 0&&this[t]!==r&&(this[t]=r,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=X,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===ue&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=X,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){let n=`moveCursor${e}${t.shiftKey?"WithShift":"WithoutShift"}`;this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===X&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=ue,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=ue,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}},Wh=i=>!!i.button,Xl=class extends Yl{constructor(){super(...arguments),m(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new Gl(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:n}=e;this.canvas&&this.editable&&!Wh(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),n&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=n||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:n}=e,r=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);let o=this.canvas._activeObject;if(o&&o!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||Wh(t)||r||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){let t=this.getSelectionStartFromPointer(e),n=this.selectionStart,r=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,r,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){let t=this.canvas.getScenePoint(e).transform(Ve(this.calcTransformMatrix())).add(new _(-this._getLeftOffset(),-this._getTopOffset())),n=0,r=0,o=0;for(let c=0;c<this._textLines.length&&n<=t.y;c++)n+=this.getHeightOfLine(c),o=c,c>0&&(r+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));let s=Math.abs(this._getLineLeftOffset(o)),a=this._textLines[o].length,l=this.__charBounds[o];for(let c=0;c<a;c++){let u=s+l[c].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-s)&&r++;break}s=u,r++}return Math.min(this.flipX?a-r:r,this._text.length)}},Vo="moveCursorUp",zo="moveCursorDown",$o="moveCursorLeft",Ho="moveCursorRight",Go="exitEditing",Yh=(i,e)=>{let t=e.getRetinaScaling();i.setTransform(t,0,0,t,0,0);let n=e.viewportTransform;i.transform(n[0],n[1],n[2],n[3],n[4],n[5])},y0={selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Go,27:Go,33:Vo,34:zo,35:Ho,36:$o,37:$o,38:Vo,39:Ho,40:zo},keysMapRtl:{9:Go,27:Go,33:Vo,34:zo,35:$o,36:Ho,37:Ho,38:Vo,39:$o,40:zo},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"},_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1},un=class i extends Xl{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}get type(){let e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,p(p({},i.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof Br&&this.canvas.textEditingManager.remove(this),t instanceof Br&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){let t=this.isEditing;this.isEditing=!1;let n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;let e=this.clearContextTop(!0);if(!e)return;let t=this._getCursorBoundaries(),n=this.findAncestorsWithClipPath(),r=n.length>0,o,s=e;if(r){o=He(e.canvas),s=o.getContext("2d"),Yh(s,this.canvas);let a=this.calcTransformMatrix();s.transform(a[0],a[1],a[2],a[3],a[4],a[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(s,t):this.renderCursor(s,t),r)for(let a of n){let l=a.clipPath,c=He(e.canvas),u=c.getContext("2d");if(Yh(u,this.canvas),!l.absolutePositioned){let h=a.calcTransformMatrix();u.transform(h[0],h[1],h[2],h[3],h[4],h[5])}l.transform(u),l.drawObject(u,!0,{}),this.drawClipPathOnCache(s,l,c)}r&&(e.setTransform(1,0,0,1,0,0),e.drawImage(o,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){let e=[],t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0,n=this._getLeftOffset(),r=this._getTopOffset(),o=this._getCursorBoundariesOffsets(e,t);return{left:n,top:r,leftOffset:o.left,topOffset:o.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0,{charIndex:r,lineIndex:o}=this.get2DCursorLocation(e),{textAlign:s,direction:a}=this;for(let h=0;h<o;h++)t+=this.getHeightOfLine(h);let l=this._getLineLeftOffset(o),c=this.__charBounds[o][r];c&&(n=c.left),this.charSpacing!==0&&r===this._textLines[o].length&&(n-=this._getWidthOfCharSpacing());let u=l+(n>0?n:0);return a===Ut&&(s===ue||s===Ct||s===Ti?u*=-1:s===X||s===as?u=l-(n>0?n:0):s!==N&&s!==Oi||(u=l-(n>0?n:0))),{top:t,left:u}}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),r=n.lineIndex,o=n.charIndex>0?n.charIndex-1:0,s=this.getValueOfPropertyAt(r,o,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/a,c=this.getValueOfPropertyAt(r,o,"deltaY"),u=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-s*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(r,o,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-l/2,top:u+t.top+c,width:l,height:s}}_renderCursor(e,t,n){let{color:r,opacity:o,left:s,top:a,width:l,height:c}=this.getCursorRenderingData(n,t);e.fillStyle=r,e.globalAlpha=o,e.fillRect(s,a,l,c)}renderSelection(e,t){let n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){let e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){let t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){let{textAlign:r,direction:o}=this,s=t.selectionStart,a=t.selectionEnd,l=r.includes(Ct),c=this.get2DCursorLocation(s),u=this.get2DCursorLocation(a),h=c.lineIndex,d=u.lineIndex,f=c.charIndex<0?0:c.charIndex,g=u.charIndex<0?0:u.charIndex;for(let v=h;v<=d;v++){let y=this._getLineLeftOffset(v)||0,w=this.getHeightOfLine(v),S=0,T=0,M=0;if(v===h&&(T=this.__charBounds[h][f].left),v>=h&&v<d)M=l&&!this.isEndOfWrapping(v)?this.width:this.getLineWidth(v)||5;else if(v===d)if(g===0)M=this.__charBounds[d][g].left;else{let z=this._getWidthOfCharSpacing();M=this.__charBounds[d][g-1].left+this.__charBounds[d][g-1].width-z}S=w,(this.lineHeight<1||v===d&&this.lineHeight>1)&&(w/=this.lineHeight);let O=n.left+y+T,R=w,B=0,I=M-T;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",R=1,B=w):e.fillStyle=this.selectionColor,o===Ut&&(r===ue||r===Ct||r===Ti?O=this.width-O-I:r===X||r===as?O=n.left+y-M:r!==N&&r!==Oi||(O=n.left+y-M)),e.fillRect(O,n.top+n.topOffset+B,I,R),n.topOffset+=S}}getCurrentCharFontSize(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,pe)}_getCurrentCharIndex(){let e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}};m(un,"ownDefaults",y0),m(un,"type","IText"),k.setClass(un),k.setClass(un,"i-text");var hn=class i extends un{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(e,t){super(e,p(p({},i.ownDefaults),t))}static createControls(){return{controls:Bd()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Ct)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,r=0,o={};for(let s=0;s<e.graphemeLines.length;s++)e.graphemeText[r]===`
`&&s>0?(n=0,r++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[r])&&s>0&&(n++,r++),o[s]={line:t,offset:n},r+=e.graphemeLines[s].length,n+=e.graphemeLines[s].length;return o}styleHas(e,t){if(this._styleMap&&!this.isWrapping){let n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,r=e+1,o=!1,s=this._styleMap[e],a=this._styleMap[e+1];s&&(e=s.line,n=s.offset),a&&(r=a.line,o=r===e,t=a.offset);let l=e===void 0?this.styles:{line:this.styles[e]};for(let c in l)for(let u in l[c]){let h=parseInt(u,10);if(h>=n&&(!o||h<t))for(let d in l[c][u])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){let n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){let r=this._styleMap[e];super._setStyleDeclaration(r.line,r.offset+t,n)}_deleteStyleDeclaration(e,t){let n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){let t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){let t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;let n=this.getGraphemeDataForRender(e),r=[];for(let o=0;o<n.wordsData.length;o++)r.push(...this._wrapLine(o,t,n));return this.isWrapping=!1,r}getGraphemeDataForRender(e){let t=this.splitByGrapheme,n=t?"":" ",r=0;return{wordsData:e.map((o,s)=>{let a=0,l=t?this.graphemeSplit(o):this.wordSplit(o);return l.length===0?[{word:[],width:0}]:l.map(c=>{let u=t?[c]:this.graphemeSplit(c),h=this._measureWord(u,s,a);return r=Math.max(h,r),a+=u.length+n.length,{word:u,width:h}})}),largestWordWidth:r}}_measureWord(e,t){let n,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=0;for(let s=0,a=e.length;s<a;s++)o+=this._getGraphemeBox(e[s],t,s+r,n,!0).kernedWidth,n=e[s];return o}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:r,wordsData:o}=n,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,c=[],u=l?"":" ",h=0,d=[],f=0,g=0,v=!0;t-=s;let y=Math.max(t,r,this.dynamicMinWidth),w=o[e],S;for(f=0,S=0;S<w.length;S++){let{word:T,width:M}=w[S];f+=T.length,h+=g+M-a,h>y&&!v?(c.push(d),d=[],h=M,v=!0):h+=a,v||l||d.push(u),d=d.concat(T),g=l?0:this._measureWord([u],e,f),f++,v=!1}return S&&c.push(d),r+s>this.dynamicMinWidth&&(this.dynamicMinWidth=r-a+s),c}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){let t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=n[o].join("");return t.lines=r,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){let e=new Map;for(let t in this._styleMap){let n=parseInt(t,10);if(this._textLines[n]){let r=this._styleMap[t].line;e.set(`${r}`,!0)}}for(let t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}};m(hn,"type","Textbox"),m(hn,"textLayoutProperties",[...un.textLayoutProperties,"width"]),m(hn,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),k.setClass(hn);var bs=class extends Nr{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){let{target:n}=e,{clipPath:r,group:o}=n;if(!r||!this.shouldPerformLayout(e))return;let{width:s,height:a}=wt(Xd(n,r)),l=new _(s,a);if(r.absolutePositioned)return{center:Vt(r.getRelativeCenterPoint(),void 0,o?o.calcTransformMatrix():void 0),size:l};{let c=r.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){let{center:u=new _,correction:h=new _}=this.calcBoundingBox(t,e)||{};return{center:u.add(c),correction:h.subtract(c),size:l}}return{center:n.getRelativeCenterPoint().add(c),size:l}}}};m(bs,"type","clip-path"),k.setClass(bs);var ys=class extends Nr{getInitialSize(e,t){let{target:n}=e,{size:r}=t;return new _(n.width||r.x,n.height||r.y)}};m(ys,"type","fixed"),k.setClass(ys);var ql=class extends tr{subscribeTargets(e){let t=e.target;e.targets.reduce((n,r)=>(r.parent&&n.add(r.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})})}unsubscribeTargets(e){let t=e.target,n=t.getObjects();e.targets.reduce((r,o)=>(o.parent&&r.add(o.parent),r),new Set).forEach(r=>{!n.some(o=>o.parent===r)&&r.layoutManager.unsubscribeTargets({target:r,targets:[t]})})}},kr=class i extends dn{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,i.ownDefaults),this.setOptions(t);let{left:n,top:r,layoutManager:o}=t;this.groupInit(e,{left:n,top:r,layoutManager:o??new ql})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(r=>{let o=this._objects.findIndex(a=>a.isInFrontOf(r)),s=o===-1?this.size():o;this.insertAt(s,r)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(fn("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);let n=new Set;t.forEach(r=>{let{parent:o}=r;o&&n.add(o)}),e===bc?n.forEach(r=>{r._onAfterObjectsChange(ds,t)}):n.forEach(r=>{r._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return`#<ActiveSelection: (${this.complexity()})>`}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;let r=D(p({hasControls:!1},n),{forActiveSelection:!0});for(let o=0;o<this._objects.length;o++)this._objects[o]._renderControls(e,r);super._renderControls(e,t),e.restore()}};m(kr,"type","ActiveSelection"),m(kr,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),k.setClass(kr),k.setClass(kr,"activeSelection");var Kl=class{constructor(){m(this,"resources",{})}applyFilters(e,t,n,r,o){let s=o.getContext("2d",{willReadFrequently:!0,desynchronized:!0});if(!s)return;s.drawImage(t,0,0,n,r);let a={sourceWidth:n,sourceHeight:r,imageData:s.getImageData(0,0,n,r),originalEl:t,originalImageData:s.getImageData(0,0,n,r),canvasEl:o,ctx:s,filterBackend:this};e.forEach(c=>{c.applyTo(a)});let{imageData:l}=a;return l.width===n&&l.height===r||(o.width=l.width,o.height=l.height),s.putImageData(l,0,0),a}},_s=class{constructor(){let{tileSize:e=H.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),m(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){let n=He({width:e,height:t}),r=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)}applyFilters(e,t,n,r,o,s){let a=this.gl,l=o.getContext("2d");if(!a||!l)return;let c;s&&(c=this.getCachedTexture(s,t));let u={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:r,destinationWidth:n,destinationHeight:r,context:a,sourceTexture:this.createTexture(a,n,r,c?void 0:t),targetTexture:this.createTexture(a,n,r),originalTexture:c||this.createTexture(a,n,r,c?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:o},h=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,h),e.forEach(d=>{d&&d.applyTo(u)}),(function(d){let f=d.targetCanvas,g=f.width,v=f.height,y=d.destinationWidth,w=d.destinationHeight;g===y&&v===w||(f.width=y,f.height=w)})(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(h),l.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,r,o){let{NEAREST:s,TEXTURE_2D:a,RGBA:l,UNSIGNED_BYTE:c,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:h,TEXTURE_MIN_FILTER:d,TEXTURE_WRAP_S:f,TEXTURE_WRAP_T:g}=e,v=e.createTexture();return e.bindTexture(a,v),e.texParameteri(a,h,o||s),e.texParameteri(a,d,o||s),e.texParameteri(a,f,u),e.texParameteri(a,g,u),r?e.texImage2D(a,0,l,l,c,r):e.texImage2D(a,0,l,t,n,0,l,c,null),v}getCachedTexture(e,t,n){let{textureCache:r}=this;if(r[e])return r[e];{let o=this.createTexture(this.gl,t.width,t.height,t,n);return o&&(r[e]=o),o}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){let n=e.canvas,r=t.targetCanvas,o=r.getContext("2d");if(!o)return;o.translate(0,r.height),o.scale(1,-1);let s=n.height-r.height;o.drawImage(n,0,s,r.width,r.height,0,0,r.width,r.height)}copyGLTo2DPutImageData(e,t){let n=t.targetCanvas.getContext("2d"),r=t.destinationWidth,o=t.destinationHeight,s=r*o*4;if(!n)return;let a=new Uint8Array(this.imageBuffer,0,s),l=new Uint8ClampedArray(this.imageBuffer,0,s);e.readPixels(0,0,r,o,e.RGBA,e.UNSIGNED_BYTE,a);let c=new ImageData(l,r,o);n.putImageData(c,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;let e=this.gl,t={renderer:"",vendor:""};if(!e)return t;let n=e.getExtension("WEBGL_debug_renderer_info");if(n){let r=e.getParameter(n.UNMASKED_RENDERER_WEBGL),o=e.getParameter(n.UNMASKED_VENDOR_WEBGL);r&&(t.renderer=r.toLowerCase()),o&&(t.vendor=o.toLowerCase())}return this.gpuInfo=t,t}},gl;function _0(){let{WebGLProbe:i}=St();return i.queryWebGL(Dt()),H.enableGLFiltering&&i.isSupported(H.textureSize)?new _s({tileSize:H.textureSize}):new Kl}function pl(){return!gl&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(gl=_0()),gl}var yf=["cropX","cropY"],ot=class i extends me{static getDefaults(){return p(p({},super.getDefaults()),i.ownDefaults)}constructor(e,t){super(),m(this,"_lastScaleX",1),m(this,"_lastScaleY",1),m(this,"_filterScalingX",1),m(this,"_filterScalingY",1),this.filters=[],Object.assign(this,i.ownDefaults),this.setOptions(t),this.cacheKey=`texture${pn()}`,this.setElement(typeof e=="string"?(this.canvas&&st(this.canvas.getElement())||Vr()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._element=e,this._originalElement=e,this._setWidthHeight(t),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){let t=pl(!1);t instanceof _s&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{let t=this[e];t&&St().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){let e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;let t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=[];return this.filters.forEach(n=>{n&&t.push(n.toObject())}),p(D(p({},super.toObject([...yf,...e])),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t}),this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){let e=[],t=this._element,n=-this.width/2,r=-this.height/2,o=[],s=[],a="",l="";if(!t)return[];if(this.hasCrop()){let c=pn();o.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+n+'" y="'+r+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(l=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",`xlink:href="${this.getSvgSrc(!0)}" x="${n-this.cropX}" y="${r-this.cropY}" width="${t.width||t.naturalWidth}" height="${t.height||t.naturalHeight}"${l}${a}></image>
`),this.stroke||this.strokeDashArray){let c=this.fill;this.fill=null,s=[`	<rect x="${n}" y="${r}" width="${this.width}" height="${this.height}" style="${this.getSvgStyles()}" />
`],this.fill=c}return o=this.paintFirst!==pe?o.concat(s,e):o.concat(e,s),o}getSrc(e){let t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ei(e,{crossOrigin:t,signal:n}).then(r=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(r)})}toString(){return`#<Image: { src: "${this.getSrc()}" }>`}applyResizeFilters(){let e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),r=n.x,o=n.y,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||r>t&&o>t)return this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=o);let a=He(s),{width:l,height:c}=s;this._element=a,this._lastScaleX=e.scaleX=r,this._lastScaleY=e.scaleY=o,pl().applyFilters([e],s,l,c,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(o=>o&&!o.isNeutralState()),this.set("dirty",!0),this.removeTexture(`${this.cacheKey}_filtered`),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);let t=this._originalElement,n=t.naturalWidth||t.width,r=t.naturalHeight||t.height;if(this._element===this._originalElement){let o=He({width:n,height:r});this._element=o,this._filteredEl=o}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,r),this._lastScaleX=1,this._lastScaleY=1);pl().applyFilters(e,this._originalElement,n,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){let t=this._element;if(!t)return;let n=this._filterScalingX,r=this._filterScalingY,o=this.width,s=this.height,a=Math.max(this.cropX,0),l=Math.max(this.cropY,0),c=t.naturalWidth||t.width,u=t.naturalHeight||t.height,h=a*n,d=l*r,f=Math.min(o*n,c-h),g=Math.min(s*r,u-d),v=-o/2,y=-s/2,w=Math.min(o,c/n-a),S=Math.min(s,u/r-l);t&&e.drawImage(t,h,d,f,g,v,y,w,S)}_needsResize(){let e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){let e=vd(this.preserveAspectRatio||""),t=this.width,n=this.height,r={width:t,height:n},o,s=this._element.width,a=this._element.height,l=1,c=1,u=0,h=0,d=0,f=0;return!e||e.alignX===Re&&e.alignY===Re?(l=t/s,c=n/a):(e.meetOrSlice==="meet"&&(l=c=Kd(this._element,r),o=(t-s*l)/2,e.alignX==="Min"&&(u=-o),e.alignX==="Max"&&(u=o),o=(n-a*c)/2,e.alignY==="Min"&&(h=-o),e.alignY==="Max"&&(h=o)),e.meetOrSlice==="slice"&&(l=c=Zd(this._element,r),o=s-t/l,e.alignX==="Mid"&&(d=o/2),e.alignX==="Max"&&(d=o),o=a-n/c,e.alignY==="Mid"&&(f=o/2),e.alignY==="Max"&&(f=o),s=t/l,a=n/c)),{width:s,height:a,scaleX:l,scaleY:c,offsetLeft:u,offsetTop:h,cropX:d,cropY:f}}static fromObject(e,t){let c=e,{filters:n,resizeFilter:r,src:o,crossOrigin:s,type:a}=c,l=te(c,["filters","resizeFilter","src","crossOrigin","type"]);return Promise.all([Ei(o,D(p({},t),{crossOrigin:s})),n&&Lr(n,t),r?Lr([r],t):[],Ni(l,t)]).then(u=>{let[h,d=[],[f],g={}]=u;return new this(h,p(D(p({},l),{src:o,filters:d,resizeFilter:f}),g))})}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return Ei(e,{crossOrigin:t,signal:n}).then(o=>new this(o,r))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=Ht(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(r["xlink:href"]||r.href,t,r).catch(o=>(fn("log","Unable to parse Image",o),null))}};m(ot,"type","Image"),m(ot,"cacheProperties",[...zt,...yf]),m(ot,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),m(ot,"ATTRIBUTE_NAMES",[...vn,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),k.setClass(ot),k.setSVGClass(ot);var EC=Os(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);var Is=i=>i.webgl!==void 0;var Cc="precision highp float",C0=`
    ${Cc};
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`,w0=new RegExp(Cc,"g"),ae=class{get type(){return this.constructor.type}constructor(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{type:e}=n,t=te(n,["type"]);Object.assign(this,this.constructor.defaults,t)}getFragmentSource(){return C0}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource(),{WebGLProbe:{GLPrecision:r="highp"}}=St();r!=="highp"&&(t=t.replace(w0,Cc.replace("highp",r)));let o=e.createShader(e.VERTEX_SHADER),s=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!o||!s||!a)throw new et("Vertex, fragment shader or program creation error");if(e.shaderSource(o,n),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new et(`Vertex shader compile error for ${this.type}: ${e.getShaderInfoLog(o)}`);if(e.shaderSource(s,t),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new et(`Fragment shader compile error for ${this.type}: ${e.getShaderInfoLog(s)}`);if(e.attachShader(a,o),e.attachShader(a,s),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new et(`Shader link error for "${this.type}" ${e.getProgramInfoLog(a)}`);let l=this.getUniformLocations(e,a)||{};return l.uStepW=e.getUniformLocation(a,"uStepW"),l.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:l}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){let n=this.constructor.uniformLocations,r={};for(let o=0;o<n.length;o++)r[n[o]]=e.getUniformLocation(t,n[o]);return r}sendAttributeData(e,t,n){let r=t.aPosition,o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){let t=e.context;if(e.passes>1){let n=e.destinationWidth,r=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===r||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,r)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;let t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){Is(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){let t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){let t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){let{sourceWidth:t,sourceHeight:n}=e,r=He({width:t,height:n});e.helpLayer=r}}toObject(){let e=Object.keys(this.constructor.defaults||{});return p({type:this.type},e.reduce((t,n)=>(t[n]=this[n],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){let o=e,{type:n}=o,r=te(o,["type"]);return new this(r)}};m(ae,"type","BaseFilter"),m(ae,"uniformLocations",[]);var x0={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `},Ln=class extends ae{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          ${x0[this.mode]}
        }
      }
      `}applyTo2d(e){let{imageData:{data:t}}=e,n=new Le(this.color).getSource(),r=this.alpha,o=n[0]*r,s=n[1]*r,a=n[2]*r,l=1-r;for(let c=0;c<t.length;c+=4){let u=t[c],h=t[c+1],d=t[c+2],f,g,v;switch(this.mode){case"multiply":f=u*o/255,g=h*s/255,v=d*a/255;break;case"screen":f=255-(255-u)*(255-o)/255,g=255-(255-h)*(255-s)/255,v=255-(255-d)*(255-a)/255;break;case"add":f=u+o,g=h+s,v=d+a;break;case"difference":f=Math.abs(u-o),g=Math.abs(h-s),v=Math.abs(d-a);break;case"subtract":f=u-o,g=h-s,v=d-a;break;case"darken":f=Math.min(u,o),g=Math.min(h,s),v=Math.min(d,a);break;case"lighten":f=Math.max(u,o),g=Math.max(h,s),v=Math.max(d,a);break;case"overlay":f=o<128?2*u*o/255:255-2*(255-u)*(255-o)/255,g=s<128?2*h*s/255:255-2*(255-h)*(255-s)/255,v=a<128?2*d*a/255:255-2*(255-d)*(255-a)/255;break;case"exclusion":f=o+u-2*o*u/255,g=s+h-2*s*h/255,v=a+d-2*a*d/255;break;case"tint":f=o+u*l,g=s+h*l,v=a+d*l}t[c]=f,t[c+1]=g,t[c+2]=v}}sendUniformData(e,t){let n=new Le(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}};m(Ln,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),m(Ln,"type","BlendColor"),m(Ln,"uniformLocations",["uColor"]),k.setClass(Ln);var S0={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},Un=class extends ae{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return S0[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){let t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){let e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:r},filterBackend:{resources:o}}=e,s=this.image;o.blendImage||(o.blendImage=Dt());let a=o.blendImage,l=a.getContext("2d");a.width!==n||a.height!==r?(a.width=n,a.height=r):l.clearRect(0,0,n,r),l.setTransform(s.scaleX,0,0,s.scaleY,s.left,s.top),l.drawImage(s.getElement(),0,0,n,r);let c=l.getImageData(0,0,n,r).data;for(let u=0;u<t.length;u+=4){let h=t[u],d=t[u+1],f=t[u+2],g=t[u+3],v=c[u],y=c[u+1],w=c[u+2],S=c[u+3];switch(this.mode){case"multiply":t[u]=h*v/255,t[u+1]=d*y/255,t[u+2]=f*w/255,t[u+3]=g*S/255;break;case"mask":t[u+3]=S}}}sendUniformData(e,t){let n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return D(p({},super.toObject()),{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let s=e,{type:n,image:r}=s,o=te(s,["type","image"]);return ot.fromObject(r,t).then(a=>new this(D(p({},o),{image:a})))}};m(Un,"type","BlendImage"),m(Un,"defaults",{mode:"multiply",alpha:1}),m(Un,"uniformLocations",["uTransformMatrix","uImage"]),k.setClass(Un);var jn=class extends ae{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){Is(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:n,height:r}}=e;this.aspectRatio=n/r,this.horizontal=!0;let o=this.getBlurValue()*n,s=new Uint8ClampedArray(t),a=15,l=4*n;for(let c=0;c<t.length;c+=4){let u=0,h=0,d=0,f=0,g=0,v=c-c%l,y=v+l;for(let w=-14;w<a;w++){let S=w/a,T=4*Math.floor(o*S),M=1-Math.abs(S),O=c+T;O<v?O=v:O>y&&(O=y);let R=t[O+3]*M;u+=t[O]*R,h+=t[O+1]*R,d+=t[O+2]*R,f+=R,g+=M}s[c]=u/f,s[c+1]=h/f,s[c+2]=d/f,s[c+3]=f/g}this.horizontal=!1,o=this.getBlurValue()*r;for(let c=0;c<s.length;c+=4){let u=0,h=0,d=0,f=0,g=0,v=c%l,y=s.length-l+v;for(let w=-14;w<a;w++){let S=w/a,T=Math.floor(o*S)*l,M=1-Math.abs(S),O=c+T;O<v?O=v:O>y&&(O=y);let R=s[O+3]*M;u+=s[O]*R,h+=s[O+1]*R,d+=s[O+2]*R,f+=R,g+=M}t[c]=u/f,t[c+1]=h/f,t[c+2]=d/f,t[c+3]=f/g}}sendUniformData(e,t){let n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1,{horizontal:t,aspectRatio:n}=this;return t?n>1&&(e=1/n):n<1&&(e=n),e*this.blur*.12}chooseRightDelta(){let e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}};m(jn,"type","Blur"),m(jn,"defaults",{blur:0}),m(jn,"uniformLocations",["uDelta"]),k.setClass(jn);var Nn=class extends ae{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e,n=Math.round(255*this.brightness);for(let r=0;r<t.length;r+=4)t[r]+=n,t[r+1]+=n,t[r+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}};m(Nn,"type","Brightness"),m(Nn,"defaults",{brightness:0}),m(Nn,"uniformLocations",["uBrightness"]),k.setClass(Nn);var _f={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0},Nt=class extends ae{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){let t=e.imageData.data,n=this.matrix,r=this.colorsOnly;for(let o=0;o<t.length;o+=4){let s=t[o],a=t[o+1],l=t[o+2];if(t[o]=s*n[0]+a*n[1]+l*n[2]+255*n[4],t[o+1]=s*n[5]+a*n[6]+l*n[7]+255*n[9],t[o+2]=s*n[10]+a*n[11]+l*n[12]+255*n[14],!r){let c=t[o+3];t[o]+=c*n[3],t[o+1]+=c*n[8],t[o+2]+=c*n[13],t[o+3]=s*n[15]+a*n[16]+l*n[17]+c*n[18]+255*n[19]}}}sendUniformData(e,t){let n=this.matrix,r=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],o=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,r),e.uniform4fv(t.uConstants,o)}toObject(){return D(p({},super.toObject()),{matrix:[...this.matrix]})}};function ir(i,e){var t;let n=(m(t=class extends Nt{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",i),m(t,"defaults",{colorsOnly:!1,matrix:e}),t);return k.setClass(n,i),n}m(Nt,"type","ColorMatrix"),m(Nt,"defaults",_f),m(Nt,"uniformLocations",["uColorMatrix","uConstants"]),k.setClass(Nt);var D0=ir("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),M0=ir("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),E0=ir("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),T0=ir("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),O0=ir("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),A0=ir("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),k0=ir("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]),Ui=class extends ae{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Is(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(n=>k.getClass(n.type).fromObject(n,t))).then(n=>new this({subFilters:n}))}};m(Ui,"type","Composed"),k.setClass(Ui);var Bn=class extends ae{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e,n=Math.floor(255*this.contrast),r=259*(n+255)/(255*(259-n));for(let o=0;o<t.length;o+=4)t[o]=r*(t[o]-128)+128,t[o+1]=r*(t[o+1]-128)+128,t[o+2]=r*(t[o+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}};m(Bn,"type","Contrast"),m(Bn,"defaults",{contrast:0}),m(Bn,"uniformLocations",["uContrast"]),k.setClass(Bn);var F0={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `},Vn=class extends ae{getCacheKey(){return`${this.type}_${Math.sqrt(this.matrix.length)}_${this.opaque?1:0}`}getFragmentSource(){return F0[this.getCacheKey()]}applyTo2d(e){let t=e.imageData,n=t.data,r=this.matrix,o=Math.round(Math.sqrt(r.length)),s=Math.floor(o/2),a=t.width,l=t.height,c=e.ctx.createImageData(a,l),u=c.data,h=this.opaque?1:0,d,f,g,v,y,w,S,T,M,O,R,B,I;for(R=0;R<l;R++)for(O=0;O<a;O++){for(y=4*(R*a+O),d=0,f=0,g=0,v=0,I=0;I<o;I++)for(B=0;B<o;B++)S=R+I-s,w=O+B-s,S<0||S>=l||w<0||w>=a||(T=4*(S*a+w),M=r[I*o+B],d+=n[T]*M,f+=n[T+1]*M,g+=n[T+2]*M,h||(v+=n[T+3]*M));u[y]=d,u[y+1]=f,u[y+2]=g,u[y+3]=h?n[y+3]:v}e.imageData=c}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return D(p({},super.toObject()),{opaque:this.opaque,matrix:[...this.matrix]})}};m(Vn,"type","Convolute"),m(Vn,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),m(Vn,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),k.setClass(Vn);var Cf="Gamma",zn=class extends ae{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e,n=this.gamma,r=1/n[0],o=1/n[1],s=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});let a=this.rgbValues;for(let l=0;l<256;l++)a.r[l]=255*Math.pow(l/255,r),a.g[l]=255*Math.pow(l/255,o),a.b[l]=255*Math.pow(l/255,s);for(let l=0;l<t.length;l+=4)t[l]=a.r[t[l]],t[l+1]=a.g[t[l+1]],t[l+2]=a.b[t[l+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){let{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:Cf,gamma:this.gamma.concat()}}};m(zn,"type",Cf),m(zn,"defaults",{gamma:[1,1,1]}),m(zn,"uniformLocations",["uGamma"]),k.setClass(zn);var P0={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `},$n=class extends ae{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,r=0;r<t.length;r+=4){let o=t[r],s=t[r+1],a=t[r+2];switch(this.mode){case"average":n=(o+s+a)/3;break;case"lightness":n=(Math.min(o,s,a)+Math.max(o,s,a))/2;break;case"luminosity":n=.21*o+.72*s+.07*a}t[r+2]=t[r+1]=t[r]=n}}getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return P0[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}};m($n,"type","Grayscale"),m($n,"defaults",{mode:"average"}),m($n,"uniformLocations",["uMode"]),k.setClass($n);var I0=D(p({},_f),{rotation:0}),Pr=class extends Nt{calculateMatrix(){let e=this.rotation*Math.PI,t=ut(e),n=ht(e),r=1/3,o=Math.sqrt(r)*n,s=1-t;this.matrix=[t+s/3,r*s-o,r*s+o,0,0,r*s+o,t+r*s,r*s-o,0,0,r*s-o,r*s+o,t+r*s,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}};m(Pr,"type","HueRotation"),m(Pr,"defaults",I0),k.setClass(Pr);var Hn=class extends ae{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}};m(Hn,"type","Invert"),m(Hn,"defaults",{alpha:!1,invert:!0}),m(Hn,"uniformLocations",["uInvert","uAlpha"]),k.setClass(Hn);var Gn=class extends ae{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e,n=this.noise;for(let r=0;r<t.length;r+=4){let o=(.5-Math.random())*n;t[r]+=o,t[r+1]+=o,t[r+2]+=o}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}};m(Gn,"type","Noise"),m(Gn,"defaults",{noise:0}),m(Gn,"uniformLocations",["uNoise","uSeed"]),k.setClass(Gn);var Wn=class extends ae{applyTo2d(e){let{imageData:{data:t,width:n,height:r}}=e;for(let o=0;o<r;o+=this.blocksize)for(let s=0;s<n;s+=this.blocksize){let a=4*o*n+4*s,l=t[a],c=t[a+1],u=t[a+2],h=t[a+3];for(let d=o;d<Math.min(o+this.blocksize,r);d++)for(let f=s;f<Math.min(s+this.blocksize,n);f++){let g=4*d*n+4*f;t[g]=l,t[g+1]=c,t[g+2]=u,t[g+3]=h}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}};m(Wn,"type","Pixelate"),m(Wn,"defaults",{blocksize:4}),m(Wn,"uniformLocations",["uBlocksize"]),k.setClass(Wn);var Yn=class extends ae{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e,n=255*this.distance,r=new Le(this.color).getSource(),o=[r[0]-n,r[1]-n,r[2]-n],s=[r[0]+n,r[1]+n,r[2]+n];for(let a=0;a<t.length;a+=4){let l=t[a],c=t[a+1],u=t[a+2];l>o[0]&&c>o[1]&&u>o[2]&&l<s[0]&&c<s[1]&&u<s[2]&&(t[a+3]=0)}}sendUniformData(e,t){let n=new Le(this.color).getSource(),r=this.distance,o=[0+n[0]/255-r,0+n[1]/255-r,0+n[2]/255-r,1],s=[n[0]/255+r,n[1]/255+r,n[2]/255+r,1];e.uniform4fv(t.uLow,o),e.uniform4fv(t.uHigh,s)}};m(Yn,"type","RemoveColor"),m(Yn,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),m(Yn,"uniformLocations",["uLow","uHigh"]),k.setClass(Yn);var Xn=class extends ae{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){let e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){let e=this.getFilterWindow();return`${this.type}_${e}`}getFragmentSource(){let e=this.getFilterWindow();return this.generateShader(e)}getTaps(){let e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),r=new Array(n);for(let o=1;o<=n;o++)r[o-1]=e(o*t);return r}generateShader(e){let t=new Array(e);for(let n=1;n<=e;n++)t[n-1]=`${n}.0 * uDelta`;return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[${e}];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        ${t.map((n,r)=>`
              color += texture2D(uTexture, vTexCoord + ${n}) * uTaps[${r}] + texture2D(uTexture, vTexCoord - ${n}) * uTaps[${r}];
              sum += 2.0 * uTaps[${r}];
            `).join(`
`)}
        gl_FragColor = color / sum;
      }
    `}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Is(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;let n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){let t=e.imageData,n=this.scaleX,r=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/r;let o=t.width,s=t.height,a=Math.round(o*n),l=Math.round(s*r),c;c=this.resizeType==="sliceHack"?this.sliceByTwo(e,o,s,a,l):this.resizeType==="hermite"?this.hermiteFastResize(e,o,s,a,l):this.resizeType==="bilinear"?this.bilinearFiltering(e,o,s,a,l):this.resizeType==="lanczos"?this.lanczosResize(e,o,s,a,l):new ImageData(a,l),e.imageData=c}sliceByTwo(e,t,n,r,o){let s=e.imageData,a=.5,l=!1,c=!1,u=t*a,h=n*a,d=e.filterBackend.resources,f=0,g=0,v=t,y=0;d.sliceByTwo||(d.sliceByTwo=Dt());let w=d.sliceByTwo;(w.width<1.5*t||w.height<n)&&(w.width=1.5*t,w.height=n);let S=w.getContext("2d");for(S.clearRect(0,0,1.5*t,n),S.putImageData(s,0,0),r=Math.floor(r),o=Math.floor(o);!l||!c;)t=u,n=h,r<Math.floor(u*a)?u=Math.floor(u*a):(u=r,l=!0),o<Math.floor(h*a)?h=Math.floor(h*a):(h=o,c=!0),S.drawImage(w,f,g,t,n,v,y,u,h),f=v,g=y,y+=h;return S.getImageData(f,g,r,o)}lanczosResize(e,t,n,r,o){let s=e.imageData.data,a=e.ctx.createImageData(r,o),l=a.data,c=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,h=this.rcpScaleY,d=2/this.rcpScaleX,f=2/this.rcpScaleY,g=Math.ceil(u*this.lanczosLobes/2),v=Math.ceil(h*this.lanczosLobes/2),y={},w={x:0,y:0},S={x:0,y:0};return(function T(M){let O,R,B,I,z,le,ce,q,J,G,ve;for(w.x=(M+.5)*u,S.x=Math.floor(w.x),O=0;O<o;O++){for(w.y=(O+.5)*h,S.y=Math.floor(w.y),z=0,le=0,ce=0,q=0,J=0,R=S.x-g;R<=S.x+g;R++)if(!(R<0||R>=t)){G=Math.floor(1e3*Math.abs(R-w.x)),y[G]||(y[G]={});for(let fe=S.y-v;fe<=S.y+v;fe++)fe<0||fe>=n||(ve=Math.floor(1e3*Math.abs(fe-w.y)),y[G][ve]||(y[G][ve]=c(Math.sqrt(Math.pow(G*d,2)+Math.pow(ve*f,2))/1e3)),B=y[G][ve],B>0&&(I=4*(fe*t+R),z+=B,le+=B*s[I],ce+=B*s[I+1],q+=B*s[I+2],J+=B*s[I+3]))}I=4*(O*r+M),l[I]=le/z,l[I+1]=ce/z,l[I+2]=q/z,l[I+3]=J/z}return++M<r?T(M):a})(0)}bilinearFiltering(e,t,n,r,o){let s,a,l,c,u,h,d,f,g,v,y,w,S,T=0,M=this.rcpScaleX,O=this.rcpScaleY,R=4*(t-1),B=e.imageData.data,I=e.ctx.createImageData(r,o),z=I.data;for(d=0;d<o;d++)for(f=0;f<r;f++)for(u=Math.floor(M*f),h=Math.floor(O*d),g=M*f-u,v=O*d-h,S=4*(h*t+u),y=0;y<4;y++)s=B[S+y],a=B[S+4+y],l=B[S+R+y],c=B[S+R+4+y],w=s*(1-g)*(1-v)+a*g*(1-v)+l*v*(1-g)+c*g*v,z[T++]=w;return I}hermiteFastResize(e,t,n,r,o){let s=this.rcpScaleX,a=this.rcpScaleY,l=Math.ceil(s/2),c=Math.ceil(a/2),u=e.imageData.data,h=e.ctx.createImageData(r,o),d=h.data;for(let f=0;f<o;f++)for(let g=0;g<r;g++){let v=4*(g+f*r),y=0,w=0,S=0,T=0,M=0,O=0,R=0,B=(f+.5)*a;for(let I=Math.floor(f*a);I<(f+1)*a;I++){let z=Math.abs(B-(I+.5))/c,le=(g+.5)*s,ce=z*z;for(let q=Math.floor(g*s);q<(g+1)*s;q++){let J=Math.abs(le-(q+.5))/l,G=Math.sqrt(ce+J*J);G>1&&G<-1||(y=2*G*G*G-3*G*G+1,y>0&&(J=4*(q+I*t),R+=y*u[J+3],S+=y,u[J+3]<255&&(y=y*u[J+3]/250),T+=y*u[J],M+=y*u[J+1],O+=y*u[J+2],w+=y))}}d[v]=T/w,d[v+1]=M/w,d[v+2]=O/w,d[v+3]=R/S}return h}};m(Xn,"type","Resize"),m(Xn,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),m(Xn,"uniformLocations",["uDelta","uTaps"]),k.setClass(Xn);var qn=class extends ae{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e,n=-this.saturation;for(let r=0;r<t.length;r+=4){let o=t[r],s=t[r+1],a=t[r+2],l=Math.max(o,s,a);t[r]+=l!==o?(l-o)*n:0,t[r+1]+=l!==s?(l-s)*n:0,t[r+2]+=l!==a?(l-a)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}};m(qn,"type","Saturation"),m(qn,"defaults",{saturation:0}),m(qn,"uniformLocations",["uSaturation"]),k.setClass(qn);var Kn=class extends ae{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e,n=-this.vibrance;for(let r=0;r<t.length;r+=4){let o=t[r],s=t[r+1],a=t[r+2],l=Math.max(o,s,a),c=(o+s+a)/3,u=2*Math.abs(l-c)/255*n;t[r]+=l!==o?(l-o)*u:0,t[r+1]+=l!==s?(l-s)*u:0,t[r+2]+=l!==a?(l-a)*u:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}};m(Kn,"type","Vibrance"),m(Kn,"defaults",{vibrance:0}),m(Kn,"uniformLocations",["uVibrance"]),k.setClass(Kn);var bn=Object.freeze({__proto__:null,BaseFilter:ae,BlackWhite:k0,BlendColor:Ln,BlendImage:Un,Blur:jn,Brightness:Nn,Brownie:D0,ColorMatrix:Nt,Composed:Ui,Contrast:Bn,Convolute:Vn,Gamma:zn,Grayscale:$n,HueRotation:Pr,Invert:Hn,Kodachrome:E0,Noise:Gn,Pixelate:Wn,Polaroid:O0,RemoveColor:Yn,Resize:Xn,Saturation:qn,Sepia:A0,Technicolor:T0,Vibrance:Kn,Vintage:M0});var Mt=class i{canvas;history=[];historyStep=-1;isHistoryLoading=!1;selectedObject=re(null);objects=re([]);canvasState=re(null);zoomLevel=re(1);isCropping=re(!1);isDrawingMode=re(!1);brushSize=re(10);brushColor=re("#000000");isErasing=re(!1);eraserSize=re(10);canvasColor=re("#ffffff");layersCount=re(0);cropOverlay=null;cropTarget=null;constructor(){}initCanvas(e){this.canvas=new Br(e,{width:1200,height:675,backgroundColor:"#ffffff",preserveObjectStacking:!0}),this.setupEvents(),this.setupZoomEvents(),this.setupKeyboardEvents(),this.refreshState(),this.saveState()}toggleDrawingMode(e){let t=e!==void 0?e:!this.isDrawingMode();this.isDrawingMode.set(t),t?(this.toggleEraser(!1),this.canvas.discardActiveObject(),this.canvas.isDrawingMode=!0,this.canvas.freeDrawingBrush||(this.canvas.freeDrawingBrush=new Li(this.canvas)),this.canvas.freeDrawingBrush.width=this.brushSize(),this.canvas.freeDrawingBrush.color=this.brushColor(),this.canvas.freeDrawingBrush.globalCompositeOperation="source-over"):this.canvas.isDrawingMode=!1,this.canvas.renderAll()}updateBrushSize(e){this.brushSize.set(e),this.isDrawingMode()&&this.canvas.freeDrawingBrush&&(this.canvas.freeDrawingBrush.width=e)}updateBrushColor(e){this.brushColor.set(e),this.isDrawingMode()&&this.canvas.freeDrawingBrush&&(this.canvas.freeDrawingBrush.color=e)}toggleEraser(e){let t=e!==void 0?e:!this.isErasing();if(this.isErasing.set(t),t){this.toggleDrawingMode(!1),this.canvas.discardActiveObject(),this.canvas.isDrawingMode=!0;let n=new Li(this.canvas);n.width=this.eraserSize(),this.canvas.freeDrawingBrush=n,this.canvas.freeDrawingBrush.globalCompositeOperation="destination-out",this.canvas.defaultCursor="crosshair"}else this.canvas.isDrawingMode=!1,this.canvas.defaultCursor="default";this.canvas.renderAll()}updateEraserSize(e){this.eraserSize.set(e),this.isErasing()&&this.canvas.freeDrawingBrush&&(this.canvas.freeDrawingBrush.width=e)}setupKeyboardEvents(){window.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="z"?(e.shiftKey?this.redo():this.undo(),e.preventDefault()):(e.ctrlKey||e.metaKey)&&e.key==="y"&&(this.redo(),e.preventDefault())})}setupZoomEvents(){this.canvas.on("mouse:wheel",e=>{if(!e.e.ctrlKey)return;let t=e.e.deltaY,n=this.canvas.getZoom();n*=.999**t,n>20&&(n=20),n<.01&&(n=.01),this.canvas.setZoom(n),this.zoomLevel.set(n),e.e.preventDefault(),e.e.stopPropagation()})}setupEvents(){this.canvas.on("object:added",()=>{this.isHistoryLoading||(this.refreshState(),this.saveState())}),this.canvas.on("object:removed",()=>{this.isHistoryLoading||(this.refreshState(),this.saveState())});let e=()=>{this.refreshState(),this.triggerSelectedUpdate()};this.canvas.on("object:modified",()=>{e(),this.isHistoryLoading||this.saveState()}),this.canvas.on("object:moving",e),this.canvas.on("object:scaling",t=>{let n=t.target;if(n&&n.type==="textbox"){let r=n;r.set({fontSize:r.fontSize*r.scaleX,scaleX:1,scaleY:1})}e()}),this.canvas.on("object:rotating",e),this.canvas.on("selection:created",t=>{this.selectedObject.set(t.selected?.[0]||null),this.refreshState()}),this.canvas.on("selection:updated",t=>{this.selectedObject.set(t.selected?.[0]||null),this.refreshState()}),this.canvas.on("selection:cleared",()=>{this.selectedObject.set(null),this.refreshState()})}triggerSelectedUpdate(){let e=this.canvas.getActiveObject();e&&(this.selectedObject.set(null),this.selectedObject.set(e))}refreshState(){let e=this.canvas.getObjects();this.objects.set([...e]),this.layersCount.set(e.length)}saveState(){if(this.isHistoryLoading)return;let e=JSON.stringify(this.canvas.toJSON());this.historyStep++,this.history=this.history.slice(0,this.historyStep),this.history.push(e)}undo(){if(this.historyStep>0){this.isHistoryLoading=!0,this.historyStep--;let e=this.history[this.historyStep];this.canvas.loadFromJSON(e).then(()=>{this.canvas.renderAll(),this.refreshState(),this.isHistoryLoading=!1})}}redo(){if(this.historyStep<this.history.length-1){this.isHistoryLoading=!0,this.historyStep++;let e=this.history[this.historyStep];this.canvas.loadFromJSON(e).then(()=>{this.canvas.renderAll(),this.refreshState(),this.isHistoryLoading=!1})}}loadTemplate(e){this.isHistoryLoading=!0,this.canvas.discardActiveObject();let t=JSON.parse(JSON.stringify(e));Ps.enlivenObjects(t.objects).then(n=>{n.forEach(r=>{r.set({selectable:!0,evented:!0}),this.canvas.add(r)}),this.canvas.renderAll(),this.refreshState(),this.isHistoryLoading=!1,this.saveState()})}resizeCanvas(e,t){this.canvas.setDimensions({width:e,height:t}),this.canvas.renderAll(),this.saveState()}addText(e="New Text",t={}){let n=new hn(e,p({left:100,top:100,width:200,fontSize:32,fill:"#7c3aed",fontFamily:"Inter"},t));this.canvas.add(n),this.canvas.centerObject(n),this.canvas.setActiveObject(n),this.canvas.renderAll()}addShape(e){let t,n={left:100,top:100,fill:"transparent",stroke:"#000000",strokeWidth:2,width:100,height:100};if(e==="rect")t=new Be(D(p({},n),{rx:10,ry:10}));else if(e==="circle")t=new _t(D(p({},n),{radius:50}));else if(e==="triangle")t=new ln(n);else if(["hexagon","pentagon","octagon"].includes(e)){let r=e==="hexagon"?6:e==="pentagon"?5:8,o=[];for(let s=0;s<r;s++){let a=Math.PI*2/r*s;o.push({x:Math.cos(a)*50,y:Math.sin(a)*50})}t=new cn(o,n)}else t=new Be(n);this.canvas.add(t),this.canvas.centerObject(t),this.canvas.setActiveObject(t),this.canvas.renderAll()}addImage(e){ot.fromURL(e).then(t=>{let n=this.canvas.width||1200,r=Math.min(300/(t.width||1),1);t.scale(r),this.canvas.add(t),this.canvas.centerObject(t),this.canvas.setActiveObject(t),this.canvas.renderAll()})}updateProperty(e,t){let n=this.canvas.getActiveObject();n&&(n.set(e,t),this.canvas.renderAll(),this.refreshState(),this.saveState())}alignObject(e){let t=this.canvas.getActiveObject();if(!t)return;t.setCoords();let n=t.getBoundingRect(),r=this.canvas.width,o=this.canvas.height;e==="left"?t.set({left:t.left-n.left}):e==="center"?this.canvas.centerObjectH(t):e==="right"?t.set({left:t.left+(r-(n.left+n.width))}):e==="top"?t.set({top:t.top-n.top}):e==="middle"?this.canvas.centerObjectV(t):e==="bottom"&&t.set({top:t.top+(o-(n.top+n.height))}),t.setCoords(),this.canvas.renderAll(),this.refreshState(),this.saveState()}deleteObject(e){(e?[e]:this.canvas.getActiveObjects()).forEach(n=>this.canvas.remove(n)),this.canvas.discardActiveObject(),this.canvas.renderAll(),this.refreshState(),this.saveState()}setCanvasBg(e){this.canvasColor.set(e),this.canvas.set({backgroundColor:e}),this.canvas.renderAll(),this.saveState()}clearCanvas(){this.canvas.clear(),this.canvas.set({backgroundColor:"#ffffff"}),this.canvasColor.set("#ffffff"),this.canvas.renderAll(),this.refreshState(),this.saveState()}resetCanvas(){this.clearCanvas()}deleteSelected(){let e=this.canvas.getActiveObjects();e.length&&(e.forEach(t=>this.canvas.remove(t)),this.canvas.discardActiveObject(),this.canvas.renderAll(),this.refreshState(),this.saveState())}flip(e){let t=this.canvas.getActiveObject();t&&(e==="h"?t.set("flipX",!t.flipX):t.set("flipY",!t.flipY),this.canvas.renderAll())}applyFilter(e){let t=this.canvas.getActiveObject();if(t&&t.type==="image"){let n=t;n.filters=[],e==="Grayscale"?n.filters.push(new bn.Grayscale):e==="Invert"?n.filters.push(new bn.Invert):e==="Sepia"&&n.filters.push(new bn.Sepia),n.applyFilters(),this.canvas.renderAll(),this.saveState()}}applyTextEffect(e){let t=this.canvas.getActiveObject();if(!(!t||t.type!=="textbox")){if(e==="outline")t.set({stroke:"#000000",strokeWidth:2});else if(e==="gradient"){let n=new an({type:"linear",coords:{x1:0,y1:0,x2:t.getScaledWidth(),y2:0},colorStops:[{offset:0,color:"#7c3aed"},{offset:1,color:"#3b82f6"}]});t.set({fill:n})}else e==="shadow"&&t.set({shadow:new xt({color:"rgba(0,0,0,0.5)",blur:10,offsetX:5,offsetY:5})});this.canvas.renderAll(),this.saveState()}}cropSelection(){let e=this.canvas.getActiveObject();e&&e.type==="image"&&this.startCrop(e)}startCrop(e){this.isCropping.set(!0),this.cropTarget=e,this.cropOverlay=new Be({left:e.left,top:e.top,width:e.getScaledWidth(),height:e.getScaledHeight(),fill:"rgba(255, 255, 255, 0.2)",stroke:"#7c3aed",strokeWidth:2,strokeDashArray:[5,5],cornerColor:"white",cornerStrokeColor:"#7c3aed",cornerSize:12,transparentCorners:!1,angle:e.angle}),this.canvas.add(this.cropOverlay),this.canvas.setActiveObject(this.cropOverlay),this.canvas.renderAll()}applyCrop(){if(!this.cropTarget||!this.cropOverlay)return;let e=this.cropTarget,t=this.cropOverlay,n=new _(t.left,t.top),r=Ps.invertTransform(e.calcTransformMatrix()),o=Ps.transformPoint(n,r),s={x:o.x+e.width/2,y:o.y+e.height/2},a=Math.abs(e.scaleX||1),l=Math.abs(e.scaleY||1);e.set({cropX:(e.cropX||0)+s.x,cropY:(e.cropY||0)+s.y,width:t.getScaledWidth()/a,height:t.getScaledHeight()/l,left:t.left,top:t.top}),this.cancelCrop(),this.canvas.renderAll(),this.saveState()}cancelCrop(){this.cropOverlay&&this.canvas.remove(this.cropOverlay),this.cropOverlay=null,this.cropTarget=null,this.isCropping.set(!1),this.canvas.renderAll()}exportToImage(e){let t=this.canvas.toDataURL({format:e,multiplier:2}),n=document.createElement("a");n.download=`design.${e}`,n.href=t,n.click()}setActiveObject(e){this.canvas.setActiveObject(e),this.canvas.renderAll(),this.selectedObject.set(e)}setZoom(e){this.canvas.setZoom(e),this.zoomLevel.set(e),this.canvas.renderAll()}zoomIn(){let e=this.canvas.getZoom()*1.1;this.setZoom(e)}zoomOut(){let e=this.canvas.getZoom()/1.1;this.setZoom(e)}clipboard;copy(){let e=this.canvas.getActiveObject();e&&e.clone().then(t=>{this.clipboard=t})}paste(){this.clipboard&&this.clipboard.clone().then(e=>{this.canvas.discardActiveObject(),e.set({left:e.left+10,top:e.top+10,evented:!0}),this.canvas.add(e),this.canvas.setActiveObject(e),this.canvas.requestRenderAll(),this.refreshState()})}toggleVisibility(e){e.set("visible",!e.visible),this.canvas.renderAll(),this.refreshState(),this.saveState()}toggleLock(e){let t=!e.lockMovementX;e.set({lockMovementX:t,lockMovementY:t,lockRotation:t,lockScalingX:t,lockScalingY:t,hasControls:!t}),this.canvas.renderAll(),this.refreshState(),this.saveState()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})};function R0(i,e){if(i&1){let t=Ue();b(0,"div",25)(1,"button",26),E("click",function(){L(t);let r=P();return r.addRect(),U(r.closeMenus())}),b(2,"span",7),x(3,"rectangle"),C(),x(4," Rect"),C(),b(5,"button",26),E("click",function(){L(t);let r=P();return r.addCircle(),U(r.closeMenus())}),b(6,"span",7),x(7,"circle"),C(),x(8," Circle"),C(),b(9,"button",26),E("click",function(){L(t);let r=P();return r.addTriangle(),U(r.closeMenus())}),b(10,"span",7),x(11,"change_history"),C(),x(12," Triangle"),C(),b(13,"button",26),E("click",function(){L(t);let r=P();return r.addHexagon(),U(r.closeMenus())}),b(14,"span",7),x(15,"pentagon"),C(),x(16," Hexagon"),C(),b(17,"button",26),E("click",function(){L(t);let r=P();return r.addPentagon(),U(r.closeMenus())}),b(18,"span",7),x(19,"pentagon"),C(),x(20," Pentagon"),C(),b(21,"button",26),E("click",function(){L(t);let r=P();return r.addOctagon(),U(r.closeMenus())}),b(22,"span",7),x(23,"pentagon"),C(),x(24," Octagon"),C(),b(25,"button",26),E("click",function(){L(t);let r=P();return r.addStar(),U(r.closeMenus())}),b(26,"span",7),x(27,"star"),C(),x(28," Star"),C(),b(29,"button",26),E("click",function(){L(t);let r=P();return r.addHeart(),U(r.closeMenus())}),b(30,"span",7),x(31,"favorite"),C(),x(32," Heart"),C(),b(33,"button",26),E("click",function(){L(t);let r=P();return r.addArrow(),U(r.closeMenus())}),b(34,"span",7),x(35,"arrow_forward"),C(),x(36," Arrow"),C(),b(37,"button",26),E("click",function(){L(t);let r=P();return r.addCloud(),U(r.closeMenus())}),b(38,"span",7),x(39,"cloud"),C(),x(40," Cloud"),C()()}}var Rs=class i{bannerService=A(Mt);activeMenu=null;toggleMenu(e){this.activeMenu=this.activeMenu===e?null:e}closeMenus(){this.activeMenu=null}addText(){this.bannerService.addText()}triggerUpload(){document.getElementById("imageUpload").click()}uploadImage(e){let t=e.target.files[0];if(t){let n=new FileReader;n.onload=r=>{this.bannerService.addImage(r.target.result)},n.readAsDataURL(t)}}addRect(){this.bannerService.addShape("rect")}addCircle(){this.bannerService.addShape("circle")}addTriangle(){this.bannerService.addShape("triangle")}addHexagon(){this.bannerService.addShape("hexagon")}addPentagon(){this.bannerService.addShape("pentagon")}addOctagon(){this.bannerService.addShape("octagon")}addStar(){this.bannerService.addShape("star")}addHeart(){this.bannerService.addShape("heart")}addArrow(){this.bannerService.addShape("arrow")}addCloud(){this.bannerService.addShape("cloud")}toggleDrawingMode(){this.bannerService.toggleDrawingMode()}toggleEraser(){this.bannerService.toggleEraser()}setSelectMode(){this.bannerService.toggleDrawingMode(!1),this.bannerService.toggleEraser(!1)}undo(){this.bannerService.undo()}redo(){this.bannerService.redo()}startNewDesign(){this.bannerService.clearCanvas()}downloadPNG(){this.bannerService.exportToImage("png")}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Me({type:i,selectors:[["app-toolbar"]],decls:61,vars:9,consts:[[1,"navbar-wrapper"],[1,"logo-group"],[1,"logo-pill"],[1,"material-symbols-outlined","logo-icon"],[1,"brand-name"],[1,"main-tools-pill"],["title","Select (V)",1,"nav-tool-btn",3,"click"],[1,"material-symbols-outlined"],[1,"tool-label"],[1,"divider"],["title","Brush Tool (B)",1,"nav-tool-btn",3,"click"],["title","Eraser Tool (E)",1,"nav-tool-btn",3,"click"],["title","Add Text (T)",1,"nav-tool-btn",3,"click"],["title","Upload Image (U)",1,"nav-tool-btn",3,"click"],[1,"dropdown-wrapper"],[1,"nav-tool-btn",3,"click"],[1,"material-symbols-outlined","arrow"],["class","dropdown-menu",4,"ngIf"],[1,"action-group"],["title","Undo (Ctrl+Z)",1,"action-btn",3,"click"],["title","Redo (Ctrl+Y)",1,"action-btn",3,"click"],[1,"v-divider"],[1,"create-btn",3,"click"],[1,"download-btn",3,"click"],["type","file","id","imageUpload","accept","image/*",2,"display","none",3,"change"],[1,"dropdown-menu"],[3,"click"]],template:function(t,n){t&1&&(b(0,"header",0)(1,"div",1)(2,"div",2)(3,"span",3),x(4,"b_mobiledata"),C()(),b(5,"div",4),x(6,"Banner"),b(7,"span"),x(8,"Studio"),C()()(),b(9,"div",5)(10,"button",6),E("click",function(){return n.setSelectMode()}),b(11,"span",7),x(12,"near_me"),C(),b(13,"span",8),x(14,"Select"),C()(),Pe(15,"div",9),b(16,"button",10),E("click",function(){return n.toggleDrawingMode()}),b(17,"span",7),x(18,"brush"),C(),b(19,"span",8),x(20,"Brush"),C()(),b(21,"button",11),E("click",function(){return n.toggleEraser()}),b(22,"span",7),x(23,"ink_eraser"),C(),b(24,"span",8),x(25,"Eraser"),C()(),Pe(26,"div",9),b(27,"button",12),E("click",function(){return n.addText()}),b(28,"span",7),x(29,"title"),C(),b(30,"span",8),x(31,"Text"),C()(),b(32,"button",13),E("click",function(){return n.triggerUpload()}),b(33,"span",7),x(34,"image"),C(),b(35,"span",8),x(36,"Image"),C()(),b(37,"div",14)(38,"button",15),E("click",function(){return n.toggleMenu("shapes")}),b(39,"span",7),x(40,"category"),C(),b(41,"span",8),x(42,"Shapes"),C(),b(43,"span",16),x(44,"expand_more"),C()(),At(45,R0,41,0,"div",17),C()(),b(46,"div",18)(47,"button",19),E("click",function(){return n.undo()}),b(48,"span",7),x(49,"undo"),C()(),b(50,"button",20),E("click",function(){return n.redo()}),b(51,"span",7),x(52,"redo"),C()(),Pe(53,"div",21),b(54,"button",22),E("click",function(){return n.startNewDesign()}),x(55,"New Design"),C(),b(56,"button",23),E("click",function(){return n.downloadPNG()}),b(57,"span",7),x(58,"download"),C(),x(59," Download "),C()(),b(60,"input",24),E("change",function(o){return n.uploadImage(o)}),C()()),t&2&&(F(10),Z("active",!n.bannerService.isDrawingMode()&&!n.bannerService.isErasing()),F(6),Z("active",n.bannerService.isDrawingMode()),F(5),Z("active",n.bannerService.isErasing()),F(17),Z("active",n.activeMenu==="shapes"),F(7),he("ngIf",n.activeMenu==="shapes"))},dependencies:[mt,ti],styles:['@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Outfit;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqQ4E.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Outfit;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtq.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Outfit;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqQ4E.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Outfit;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtq.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.toolbar-container[_ngcontent-%COMP%]{height:56px;background:#fff;border-bottom:1px solid #e5e7eb;display:flex;align-items:center;justify-content:space-between;padding:0 16px;font-family:Inter,sans-serif;z-index:1001}.toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;width:260px}.brand-logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.brand-logo[_ngcontent-%COMP%]   .v-divider[_ngcontent-%COMP%]{width:1px;height:24px;background:#fff3;margin:0 4px}.brand-logo[_ngcontent-%COMP%]   .dropdown-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.brand-logo[_ngcontent-%COMP%]   .dropdown-wrapper[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 12px);left:50%;transform:translate(-50%);background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;padding:8px;display:grid;grid-template-columns:repeat(2,1fr);gap:4px;z-index:1000;min-width:200px}.brand-logo[_ngcontent-%COMP%]   .dropdown-wrapper[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-6px;left:50%;transform:translate(-50%) rotate(45deg);width:12px;height:12px;background:#fff;border-left:1px solid #e5e7eb;border-top:1px solid #e5e7eb}.brand-logo[_ngcontent-%COMP%]   .dropdown-wrapper[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;background:transparent;border:none;border-radius:6px;color:#374151;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;white-space:nowrap}.brand-logo[_ngcontent-%COMP%]   .dropdown-wrapper[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:18px;color:#6b7280}.brand-logo[_ngcontent-%COMP%]   .dropdown-wrapper[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f5f3ff;color:#7c3aed}.brand-logo[_ngcontent-%COMP%]   .dropdown-wrapper[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover   .material-symbols-outlined[_ngcontent-%COMP%]{color:#7c3aed}.brand-logo[_ngcontent-%COMP%]   .logo-icon-box[_ngcontent-%COMP%]{width:32px;height:32px;background:#7c3aed;color:#fff;border-radius:6px;display:flex;align-items:center;justify-content:center;font-family:Outfit,sans-serif;font-weight:700;font-size:18px}.brand-logo[_ngcontent-%COMP%]   .brand-name[_ngcontent-%COMP%]{font-family:Outfit,sans-serif;font-size:16px;font-weight:700;color:#111827}.toolbar-center[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex:1}.tool-group.horizontal[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;background:#f3f4f6;padding:4px;border-radius:999px}.nav-tool-btn[_ngcontent-%COMP%]{height:36px;padding:0 16px;display:flex;align-items:center;gap:8px;background:transparent;border:none;border-radius:999px;color:#6b7280;cursor:pointer;transition:all .2s}.nav-tool-btn[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:18px}.nav-tool-btn[_ngcontent-%COMP%]   .tool-label[_ngcontent-%COMP%]{font-size:12px;font-weight:600}.nav-tool-btn[_ngcontent-%COMP%]:hover:not(:disabled){color:#111827}.nav-tool-btn.active[_ngcontent-%COMP%]{background:#fff;color:#7c3aed;box-shadow:0 2px 4px #0000000d}.nav-tool-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.toolbar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;width:260px;justify-content:flex-end}.btn-outline[_ngcontent-%COMP%]{height:36px;padding:0 14px;display:flex;align-items:center;gap:8px;background:#fff;border:1px solid #e5e7eb;border-radius:8px;color:#111827;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s}.btn-outline[_ngcontent-%COMP%]:hover{background:#f9fafb}.btn-primary[_ngcontent-%COMP%]{height:36px;padding:0 14px;display:flex;align-items:center;gap:8px;background:#7c3aed;border:none;border-radius:8px;color:#fff;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]:hover{background:#6d28d9}.hidden[_ngcontent-%COMP%]{display:none}']})};var kf=(()=>{class i{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,n){this._renderer=t,this._elementRef=n}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(n){return new(n||i)(ie(fr),ie(hr))};static \u0275dir=ge({type:i})}return i})(),Wi=(()=>{class i extends kf{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ot(i)))(r||i)}})();static \u0275dir=ge({type:i,features:[pt]})}return i})(),Yr=new K("");var L0={provide:Yr,useExisting:_n(()=>Xr),multi:!0};function U0(){let i=qe()?qe().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var j0=new K(""),Xr=(()=>{class i extends kf{_compositionMode;_composing=!1;constructor(t,n,r){super(t,n),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!U0())}writeValue(t){let n=t??"";this.setProperty("value",n)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(n){return new(n||i)(ie(fr),ie(hr),ie(j0,8))};static \u0275dir=ge({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){n&1&&E("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Jt([L0]),pt]})}return i})();var N0=new K(""),B0=new K("");function Ff(i){return i!=null}function Pf(i){return Qr(i)?Ye(i):i}function If(i){let e={};return i.forEach(t=>{e=t!=null?p(p({},e),t):e}),Object.keys(e).length===0?null:e}function Rf(i,e){return e.map(t=>t(i))}function V0(i){return!i.validate}function Lf(i){return i.map(e=>V0(e)?e:t=>e.validate(t))}function z0(i){if(!i)return null;let e=i.filter(Ff);return e.length==0?null:function(t){return If(Rf(t,e))}}function Uf(i){return i!=null?z0(Lf(i)):null}function $0(i){if(!i)return null;let e=i.filter(Ff);return e.length==0?null:function(t){let n=Rf(t,e).map(Pf);return jc(n).pipe(ye(If))}}function jf(i){return i!=null?$0(Lf(i)):null}function xf(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function H0(i){return i._rawValidators}function G0(i){return i._rawAsyncValidators}function wc(i){return i?Array.isArray(i)?i:[i]:[]}function js(i,e){return Array.isArray(i)?i.includes(e):i===e}function Sf(i,e){let t=wc(e);return wc(i).forEach(r=>{js(t,r)||t.push(r)}),t}function Df(i,e){return wc(e).filter(t=>!js(i,t))}var Ns=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Uf(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=jf(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},xc=class extends Ns{name;get formDirective(){return null}get path(){return null}},Gi=class extends Ns{_parent=null;name=null;valueAccessor=null},Sc=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var Vs=(()=>{class i extends Sc{constructor(t){super(t)}static \u0275fac=function(n){return new(n||i)(ie(Gi,2))};static \u0275dir=ge({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){n&2&&Z("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[pt]})}return i})();var Vi="VALID",Us="INVALID",Gr="PENDING",zi="DISABLED",or=class{},Bs=class extends or{value;source;constructor(e,t){super(),this.value=e,this.source=t}},$i=class extends or{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Hi=class extends or{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Wr=class extends or{status;source;constructor(e,t){super(),this.status=e,this.source=t}};var Dc=class extends or{source;constructor(e){super(),this.source=e}};function W0(i){return(zs(i)?i.validators:i)||null}function Y0(i){return Array.isArray(i)?Uf(i):i||null}function X0(i,e){return(zs(e)?e.asyncValidators:i)||null}function q0(i){return Array.isArray(i)?jf(i):i||null}function zs(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}var Mc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return De(this.statusReactive)}set status(e){De(()=>this.statusReactive.set(e))}_status=Sn(()=>this.statusReactive());statusReactive=re(void 0);get valid(){return this.status===Vi}get invalid(){return this.status===Us}get pending(){return this.status==Gr}get disabled(){return this.status===zi}get enabled(){return this.status!==zi}errors;get pristine(){return De(this.pristineReactive)}set pristine(e){De(()=>this.pristineReactive.set(e))}_pristine=Sn(()=>this.pristineReactive());pristineReactive=re(!0);get dirty(){return!this.pristine}get touched(){return De(this.touchedReactive)}set touched(e){De(()=>this.touchedReactive.set(e))}_touched=Sn(()=>this.touchedReactive());touchedReactive=re(!1);get untouched(){return!this.touched}_events=new ft;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Sf(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Sf(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Df(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Df(e,this._rawAsyncValidators))}hasValidator(e){return js(this._rawValidators,e)}hasAsyncValidator(e){return js(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(D(p({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new Hi(!0,n))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:n})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n),t&&e.emitEvent!==!1&&this._events.next(new Hi(!1,n))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(D(p({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new $i(!1,n))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),t&&e.emitEvent!==!1&&this._events.next(new $i(!0,n))}markAsPending(e={}){this.status=Gr;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Wr(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(D(p({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=zi,this.errors=null,this._forEachChild(r=>{r.disable(D(p({},e),{onlySelf:!0}))}),this._updateValue();let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Bs(this.value,n)),this._events.next(new Wr(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(D(p({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Vi,this._forEachChild(n=>{n.enable(D(p({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(D(p({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Vi||this.status===Gr)&&this._runAsyncValidator(n,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Bs(this.value,t)),this._events.next(new Wr(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(D(p({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?zi:Vi}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Gr,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let n=Pf(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,n){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||n)&&this._events.next(new Wr(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,n)}_initObservables(){this.valueChanges=new gt,this.statusChanges=new gt}_calculateStatus(){return this._allControlsDisabled()?zi:this.errors?Us:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Gr)?Gr:this._anyControlsHaveStatus(Us)?Us:Vi}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new $i(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Hi(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){zs(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Y0(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=q0(this._rawAsyncValidators)}};var Nf=new K("",{factory:()=>Tc}),Tc="always";function K0(i,e){return[...e.path,i]}function Z0(i,e,t=Tc){Q0(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),ev(i,e),nv(i,e),tv(i,e),J0(i,e)}function Mf(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function J0(i,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function Q0(i,e){let t=H0(i);e.validator!==null?i.setValidators(xf(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let n=G0(i);e.asyncValidator!==null?i.setAsyncValidators(xf(n,e.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();Mf(e._rawValidators,r),Mf(e._rawAsyncValidators,r)}function ev(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&Bf(i,e)})}function tv(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&Bf(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function Bf(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function nv(i,e){let t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function rv(i,e){if(!i.hasOwnProperty("model"))return!1;let t=i.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function iv(i){return Object.getPrototypeOf(i.constructor)===Wi}function ov(i,e){if(!e)return null;Array.isArray(e);let t,n,r;return e.forEach(o=>{o.constructor===Xr?t=o:iv(o)?n=o:r=o}),r||n||t||null}function Ef(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function Tf(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var sv=class extends Mc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,n){super(W0(t),X0(n,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),zs(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Tf(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Dc(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Ef(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Ef(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Tf(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var av={provide:Gi,useExisting:_n(()=>Yi)},Of=Promise.resolve(),Yi=(()=>{class i extends Gi{_changeDetectorRef;callSetDisabledState;control=new sv;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new gt;constructor(t,n,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=ov(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),rv(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Z0(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Of.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let n=t.isDisabled.currentValue,r=n!==0&&ua(n);Of.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?K0(t,this._parent):[t]}static \u0275fac=function(n){return new(n||i)(ie(xc,9),ie(N0,10),ie(B0,10),ie(Yr,10),ie(gr,8),ie(Nf,8))};static \u0275dir=ge({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Jt([av]),pt,Zr]})}return i})();var lv={provide:Yr,useExisting:_n(()=>Oc),multi:!0},Oc=(()=>{class i extends Wi{writeValue(t){let n=t??"";this.setProperty("value",n)}registerOnChange(t){this.onChange=n=>{t(n==""?null:parseFloat(n))}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ot(i)))(r||i)}})();static \u0275dir=ge({type:i,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,r){n&1&&E("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Jt([lv]),pt]})}return i})();var cv={provide:Yr,useExisting:_n(()=>Ac),multi:!0},Ac=(()=>{class i extends Wi{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=n=>{t(n==""?null:parseFloat(n))}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ot(i)))(r||i)}})();static \u0275dir=ge({type:i,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,r){n&1&&E("change",function(s){return r.onChange(s.target.value)})("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Jt([cv]),pt]})}return i})();var uv={provide:Yr,useExisting:_n(()=>$s),multi:!0};function Vf(i,e){return i==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${i}: ${e}`.slice(0,50))}function hv(i){return i.split(":")[0]}var $s=(()=>{class i extends Wi{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=A(oo).injector;destroyRef=A(Kr);cdr=A(gr);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,ro({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let n=this._getOptionId(t),r=Vf(n,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){let n=hv(t);return this._optionMap.has(n)?this._optionMap.get(n):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ot(i)))(r||i)}})();static \u0275dir=ge({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,r){n&1&&E("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Jt([uv]),pt]})}return i})(),zf=(()=>{class i{_element;_renderer;_select;id;constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(Vf(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(n){return new(n||i)(ie(hr),ie(fr),ie($s,9))};static \u0275dir=ge({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return i})(),dv={provide:Yr,useExisting:_n(()=>$f),multi:!0};function Af(i,e){return i==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${i}: ${e}`.slice(0,50))}function fv(i){return i.split(":")[0]}var $f=(()=>{class i extends Wi{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let n;if(Array.isArray(t)){let r=t.map(o=>this._getOptionId(o));n=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else n=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{let r=[],o=n.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let l=s[a],c=this._getOptionValue(l.value);r.push(c)}}else{let s=n.options;for(let a=0;a<s.length;a++){let l=s[a];if(l.selected){let c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,t(r)}}_registerOption(t){let n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){let n=fv(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ot(i)))(r||i)}})();static \u0275dir=ge({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,r){n&1&&E("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Jt([dv]),pt]})}return i})(),Hf=(()=>{class i{_element;_renderer;_select;id;_value;constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(Af(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Af(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(n){return new(n||i)(ie(hr),ie(fr),ie($f,9))};static \u0275dir=ge({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return i})();var gv=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=_e({})}return i})();var Hs=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:Nf,useValue:t.callSetDisabledState??Tc}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=_e({imports:[gv]})}return i})();var yn=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=_e({})}return i})();var Gs=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=_e({imports:[yn]})}return i})();var Wf=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=_e({imports:[yn]})}return i})();var Yf=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=_e({imports:[yn]})}return i})();var Xf=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=_e({imports:[Yf,yn]})}return i})();var vv=(i,e)=>e.value;function bv(i,e){if(i&1&&(b(0,"option",19),x(1),C()),i&2){let t=e.$implicit;he("value",t.value),F(),kt(t.name)}}function yv(i,e){if(i&1){let t=Ue();b(0,"details",3)(1,"summary")(2,"span",4),x(3,"match_case"),C(),b(4,"span"),x(5,"Typography"),C(),b(6,"span",5),x(7,"expand_more"),C()(),b(8,"div",6)(9,"div",10)(10,"label"),x(11,"Fonts"),C(),b(12,"div",17)(13,"select",18),It("ngModelChange",function(r){L(t);let o=P();return Pt(o.selectedFont,r)||(o.selectedFont=r),U(r)}),E("change",function(){L(t);let r=P();return U(r.onPropertyChange("fontFamily",r.selectedFont))}),la(14,bv,2,2,"option",19,vv),C(),b(16,"span",20),x(17,"expand_more"),C()()(),b(18,"div",21)(19,"div",22)(20,"label"),x(21,"Size"),C(),b(22,"div",23)(23,"input",24),It("ngModelChange",function(r){L(t);let o=P();return Pt(o.fontSize,r)||(o.fontSize=r),U(r)}),E("input",function(){L(t);let r=P();return U(r.onPropertyChange("fontSize",r.fontSize))}),C(),b(24,"span"),x(25,"px"),C()()(),b(26,"div",22)(27,"label"),x(28,"Color"),C(),b(29,"div",11)(30,"input",25),It("ngModelChange",function(r){L(t);let o=P();return Pt(o.textColor,r)||(o.textColor=r),U(r)}),E("input",function(){L(t);let r=P();return U(r.onPropertyChange("fill",r.textColor))}),C()()()(),b(31,"div",10)(32,"label"),x(33,"Alignment"),C(),b(34,"div",26)(35,"button",27),E("click",function(){L(t);let r=P();return U(r.align("left"))}),b(36,"span",20),x(37,"format_align_left"),C()(),b(38,"button",28),E("click",function(){L(t);let r=P();return U(r.align("center"))}),b(39,"span",20),x(40,"format_align_center"),C()(),b(41,"button",29),E("click",function(){L(t);let r=P();return U(r.align("right"))}),b(42,"span",20),x(43,"format_align_right"),C()()()(),b(44,"div",30)(45,"div",26)(46,"button",31),E("click",function(){L(t);let r=P();return U(r.toggleStyle("bold"))}),b(47,"span",20),x(48,"format_bold"),C()(),b(49,"button",32),E("click",function(){L(t);let r=P();return U(r.toggleStyle("italic"))}),b(50,"span",20),x(51,"format_italic"),C()(),b(52,"button",33),E("click",function(){L(t);let r=P();return U(r.toggleStyle("underline"))}),b(53,"span",20),x(54,"format_underlined"),C()()()(),b(55,"div",10)(56,"div",34)(57,"label"),x(58,"Letter Spacing"),C(),b(59,"span"),x(60),C()(),b(61,"input",35),It("ngModelChange",function(r){L(t);let o=P();return Pt(o.charSpacing,r)||(o.charSpacing=r),U(r)}),E("input",function(){L(t);let r=P();return U(r.onPropertyChange("charSpacing",r.charSpacing))}),C()(),b(62,"div",10)(63,"div",34)(64,"label"),x(65,"Line Height"),C(),b(66,"span"),x(67),C()(),b(68,"input",36),It("ngModelChange",function(r){L(t);let o=P();return Pt(o.lineHeight,r)||(o.lineHeight=r),U(r)}),E("input",function(){L(t);let r=P();return U(r.onPropertyChange("lineHeight",r.lineHeight))}),C()()()()}if(i&2){let t=P();F(13),Ft("ngModel",t.selectedFont),F(),ca(t.fontFamilies),F(9),Ft("ngModel",t.fontSize),F(6),wn("background-color",t.textColor),F(),Ft("ngModel",t.textColor),F(5),Z("active",(t.currentObject==null?null:t.currentObject.textAlign)==="left"),F(3),Z("active",(t.currentObject==null?null:t.currentObject.textAlign)==="center"),F(3),Z("active",(t.currentObject==null?null:t.currentObject.textAlign)==="right"),F(5),Z("active",(t.currentObject==null?null:t.currentObject.fontWeight)==="bold"),F(3),Z("active",(t.currentObject==null?null:t.currentObject.fontStyle)==="italic"),F(3),Z("active",t.currentObject==null?null:t.currentObject.underline),F(8),kt(t.charSpacing),F(),Ft("ngModel",t.charSpacing),F(6),kt(t.lineHeight),F(),Ft("ngModel",t.lineHeight)}}function _v(i,e){if(i&1){let t=Ue();b(0,"div")(1,"div",10)(2,"label"),x(3,"Brush Color"),C(),b(4,"div",11)(5,"input",12),E("ngModelChange",function(r){L(t);let o=P();return U(o.bannerService.updateBrushColor(r))}),C()()(),b(6,"div",10)(7,"div",34)(8,"label"),x(9,"Brush Size"),C(),b(10,"span"),x(11),C()(),b(12,"input",37),E("ngModelChange",function(r){L(t);let o=P();return U(o.bannerService.updateBrushSize(r))}),C()()()}if(i&2){let t=P();F(4),wn("background-color",t.bannerService.brushColor()),F(),he("ngModel",t.bannerService.brushColor()),F(6),xn("",t.bannerService.brushSize(),"px"),F(),he("ngModel",t.bannerService.brushSize())}}function Cv(i,e){if(i&1){let t=Ue();b(0,"div")(1,"div",10)(2,"div",34)(3,"label"),x(4,"Eraser Size"),C(),b(5,"span"),x(6),C()(),b(7,"input",37),E("ngModelChange",function(r){L(t);let o=P();return U(o.bannerService.updateEraserSize(r))}),C()()()}if(i&2){let t=P();F(6),xn("",t.bannerService.eraserSize(),"px"),F(),he("ngModel",t.bannerService.eraserSize())}}function wv(i,e){if(i&1){let t=Ue();b(0,"div",10)(1,"label"),x(2,"Fill Color"),C(),b(3,"div",11)(4,"input",25),It("ngModelChange",function(r){L(t);let o=P(2);return Pt(o.fillColor,r)||(o.fillColor=r),U(r)}),E("input",function(){L(t);let r=P(2);return U(r.onPropertyChange("fill",r.fillColor))}),C()()()}if(i&2){let t=P(2);F(3),wn("background-color",t.fillColor),F(),Ft("ngModel",t.fillColor)}}function xv(i,e){if(i&1){let t=Ue();b(0,"div"),At(1,wv,5,3,"div",38),b(2,"div",10)(3,"div",34)(4,"label"),x(5,"Opacity"),C(),b(6,"span"),x(7),C()(),b(8,"input",39),It("ngModelChange",function(r){L(t);let o=P();return Pt(o.opacity,r)||(o.opacity=r),U(r)}),E("input",function(){L(t);let r=P();return U(r.onPropertyChange("opacity",r.opacity/100))}),C()()()}if(i&2){let t=P();F(),he("ngIf",t.currentObject.type!=="image"),F(6),xn("",t.opacity,"%"),F(),Ft("ngModel",t.opacity)}}function Sv(i,e){if(i&1){let t=Ue();b(0,"details",9)(1,"summary")(2,"span",4),x(3,"auto_fix_high"),C(),b(4,"span"),x(5,"Text Effects"),C(),b(6,"span",5),x(7,"expand_more"),C()(),b(8,"div",6)(9,"div",40)(10,"button",41),E("click",function(){L(t);let r=P();return U(r.applyEffect("gradient"))}),b(11,"span",20),x(12,"gradient"),C(),b(13,"span"),x(14,"Gradient"),C()(),b(15,"button",41),E("click",function(){L(t);let r=P();return U(r.applyEffect("outline"))}),b(16,"span",20),x(17,"format_paragraph_spacing"),C(),b(18,"span"),x(19,"Outline"),C()(),b(20,"button",41),E("click",function(){L(t);let r=P();return U(r.applyEffect("shadow"))}),b(21,"span",20),x(22,"layers"),C(),b(23,"span"),x(24,"Shadow"),C()()()()()}}function Dv(i,e){if(i&1){let t=Ue();b(0,"details",9)(1,"summary")(2,"span",4),x(3,"image_search"),C(),b(4,"span"),x(5,"Image Tools"),C(),b(6,"span",5),x(7,"expand_more"),C()(),b(8,"div",6)(9,"div",10)(10,"label"),x(11,"Filters"),C(),b(12,"div",42)(13,"button",43),E("click",function(){L(t);let r=P();return U(r.applyFilter("None"))}),b(14,"span"),x(15,"None"),C()(),b(16,"button",43),E("click",function(){L(t);let r=P();return U(r.applyFilter("Grayscale"))}),b(17,"span",20),x(18,"filter_b_and_w"),C()(),b(19,"button",43),E("click",function(){L(t);let r=P();return U(r.applyFilter("Invert"))}),b(20,"span",20),x(21,"invert_colors"),C()(),b(22,"button",43),E("click",function(){L(t);let r=P();return U(r.applyFilter("Sepia"))}),b(23,"span",20),x(24,"filter_vintage"),C()()()(),b(25,"div",44)(26,"button",14),E("click",function(){L(t);let r=P();return U(r.crop())}),x(27,"Crop Selection"),C()(),b(28,"div",10)(29,"div",34)(30,"label"),x(31,"Rotate"),C(),b(32,"span"),x(33),C()(),b(34,"input",45),It("ngModelChange",function(r){L(t);let o=P();return Pt(o.angle,r)||(o.angle=r),U(r)}),E("input",function(){L(t);let r=P();return U(r.onPropertyChange("angle",r.angle))}),C()(),b(35,"div",30)(36,"button",43),E("click",function(){L(t);let r=P();return U(r.flip("h"))}),b(37,"span",20),x(38,"flip"),C(),b(39,"span"),x(40,"Flip H"),C()(),b(41,"button",43),E("click",function(){L(t);let r=P();return U(r.flip("v"))}),b(42,"span",46),x(43,"flip"),C(),b(44,"span"),x(45,"Flip V"),C()()()()()}if(i&2){let t=P();F(13),Z("active",t.currentFilter==="None"),F(3),Z("active",t.currentFilter==="Grayscale"),F(3),Z("active",t.currentFilter==="Invert"),F(3),Z("active",t.currentFilter==="Sepia"),F(11),xn("",t.angle,"\xB0"),F(),Ft("ngModel",t.angle)}}function Mv(i,e){if(i&1){let t=Ue();b(0,"div",47),E("click",function(){let r=L(t).$implicit,o=P();return U(o.selectLayer(r))}),b(1,"span",48),x(2),C(),b(3,"span",49),x(4),C(),b(5,"div",50)(6,"button",51),E("click",function(r){let o=L(t).$implicit;return P().toggleVisibility(o),U(r.stopPropagation())}),b(7,"span",20),x(8),C()(),b(9,"button",51),E("click",function(r){let o=L(t).$implicit;return P().deleteLayer(o),U(r.stopPropagation())}),b(10,"span",20),x(11,"delete"),C()()()()}if(i&2){let t=e.$implicit,n=P();Z("active",n.selectedObject()===t),F(2),kt(n.getLayerIcon(t.type||"")),F(2),kt(n.getLayerName(t)),F(4),kt(t.visible?"visibility":"visibility_off")}}var Ws=class i{bannerService=A(Mt);selectedFont="Inter";fontSize=32;textColor="#1a1a1a";fillColor="#ffffff";opacity=100;textAlign="left";charSpacing=0;lineHeight=1.2;currentFilter="None";angle=0;fontFamilies=[{name:"Inter Sans",value:"Inter"},{name:"Poppins",value:"Poppins"},{name:"Outfit",value:"Outfit"},{name:"Roboto",value:"Roboto"},{name:"Playfair Display",value:"Playfair Display"},{name:"Montserrat",value:"Montserrat"},{name:"Pacifico",value:"Pacifico"}];selectedObject=this.bannerService.selectedObject;canvasObjects=this.bannerService.objects;constructor(){Wc(()=>{let e=this.selectedObject();if(e&&(this.opacity=Math.round((e.opacity||1)*100),this.angle=Math.round(e.angle||0),e.type==="textbox"?(this.selectedFont=e.fontFamily||"Inter",this.fontSize=Math.round(e.fontSize||32),this.textColor=typeof e.fill=="string"?e.fill:"#1a1a1a",this.textAlign=e.textAlign||"left",this.charSpacing=(e.charSpacing||0)/10,this.lineHeight=e.lineHeight||1.16):this.fillColor=typeof e.fill=="string"?e.fill:"#ffffff",e.type==="image")){let n=e.filters?.[0];n instanceof bn.Grayscale?this.currentFilter="Grayscale":n instanceof bn.Invert?this.currentFilter="Invert":n instanceof bn.Sepia?this.currentFilter="Sepia":this.currentFilter="None"}})}get currentObject(){return this.selectedObject()}onPropertyChange(e,t){e==="charSpacing"?this.bannerService.updateProperty(e,t*10):this.bannerService.updateProperty(e,t)}addShape(e){this.bannerService.addShape(e)}toggleStyle(e){let t=this.currentObject;if(t)if(e==="bold"){let n=t.fontWeight==="bold"?"normal":"bold";this.onPropertyChange("fontWeight",n)}else if(e==="italic"){let n=t.fontStyle==="italic"?"normal":"italic";this.onPropertyChange("fontStyle",n)}else e==="underline"&&this.onPropertyChange("underline",!t.underline)}align(e){this.bannerService.alignObject(e)}selectLayer(e){this.bannerService.setActiveObject(e)}deleteLayer(e){this.bannerService.deleteObject(e)}toggleVisibility(e){this.bannerService.toggleVisibility(e)}toggleLock(e){this.bannerService.toggleLock(e)}getLayerIcon(e){switch(e){case"textbox":return"title";case"image":return"image";case"rect":return"rectangle";case"circle":return"circle";case"triangle":return"change_history";case"polygon":return"pentagon";default:return"layers"}}getLayerName(e){return e.type==="textbox"?e.text||"Text":e.type.charAt(0).toUpperCase()+e.type.slice(1)}crop(){this.bannerService.cropSelection()}flip(e){this.bannerService.flip(e)}applyFilter(e){this.currentFilter=e,this.bannerService.applyFilter(e)}applyEffect(e){this.bannerService.applyTextEffect(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Me({type:i,selectors:[["app-sidebar"]],decls:45,vars:9,consts:[[1,"sidebar-toolbox"],[1,"accordion"],["class","accordion-item","open","",4,"ngIf"],["open","",1,"accordion-item"],[1,"material-symbols-outlined","icon"],[1,"material-symbols-outlined","chevron"],[1,"panel-content"],[4,"ngIf"],["class","accordion-item",4,"ngIf"],[1,"accordion-item"],[1,"control-group"],[1,"color-picker-trigger"],["type","color",3,"ngModelChange","ngModel"],[1,"tool-row",2,"margin-top","12px"],[1,"btn-outline-sm",3,"click"],[1,"panel-content","layers-panel"],[1,"layer-item",3,"active"],[1,"custom-select"],[3,"ngModelChange","change","ngModel"],[3,"value"],[1,"material-symbols-outlined"],[1,"control-row-grid"],[1,"control-col"],[1,"input-with-label"],["type","number",3,"ngModelChange","input","ngModel"],["type","color",3,"ngModelChange","input","ngModel"],[1,"button-group"],["title","Align Left",1,"icon-btn",3,"click"],["title","Align Center",1,"icon-btn",3,"click"],["title","Align Right",1,"icon-btn",3,"click"],[1,"tool-row"],["title","Bold",1,"icon-btn",3,"click"],["title","Italic",1,"icon-btn",3,"click"],["title","Underline",1,"icon-btn",3,"click"],[1,"label-row"],["type","range","min","-10","max","100",1,"modern-slider",3,"ngModelChange","input","ngModel"],["type","range","min","0.5","max","3","step","0.1",1,"modern-slider",3,"ngModelChange","input","ngModel"],["type","range","min","1","max","100",1,"modern-slider",3,"ngModelChange","ngModel"],["class","control-group",4,"ngIf"],["type","range","min","0","max","100",1,"modern-slider",3,"ngModelChange","input","ngModel"],[1,"effects-grid"],[1,"effect-card",3,"click"],[1,"tool-row",2,"margin-bottom","12px","flex-wrap","wrap"],[1,"icon-btn-outline",3,"click"],[1,"tool-row",2,"margin-bottom","12px"],["type","range","min","0","max","360",1,"modern-slider",3,"ngModelChange","input","ngModel"],[1,"material-symbols-outlined",2,"transform","rotate(90deg)"],[1,"layer-item",3,"click"],[1,"material-symbols-outlined","type-icon"],[1,"layer-name"],[1,"layer-actions"],[3,"click"]],template:function(t,n){t&1&&(b(0,"aside",0)(1,"div",1),At(2,yv,69,21,"details",2),b(3,"details",3)(4,"summary")(5,"span",4),x(6,"palette"),C(),b(7,"span"),x(8,"Appearance"),C(),b(9,"span",5),x(10,"expand_more"),C()(),b(11,"div",6),At(12,_v,13,5,"div",7)(13,Cv,8,2,"div",7)(14,xv,9,3,"div",7),C()(),At(15,Sv,25,0,"details",8)(16,Dv,46,10,"details",8),b(17,"details",9)(18,"summary")(19,"span",4),x(20,"settings"),C(),b(21,"span"),x(22,"Canvas Settings"),C(),b(23,"span",5),x(24,"expand_more"),C()(),b(25,"div",6)(26,"div",10)(27,"label"),x(28,"Canvas Background"),C(),b(29,"div",11)(30,"input",12),E("ngModelChange",function(o){return n.bannerService.setCanvasBg(o)}),C()()(),b(31,"div",13)(32,"button",14),E("click",function(){return n.bannerService.resetCanvas()}),x(33,"Reset Canvas"),C()()()(),b(34,"details",9)(35,"summary")(36,"span",4),x(37,"layers"),C(),b(38,"span"),x(39,"Canvas Layers"),C(),b(40,"span",5),x(41,"expand_more"),C()(),b(42,"div",15),la(43,Mv,12,5,"div",16,iu),C()()()()),t&2&&(F(2),he("ngIf",(n.currentObject==null?null:n.currentObject.type)==="textbox"),F(10),he("ngIf",n.bannerService.isDrawingMode()),F(),he("ngIf",n.bannerService.isErasing()),F(),he("ngIf",n.currentObject&&!n.bannerService.isDrawingMode()&&!n.bannerService.isErasing()),F(),he("ngIf",(n.currentObject==null?null:n.currentObject.type)==="textbox"),F(),he("ngIf",(n.currentObject==null?null:n.currentObject.type)==="image"),F(13),wn("background-color",n.bannerService.canvasColor()),F(),he("ngModel",n.bannerService.canvasColor()),F(13),ca(n.canvasObjects()))},dependencies:[mt,ti,Hs,zf,Hf,Xr,Oc,Ac,$s,Vs,Yi,Gs,Wf,Xf],styles:['@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Outfit;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqQ4E.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Outfit;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtq.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Outfit;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqQ4E.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Outfit;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtq.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.sidebar-toolbox[_ngcontent-%COMP%]{width:260px;height:100%;background:#fff;border-right:1px solid #e5e7eb;display:flex;flex-direction:column;overflow-y:auto;font-family:Inter,sans-serif;color:#111827}.sidebar-toolbox[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.sidebar-toolbox[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#e5e7eb;border-radius:10px}.accordion-item[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb}.accordion-item[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{padding:16px;list-style:none;display:flex;align-items:center;gap:12px;cursor:pointer;font-weight:600;font-size:14px;color:#111827;transition:background .2s}.accordion-item[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]:hover{background:#f9fafb}.accordion-item[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:20px;color:#6b7280}.accordion-item[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{margin-left:auto;font-size:20px;color:#6b7280;transition:transform .3s}.accordion-item[open][_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transform:rotate(180deg)}.panel-content[_ngcontent-%COMP%]{padding:0 16px 20px;display:flex;flex-direction:column;gap:16px}.control-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.control-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#111827}.control-group[_ngcontent-%COMP%]   .label-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.control-group[_ngcontent-%COMP%]   .label-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#7c3aed}.control-group[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.control-group[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:18px}.control-group[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]   .value-badge[_ngcontent-%COMP%]{margin-left:auto;background:#f5f3ff;color:#7c3aed;padding:2px 6px;border-radius:4px;font-size:11px}.color-picker-trigger[_ngcontent-%COMP%]{width:100%;height:38px;border-radius:8px;border:1px solid #e5e7eb;position:relative;cursor:pointer;overflow:hidden}.color-picker-trigger[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;inset:-5px;width:120%;height:120%;cursor:pointer;opacity:0}.color-picker-trigger[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;border:2px solid white;border-radius:8px}.modern-slider[_ngcontent-%COMP%]{width:100%;height:6px;background:#e5e7eb;border-radius:10px;accent-color:#7c3aed;cursor:pointer;outline:none}.control-row-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.control-row-grid[_ngcontent-%COMP%]   .control-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.control-row-grid[_ngcontent-%COMP%]   .control-col[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.tool-row[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-outline-sm[_ngcontent-%COMP%]{flex:1;height:32px;background:#fff;border:1px solid #e5e7eb;border-radius:6px;font-size:12px;font-weight:600;color:#111827;cursor:pointer;transition:all .2s}.btn-outline-sm[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#d1d5db}.btn-primary-sm[_ngcontent-%COMP%]{flex:1;height:32px;background:#7c3aed;border:none;border-radius:6px;font-size:12px;font-weight:600;color:#fff;cursor:pointer;transition:all .2s}.btn-primary-sm[_ngcontent-%COMP%]:hover{background:#6d28d9}.layers-panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.layer-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:8px;background:#fff;border:1px solid transparent;cursor:pointer;transition:all .2s}.layer-item[_ngcontent-%COMP%]   .type-icon[_ngcontent-%COMP%]{font-size:18px;color:#6b7280}.layer-item[_ngcontent-%COMP%]   .layer-name[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#111827;flex:1}.layer-item[_ngcontent-%COMP%]   .layer-actions[_ngcontent-%COMP%]{display:flex;gap:4px;opacity:0;transition:opacity .2s}.layer-item[_ngcontent-%COMP%]   .layer-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:none;color:#6b7280;cursor:pointer;display:flex;padding:4px;border-radius:4px}.layer-item[_ngcontent-%COMP%]   .layer-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:18px}.layer-item[_ngcontent-%COMP%]   .layer-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#7c3aed;background:#f5f3ff}.layer-item[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#e5e7eb}.layer-item[_ngcontent-%COMP%]:hover   .layer-actions[_ngcontent-%COMP%]{opacity:1}.layer-item.active[_ngcontent-%COMP%]{background:#f5f3ff;border-color:#7c3aed}.layer-item.active[_ngcontent-%COMP%]   .layer-name[_ngcontent-%COMP%]{color:#7c3aed;font-weight:600}.layer-item.active[_ngcontent-%COMP%]   .type-icon[_ngcontent-%COMP%]{color:#7c3aed}.icon-btn[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:#fff;border:1px solid #e5e7eb;border-radius:6px;cursor:pointer;transition:all .2s}.icon-btn[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:20px;color:#6b7280}.icon-btn[_ngcontent-%COMP%]:hover{background:#f9fafb;color:#7c3aed}.icon-btn.active[_ngcontent-%COMP%]{background:#7c3aed;border-color:#7c3aed;color:#fff}.icon-btn.active[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{color:#fff}.icon-btn-outline[_ngcontent-%COMP%]{flex:1;height:38px;display:flex;align-items:center;justify-content:center;gap:8px;background:#fff;border:1px solid #e5e7eb;border-radius:8px;font-size:12px;font-weight:600;color:#111827;cursor:pointer;transition:all .2s}.icon-btn-outline[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:18px}.icon-btn-outline[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#7c3aed;color:#7c3aed}.icon-btn-outline.active[_ngcontent-%COMP%]{background:#f5f3ff;border-color:#7c3aed;color:#7c3aed}.button-group[_ngcontent-%COMP%]{display:flex;gap:6px;flex:1}.effects-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}.effect-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;padding:12px;background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;cursor:pointer;transition:all .2s}.effect-card[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:24px;color:#6b7280}.effect-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#111827}.effect-card[_ngcontent-%COMP%]:hover{border-color:#7c3aed;background:#f5f3ff}.effect-card[_ngcontent-%COMP%]:hover   .material-symbols-outlined[_ngcontent-%COMP%]{color:#7c3aed}.input-with-label[_ngcontent-%COMP%]{position:relative}.input-with-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:38px;padding:0 32px 0 12px;border:1px solid #e5e7eb;border-radius:8px;font-size:13px;font-weight:600;outline:none;background:#fff}.input-with-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#7c3aed}.input-with-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;right:12px;top:10px;font-size:11px;color:#6b7280;font-weight:600}.custom-select[_ngcontent-%COMP%]{position:relative}.custom-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;height:38px;padding:0 32px 0 12px;border:1px solid #e5e7eb;border-radius:8px;font-size:13px;font-weight:600;outline:none;appearance:none;background:#fff}.custom-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#7c3aed}.custom-select[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{position:absolute;right:10px;top:9px;pointer-events:none;color:#6b7280}']})};var Ys=class i{bannerService=A(Mt);selectedObject=this.bannerService.selectedObject;zoomLevel=this.bannerService.zoomLevel;ngAfterViewInit(){this.bannerService.initCanvas("editorCanvas"),this.bannerService.addText("Banner Studio")}zoomIn(){this.bannerService.zoomIn()}zoomOut(){this.bannerService.zoomOut()}resetZoom(){this.bannerService.setZoom(1)}undo(){this.bannerService.undo()}redo(){this.bannerService.redo()}deleteSelected(){this.bannerService.deleteSelected()}handleKeyboardEvent(e){if(e.ctrlKey||e.metaKey)switch(e.key.toLowerCase()){case"z":e.preventDefault(),this.bannerService.undo();break;case"y":e.preventDefault(),this.bannerService.redo();break;case"c":this.bannerService.copy();break;case"v":this.bannerService.paste();break;case"s":e.preventDefault(),this.bannerService.exportToImage("png");break}else switch(e.key){case"Delete":case"Backspace":let n=this.bannerService.canvas?.getActiveObject();n&&(n.type!=="textbox"||!n.isEditing)&&this.bannerService.deleteSelected();break}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Me({type:i,selectors:[["app-canvas-editor"]],hostBindings:function(t,n){t&1&&E("keydown",function(o){return n.handleKeyboardEvent(o)},Zc)},decls:20,vars:1,consts:[[1,"editor-workspace"],[1,"canvas-viewport"],[1,"canvas-board"],["id","editorCanvas"],[1,"bottom-toolbar"],[1,"zoom-controls"],["title","Zoom Out",1,"zoom-btn",3,"click"],[1,"material-symbols-outlined"],[1,"zoom-value"],["title","Zoom In",1,"zoom-btn",3,"click"],[1,"toolbar-divider"],["title","Fit to Screen",1,"fit-btn",3,"click"]],template:function(t,n){t&1&&(tt(0,"main",0)(1,"div",1)(2,"div",2),so(3,"canvas",3),Zt(),tt(4,"div",4)(5,"div",5)(6,"button",6),ao("click",function(){return n.zoomOut()}),tt(7,"span",7),x(8,"remove"),Zt()(),tt(9,"span",8),x(10),Zt(),tt(11,"button",9),ao("click",function(){return n.zoomIn()}),tt(12,"span",7),x(13,"add"),Zt()()(),so(14,"div",10),tt(15,"button",11),ao("click",function(){return n.resetZoom()}),tt(16,"span",7),x(17,"fit_screen"),Zt(),tt(18,"span"),x(19,"Fit to Screen"),Zt()()()()()),t&2&&(F(10),xn("",(n.zoomLevel()*100).toFixed(0),"%"))},dependencies:[mt],styles:['@charset "UTF-8";@layer theme,base,components,utilities;@layer theme{@theme default{ --font-sans: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; --font-serif: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif; --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; --color-red-50: oklch(97.1% .013 17.38); --color-red-100: oklch(93.6% .032 17.717); --color-red-200: oklch(88.5% .062 18.334); --color-red-300: oklch(80.8% .114 19.571); --color-red-400: oklch(70.4% .191 22.216); --color-red-500: oklch(63.7% .237 25.331); --color-red-600: oklch(57.7% .245 27.325); --color-red-700: oklch(50.5% .213 27.518); --color-red-800: oklch(44.4% .177 26.899); --color-red-900: oklch(39.6% .141 25.723); --color-red-950: oklch(25.8% .092 26.042); --color-orange-50: oklch(98% .016 73.684); --color-orange-100: oklch(95.4% .038 75.164); --color-orange-200: oklch(90.1% .076 70.697); --color-orange-300: oklch(83.7% .128 66.29); --color-orange-400: oklch(75% .183 55.934); --color-orange-500: oklch(70.5% .213 47.604); --color-orange-600: oklch(64.6% .222 41.116); --color-orange-700: oklch(55.3% .195 38.402); --color-orange-800: oklch(47% .157 37.304); --color-orange-900: oklch(40.8% .123 38.172); --color-orange-950: oklch(26.6% .079 36.259); --color-amber-50: oklch(98.7% .022 95.277); --color-amber-100: oklch(96.2% .059 95.617); --color-amber-200: oklch(92.4% .12 95.746); --color-amber-300: oklch(87.9% .169 91.605); --color-amber-400: oklch(82.8% .189 84.429); --color-amber-500: oklch(76.9% .188 70.08); --color-amber-600: oklch(66.6% .179 58.318); --color-amber-700: oklch(55.5% .163 48.998); --color-amber-800: oklch(47.3% .137 46.201); --color-amber-900: oklch(41.4% .112 45.904); --color-amber-950: oklch(27.9% .077 45.635); --color-yellow-50: oklch(98.7% .026 102.212); --color-yellow-100: oklch(97.3% .071 103.193); --color-yellow-200: oklch(94.5% .129 101.54); --color-yellow-300: oklch(90.5% .182 98.111); --color-yellow-400: oklch(85.2% .199 91.936); --color-yellow-500: oklch(79.5% .184 86.047); --color-yellow-600: oklch(68.1% .162 75.834); --color-yellow-700: oklch(55.4% .135 66.442); --color-yellow-800: oklch(47.6% .114 61.907); --color-yellow-900: oklch(42.1% .095 57.708); --color-yellow-950: oklch(28.6% .066 53.813); --color-lime-50: oklch(98.6% .031 120.757); --color-lime-100: oklch(96.7% .067 122.328); --color-lime-200: oklch(93.8% .127 124.321); --color-lime-300: oklch(89.7% .196 126.665); --color-lime-400: oklch(84.1% .238 128.85); --color-lime-500: oklch(76.8% .233 130.85); --color-lime-600: oklch(64.8% .2 131.684); --color-lime-700: oklch(53.2% .157 131.589); --color-lime-800: oklch(45.3% .124 130.933); --color-lime-900: oklch(40.5% .101 131.063); --color-lime-950: oklch(27.4% .072 132.109); --color-green-50: oklch(98.2% .018 155.826); --color-green-100: oklch(96.2% .044 156.743); --color-green-200: oklch(92.5% .084 155.995); --color-green-300: oklch(87.1% .15 154.449); --color-green-400: oklch(79.2% .209 151.711); --color-green-500: oklch(72.3% .219 149.579); --color-green-600: oklch(62.7% .194 149.214); --color-green-700: oklch(52.7% .154 150.069); --color-green-800: oklch(44.8% .119 151.328); --color-green-900: oklch(39.3% .095 152.535); --color-green-950: oklch(26.6% .065 152.934); --color-emerald-50: oklch(97.9% .021 166.113); --color-emerald-100: oklch(95% .052 163.051); --color-emerald-200: oklch(90.5% .093 164.15); --color-emerald-300: oklch(84.5% .143 164.978); --color-emerald-400: oklch(76.5% .177 163.223); --color-emerald-500: oklch(69.6% .17 162.48); --color-emerald-600: oklch(59.6% .145 163.225); --color-emerald-700: oklch(50.8% .118 165.612); --color-emerald-800: oklch(43.2% .095 166.913); --color-emerald-900: oklch(37.8% .077 168.94); --color-emerald-950: oklch(26.2% .051 172.552); --color-teal-50: oklch(98.4% .014 180.72); --color-teal-100: oklch(95.3% .051 180.801); --color-teal-200: oklch(91% .096 180.426); --color-teal-300: oklch(85.5% .138 181.071); --color-teal-400: oklch(77.7% .152 181.912); --color-teal-500: oklch(70.4% .14 182.503); --color-teal-600: oklch(60% .118 184.704); --color-teal-700: oklch(51.1% .096 186.391); --color-teal-800: oklch(43.7% .078 188.216); --color-teal-900: oklch(38.6% .063 188.416); --color-teal-950: oklch(27.7% .046 192.524); --color-cyan-50: oklch(98.4% .019 200.873); --color-cyan-100: oklch(95.6% .045 203.388); --color-cyan-200: oklch(91.7% .08 205.041); --color-cyan-300: oklch(86.5% .127 207.078); --color-cyan-400: oklch(78.9% .154 211.53); --color-cyan-500: oklch(71.5% .143 215.221); --color-cyan-600: oklch(60.9% .126 221.723); --color-cyan-700: oklch(52% .105 223.128); --color-cyan-800: oklch(45% .085 224.283); --color-cyan-900: oklch(39.8% .07 227.392); --color-cyan-950: oklch(30.2% .056 229.695); --color-sky-50: oklch(97.7% .013 236.62); --color-sky-100: oklch(95.1% .026 236.824); --color-sky-200: oklch(90.1% .058 230.902); --color-sky-300: oklch(82.8% .111 230.318); --color-sky-400: oklch(74.6% .16 232.661); --color-sky-500: oklch(68.5% .169 237.323); --color-sky-600: oklch(58.8% .158 241.966); --color-sky-700: oklch(50% .134 242.749); --color-sky-800: oklch(44.3% .11 240.79); --color-sky-900: oklch(39.1% .09 240.876); --color-sky-950: oklch(29.3% .066 243.157); --color-blue-50: oklch(97% .014 254.604); --color-blue-100: oklch(93.2% .032 255.585); --color-blue-200: oklch(88.2% .059 254.128); --color-blue-300: oklch(80.9% .105 251.813); --color-blue-400: oklch(70.7% .165 254.624); --color-blue-500: oklch(62.3% .214 259.815); --color-blue-600: oklch(54.6% .245 262.881); --color-blue-700: oklch(48.8% .243 264.376); --color-blue-800: oklch(42.4% .199 265.638); --color-blue-900: oklch(37.9% .146 265.522); --color-blue-950: oklch(28.2% .091 267.935); --color-indigo-50: oklch(96.2% .018 272.314); --color-indigo-100: oklch(93% .034 272.788); --color-indigo-200: oklch(87% .065 274.039); --color-indigo-300: oklch(78.5% .115 274.713); --color-indigo-400: oklch(67.3% .182 276.935); --color-indigo-500: oklch(58.5% .233 277.117); --color-indigo-600: oklch(51.1% .262 276.966); --color-indigo-700: oklch(45.7% .24 277.023); --color-indigo-800: oklch(39.8% .195 277.366); --color-indigo-900: oklch(35.9% .144 278.697); --color-indigo-950: oklch(25.7% .09 281.288); --color-violet-50: oklch(96.9% .016 293.756); --color-violet-100: oklch(94.3% .029 294.588); --color-violet-200: oklch(89.4% .057 293.283); --color-violet-300: oklch(81.1% .111 293.571); --color-violet-400: oklch(70.2% .183 293.541); --color-violet-500: oklch(60.6% .25 292.717); --color-violet-600: oklch(54.1% .281 293.009); --color-violet-700: oklch(49.1% .27 292.581); --color-violet-800: oklch(43.2% .232 292.759); --color-violet-900: oklch(38% .189 293.745); --color-violet-950: oklch(28.3% .141 291.089); --color-purple-50: oklch(97.7% .014 308.299); --color-purple-100: oklch(94.6% .033 307.174); --color-purple-200: oklch(90.2% .063 306.703); --color-purple-300: oklch(82.7% .119 306.383); --color-purple-400: oklch(71.4% .203 305.504); --color-purple-500: oklch(62.7% .265 303.9); --color-purple-600: oklch(55.8% .288 302.321); --color-purple-700: oklch(49.6% .265 301.924); --color-purple-800: oklch(43.8% .218 303.724); --color-purple-900: oklch(38.1% .176 304.987); --color-purple-950: oklch(29.1% .149 302.717); --color-fuchsia-50: oklch(97.7% .017 320.058); --color-fuchsia-100: oklch(95.2% .037 318.852); --color-fuchsia-200: oklch(90.3% .076 319.62); --color-fuchsia-300: oklch(83.3% .145 321.434); --color-fuchsia-400: oklch(74% .238 322.16); --color-fuchsia-500: oklch(66.7% .295 322.15); --color-fuchsia-600: oklch(59.1% .293 322.896); --color-fuchsia-700: oklch(51.8% .253 323.949); --color-fuchsia-800: oklch(45.2% .211 324.591); --color-fuchsia-900: oklch(40.1% .17 325.612); --color-fuchsia-950: oklch(29.3% .136 325.661); --color-pink-50: oklch(97.1% .014 343.198); --color-pink-100: oklch(94.8% .028 342.258); --color-pink-200: oklch(89.9% .061 343.231); --color-pink-300: oklch(82.3% .12 346.018); --color-pink-400: oklch(71.8% .202 349.761); --color-pink-500: oklch(65.6% .241 354.308); --color-pink-600: oklch(59.2% .249 .584); --color-pink-700: oklch(52.5% .223 3.958); --color-pink-800: oklch(45.9% .187 3.815); --color-pink-900: oklch(40.8% .153 2.432); --color-pink-950: oklch(28.4% .109 3.907); --color-rose-50: oklch(96.9% .015 12.422); --color-rose-100: oklch(94.1% .03 12.58); --color-rose-200: oklch(89.2% .058 10.001); --color-rose-300: oklch(81% .117 11.638); --color-rose-400: oklch(71.2% .194 13.428); --color-rose-500: oklch(64.5% .246 16.439); --color-rose-600: oklch(58.6% .253 17.585); --color-rose-700: oklch(51.4% .222 16.935); --color-rose-800: oklch(45.5% .188 13.697); --color-rose-900: oklch(41% .159 10.272); --color-rose-950: oklch(27.1% .105 12.094); --color-slate-50: oklch(98.4% .003 247.858); --color-slate-100: oklch(96.8% .007 247.896); --color-slate-200: oklch(92.9% .013 255.508); --color-slate-300: oklch(86.9% .022 252.894); --color-slate-400: oklch(70.4% .04 256.788); --color-slate-500: oklch(55.4% .046 257.417); --color-slate-600: oklch(44.6% .043 257.281); --color-slate-700: oklch(37.2% .044 257.287); --color-slate-800: oklch(27.9% .041 260.031); --color-slate-900: oklch(20.8% .042 265.755); --color-slate-950: oklch(12.9% .042 264.695); --color-gray-50: oklch(98.5% .002 247.839); --color-gray-100: oklch(96.7% .003 264.542); --color-gray-200: oklch(92.8% .006 264.531); --color-gray-300: oklch(87.2% .01 258.338); --color-gray-400: oklch(70.7% .022 261.325); --color-gray-500: oklch(55.1% .027 264.364); --color-gray-600: oklch(44.6% .03 256.802); --color-gray-700: oklch(37.3% .034 259.733); --color-gray-800: oklch(27.8% .033 256.848); --color-gray-900: oklch(21% .034 264.665); --color-gray-950: oklch(13% .028 261.692); --color-zinc-50: oklch(98.5% 0 0); --color-zinc-100: oklch(96.7% .001 286.375); --color-zinc-200: oklch(92% .004 286.32); --color-zinc-300: oklch(87.1% .006 286.286); --color-zinc-400: oklch(70.5% .015 286.067); --color-zinc-500: oklch(55.2% .016 285.938); --color-zinc-600: oklch(44.2% .017 285.786); --color-zinc-700: oklch(37% .013 285.805); --color-zinc-800: oklch(27.4% .006 286.033); --color-zinc-900: oklch(21% .006 285.885); --color-zinc-950: oklch(14.1% .005 285.823); --color-neutral-50: oklch(98.5% 0 0); --color-neutral-100: oklch(97% 0 0); --color-neutral-200: oklch(92.2% 0 0); --color-neutral-300: oklch(87% 0 0); --color-neutral-400: oklch(70.8% 0 0); --color-neutral-500: oklch(55.6% 0 0); --color-neutral-600: oklch(43.9% 0 0); --color-neutral-700: oklch(37.1% 0 0); --color-neutral-800: oklch(26.9% 0 0); --color-neutral-900: oklch(20.5% 0 0); --color-neutral-950: oklch(14.5% 0 0); --color-stone-50: oklch(98.5% .001 106.423); --color-stone-100: oklch(97% .001 106.424); --color-stone-200: oklch(92.3% .003 48.717); --color-stone-300: oklch(86.9% .005 56.366); --color-stone-400: oklch(70.9% .01 56.259); --color-stone-500: oklch(55.3% .013 58.071); --color-stone-600: oklch(44.4% .011 73.639); --color-stone-700: oklch(37.4% .01 67.558); --color-stone-800: oklch(26.8% .007 34.298); --color-stone-900: oklch(21.6% .006 56.043); --color-stone-950: oklch(14.7% .004 49.25); --color-black: #000; --color-white: #fff; --spacing: .25rem; --breakpoint-sm: 40rem; --breakpoint-md: 48rem; --breakpoint-lg: 64rem; --breakpoint-xl: 80rem; --breakpoint-2xl: 96rem; --container-3xs: 16rem; --container-2xs: 18rem; --container-xs: 20rem; --container-sm: 24rem; --container-md: 28rem; --container-lg: 32rem; --container-xl: 36rem; --container-2xl: 42rem; --container-3xl: 48rem; --container-4xl: 56rem; --container-5xl: 64rem; --container-6xl: 72rem; --container-7xl: 80rem; --text-xs: .75rem; --text-xs--line-height: calc(1 / .75); --text-sm: .875rem; --text-sm--line-height: calc(1.25 / .875); --text-base: 1rem; --text-base--line-height: 1.5 ; --text-lg: 1.125rem; --text-lg--line-height: calc(1.75 / 1.125); --text-xl: 1.25rem; --text-xl--line-height: calc(1.75 / 1.25); --text-2xl: 1.5rem; --text-2xl--line-height: calc(2 / 1.5); --text-3xl: 1.875rem; --text-3xl--line-height: 1.2 ; --text-4xl: 2.25rem; --text-4xl--line-height: calc(2.5 / 2.25); --text-5xl: 3rem; --text-5xl--line-height: 1; --text-6xl: 3.75rem; --text-6xl--line-height: 1; --text-7xl: 4.5rem; --text-7xl--line-height: 1; --text-8xl: 6rem; --text-8xl--line-height: 1; --text-9xl: 8rem; --text-9xl--line-height: 1; --font-weight-thin: 100; --font-weight-extralight: 200; --font-weight-light: 300; --font-weight-normal: 400; --font-weight-medium: 500; --font-weight-semibold: 600; --font-weight-bold: 700; --font-weight-extrabold: 800; --font-weight-black: 900; --tracking-tighter: -.05em; --tracking-tight: -.025em; --tracking-normal: 0em; --tracking-wide: .025em; --tracking-wider: .05em; --tracking-widest: .1em; --leading-tight: 1.25; --leading-snug: 1.375; --leading-normal: 1.5; --leading-relaxed: 1.625; --leading-loose: 2; --radius-xs: .125rem; --radius-sm: .25rem; --radius-md: .375rem; --radius-lg: .5rem; --radius-xl: .75rem; --radius-2xl: 1rem; --radius-3xl: 1.5rem; --radius-4xl: 2rem; --shadow-2xs: 0 1px rgb(0 0 0 / .05); --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / .05); --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1); --shadow-md: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1); --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1); --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1); --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / .25); --inset-shadow-2xs: inset 0 1px rgb(0 0 0 / .05); --inset-shadow-xs: inset 0 1px 1px rgb(0 0 0 / .05); --inset-shadow-sm: inset 0 2px 4px rgb(0 0 0 / .05); --drop-shadow-xs: 0 1px 1px rgb(0 0 0 / .05); --drop-shadow-sm: 0 1px 2px rgb(0 0 0 / .15); --drop-shadow-md: 0 3px 3px rgb(0 0 0 / .12); --drop-shadow-lg: 0 4px 4px rgb(0 0 0 / .15); --drop-shadow-xl: 0 9px 7px rgb(0 0 0 / .1); --drop-shadow-2xl: 0 25px 25px rgb(0 0 0 / .15); --text-shadow-2xs: 0px 1px 0px rgb(0 0 0 / .15); --text-shadow-xs: 0px 1px 1px rgb(0 0 0 / .2); --text-shadow-sm: 0px 1px 0px rgb(0 0 0 / .075), 0px 1px 1px rgb(0 0 0 / .075), 0px 2px 2px rgb(0 0 0 / .075); --text-shadow-md: 0px 1px 1px rgb(0 0 0 / .1), 0px 1px 2px rgb(0 0 0 / .1), 0px 2px 4px rgb(0 0 0 / .1); --text-shadow-lg: 0px 1px 2px rgb(0 0 0 / .1), 0px 3px 2px rgb(0 0 0 / .1), 0px 4px 8px rgb(0 0 0 / .1); --ease-in: cubic-bezier(.4, 0, 1, 1); --ease-out: cubic-bezier(0, 0, .2, 1); --ease-in-out: cubic-bezier(.4, 0, .2, 1); --animate-spin: spin 1s linear infinite; --animate-ping: ping 1s cubic-bezier(0, 0, .2, 1) infinite; --animate-pulse: pulse 2s cubic-bezier(.4, 0, .6, 1) infinite; --animate-bounce: bounce 1s infinite; @keyframes spin { to { transform: rotate(360deg); } } @keyframes ping { 75%, 100% { transform: scale(2); opacity: 0; } } @keyframes pulse { 50% { opacity: .5; } } @keyframes bounce { 0%, 100% { transform: translateY(-25%); animation-timing-function: cubic-bezier(.8, 0, 1, 1); } 50% { transform: none; animation-timing-function: cubic-bezier(0, 0, .2, 1); } } --blur-xs: 4px; --blur-sm: 8px; --blur-md: 12px; --blur-lg: 16px; --blur-xl: 24px; --blur-2xl: 40px; --blur-3xl: 64px; --perspective-dramatic: 100px; --perspective-near: 300px; --perspective-normal: 500px; --perspective-midrange: 800px; --perspective-distant: 1200px; --aspect-video: 16 / 9; --default-transition-duration: .15s; --default-transition-timing-function: cubic-bezier(.4, 0, .2, 1); --default-font-family: --theme(--font-sans, initial); --default-font-feature-settings: --theme( --font-sans--font-feature-settings, initial ); --default-font-variation-settings: --theme( --font-sans--font-variation-settings, initial ); --default-mono-font-family: --theme(--font-mono, initial); --default-mono-font-feature-settings: --theme( --font-mono--font-feature-settings, initial ); --default-mono-font-variation-settings: --theme( --font-mono--font-variation-settings, initial ); }@theme default inline reference{ --blur: 8px; --shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1); --shadow-inner: inset 0 2px 4px 0 rgb(0 0 0 / .05); --drop-shadow: 0 1px 2px rgb(0 0 0 / .1), 0 1px 1px rgb(0 0 0 / .06); --radius: .25rem; --max-width-prose: 65ch; }}@layer base{*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]:before, [_ngcontent-%COMP%]::backdrop, [_ngcontent-%COMP%]::file-selector-button{box-sizing:border-box;margin:0;padding:0;border:0 solid}html[_ngcontent-%COMP%], [_nghost-%COMP%]{line-height:1.5;-webkit-text-size-adjust:100%;tab-size:4;font-family:--theme(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:--theme(--default-font-feature-settings,normal);font-variation-settings:--theme(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}hr[_ngcontent-%COMP%]{height:0;color:inherit;border-top-width:1px}abbr[_ngcontent-%COMP%]:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-size:inherit;font-weight:inherit}a[_ngcontent-%COMP%]{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b[_ngcontent-%COMP%], strong[_ngcontent-%COMP%]{font-weight:bolder}code[_ngcontent-%COMP%], kbd[_ngcontent-%COMP%], samp[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:--theme(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:--theme(--default-mono-font-feature-settings,normal);font-variation-settings:--theme(--default-mono-font-variation-settings,normal);font-size:1em}small[_ngcontent-%COMP%]{font-size:80%}sub[_ngcontent-%COMP%], sup[_ngcontent-%COMP%]{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub[_ngcontent-%COMP%]{bottom:-.25em}sup[_ngcontent-%COMP%]{top:-.5em}table[_ngcontent-%COMP%]{text-indent:0;border-color:inherit;border-collapse:collapse}[_ngcontent-%COMP%]:-moz-focusring{outline:auto}progress[_ngcontent-%COMP%]{vertical-align:baseline}summary[_ngcontent-%COMP%]{display:list-item}ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%], menu[_ngcontent-%COMP%]{list-style:none}img[_ngcontent-%COMP%], svg[_ngcontent-%COMP%], video[_ngcontent-%COMP%], canvas[_ngcontent-%COMP%], audio[_ngcontent-%COMP%], iframe[_ngcontent-%COMP%], embed[_ngcontent-%COMP%], object[_ngcontent-%COMP%]{display:block;vertical-align:middle}img[_ngcontent-%COMP%], video[_ngcontent-%COMP%]{max-width:100%;height:auto}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], optgroup[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], [_ngcontent-%COMP%]::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;border-radius:0;background-color:transparent;opacity:1}:where(select[_ngcontent-%COMP%]:is([multiple],[size]))   optgroup[_ngcontent-%COMP%]{font-weight:bolder}:where(select[_ngcontent-%COMP%]:is([multiple],[size]))   optgroup[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{padding-inline-start:20px}[_ngcontent-%COMP%]::file-selector-button{margin-inline-end:4px}[_ngcontent-%COMP%]::placeholder{opacity:1}@supports (not (-webkit-appearance: -apple-pay-button)) or (contain-intrinsic-size: 1px){[_ngcontent-%COMP%]::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}textarea[_ngcontent-%COMP%]{resize:vertical}[_ngcontent-%COMP%]::-webkit-search-decoration{-webkit-appearance:none}[_ngcontent-%COMP%]::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}[_ngcontent-%COMP%]::-webkit-datetime-edit{display:inline-flex}[_ngcontent-%COMP%]::-webkit-datetime-edit-fields-wrapper{padding:0}[_ngcontent-%COMP%]::-webkit-datetime-edit, [_ngcontent-%COMP%]::-webkit-datetime-edit-year-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-month-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-day-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-hour-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-minute-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-second-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-millisecond-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-meridiem-field{padding-block:0}[_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{line-height:1}[_ngcontent-%COMP%]:-moz-ui-invalid{box-shadow:none}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:where([type=button],[type=reset],[type=submit]), [_ngcontent-%COMP%]::file-selector-button{appearance:button}[_ngcontent-%COMP%]::-webkit-inner-spin-button, [_ngcontent-%COMP%]::-webkit-outer-spin-button{height:auto}[hidden][_ngcontent-%COMP%]:where(:not([hidden=until-found])){display:none!important}}@layer utilities{@tailwind utilities;}@theme{ --color-primary: #832ce8; --color-background-light: #ffffff; --color-background-dark: #0e1318; --font-display: "Outfit", "Inter", sans-serif; --font-sans: "Inter", sans-serif; --radius-lg: .75rem; --radius-xl: 1rem; }@layer base{html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{font-family:Inter,sans-serif;margin:0;padding:0;height:100vh;width:100vw;overflow:hidden}*[_ngcontent-%COMP%]{box-sizing:border-box}app-root[_ngcontent-%COMP%]{display:block;height:100%;width:100%}}.material-symbols-outlined[_ngcontent-%COMP%]{font-variation-settings:"FILL" 0,"wght" 400,"GRAD" 0,"opsz" 24;-webkit-user-select:none;user-select:none}.sidebar-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.sidebar-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#dbd0e7;border-radius:10px}.sidebar-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.sidebar-resizer[_ngcontent-%COMP%]{width:2px;background:#f1f3f5;cursor:col-resize;position:relative;transition:background .2s;display:flex;align-items:center;justify-content:center}.sidebar-resizer[_ngcontent-%COMP%]:hover, .sidebar-resizer.resizing[_ngcontent-%COMP%]{background:#832ce8;width:4px}.sidebar-resizer[_ngcontent-%COMP%]:hover   .resizer-inner[_ngcontent-%COMP%], .sidebar-resizer.resizing[_ngcontent-%COMP%]   .resizer-inner[_ngcontent-%COMP%]{opacity:1}.sidebar-resizer[_ngcontent-%COMP%]   .resizer-inner[_ngcontent-%COMP%]{position:absolute;width:12px;height:24px;background:#fff;border:1px solid #e5e7eb;border-radius:4px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;opacity:0;transition:opacity .2s;box-shadow:0 2px 4px #0000000d}.sidebar-resizer[_ngcontent-%COMP%]   .resizer-inner[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:2px;height:2px;background:#9ca3af;border-radius:50%}.editor-workspace[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;position:relative;background:#f3f4f6;overflow:hidden}.canvas-viewport[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;position:relative;overflow:auto;padding:40px}.canvas-viewport[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.canvas-viewport[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:10px}.canvas-board[_ngcontent-%COMP%]{position:relative;box-shadow:0 10px 30px #00000014;background:#fff;z-index:10;line-height:0}.bottom-toolbar[_ngcontent-%COMP%]{position:absolute;bottom:24px;left:50%;transform:translate(-50%);display:flex;align-items:center;gap:12px;background:#fff;padding:8px 16px;border-radius:12px;box-shadow:0 4px 20px #0000001a;z-index:100}.bottom-toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.bottom-toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;border:1px solid #e5e7eb;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}.bottom-toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:18px;color:#4b5563}.bottom-toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#7c3aed}.bottom-toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]:hover   .material-symbols-outlined[_ngcontent-%COMP%]{color:#7c3aed}.bottom-toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-value[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#111827;min-width:45px;text-align:center}.bottom-toolbar[_ngcontent-%COMP%]   .toolbar-divider[_ngcontent-%COMP%]{width:1px;height:24px;background:#e5e7eb}.bottom-toolbar[_ngcontent-%COMP%]   .fit-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:6px 12px;border:none;background:#f5f3ff;color:#7c3aed;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s}.bottom-toolbar[_ngcontent-%COMP%]   .fit-btn[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:18px}.bottom-toolbar[_ngcontent-%COMP%]   .fit-btn[_ngcontent-%COMP%]:hover{background:#ede9fe}']})};function Ev(i,e){if(i&1){let t=Ue();b(0,"div",12),E("click",function(){let r=L(t).$implicit,o=P();return U(o.applyTemplate(r.image))}),Pe(1,"img",13),b(2,"div",14)(3,"span",15),x(4),C()()()}if(i&2){let t=e.$implicit;F(),he("src",t.image,Kc)("alt",t.name),F(3),kt(t.name)}}var Xs=class i{bannerService=A(Mt);searchQuery=re("");selectedCategory=re("All");templates=[{name:"New Year 2025",category:"Festival",image:"templates/new-year.png"},{name:"Holi Festival",category:"Festival",image:"templates/holi.png"},{name:"Raksha Bandhan",category:"Festival",image:"templates/raksha.png"},{name:"Ganesh Chaturthi",category:"Festival",image:"templates/ganesh.png"},{name:"Bappa",category:"Festival",image:"templates/bappa.png"},{name:"Birthday 1",category:"Personal",image:"templates/bday.png"},{name:"Birthday 2",category:"Personal",image:"templates/bday (2).png"},{name:"Simple Bday 1",category:"Personal",image:"templates/simplebday (1).png"},{name:"Simple Bday 2",category:"Personal",image:"templates/simplebday (2).png"},{name:"Simple Bday 4",category:"Personal",image:"templates/simplebday (4).png"},{name:"Office",category:"Business",image:"templates/office.png"},{name:"Daily Goals",category:"Business",image:"templates/daily-goals.png"},{name:"Stay Inspired",category:"Motivation",image:"templates/stay-inspired.png"},{name:"Announcement",category:"Business",image:"templates/announcement.png"},{name:"Wedding",category:"Personal",image:"templates/wedding.png"},{name:"Maharashtra",category:"Festival",image:"templates/maharashtra.png"},{name:"Resume",category:"Business",image:"templates/Resume.png"},{name:"Beige Simple",category:"Business",image:"templates/Beige Simple Watercolor Background Notes A4 Document.png"},{name:"Blue White",category:"Business",image:"templates/Blue and White Simple Abstract Page Border.png"}];filteredTemplates=Sn(()=>{let e=this.searchQuery().toLowerCase(),t=this.selectedCategory();return this.templates.filter(n=>{let r=n.name.toLowerCase().includes(e),o=t==="All"||n.category===t;return r&&o})});setCategory(e){this.selectedCategory.set(e)}applyTemplate(e){this.bannerService.addImage(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Me({type:i,selectors:[["app-templates-panel"]],decls:23,vars:12,consts:[[1,"templates-panel"],[1,"panel-header-search"],[1,"panel-title"],[1,"search-box-wrapper"],[1,"material-symbols-outlined","search-icon"],["type","text","placeholder","Search templates...",1,"search-input",3,"ngModelChange","ngModel"],[1,"panel-content-wrapper"],[1,"category-tabs-row"],[1,"cat-chip",3,"click"],[1,"template-grid-scroll"],[1,"template-grid-modern"],["class","template-card-modern",3,"click",4,"ngFor","ngForOf"],[1,"template-card-modern",3,"click"],[1,"template-img",3,"src","alt"],[1,"template-placeholder-colored"],[1,"template-label"]],template:function(t,n){t&1&&(b(0,"div",0)(1,"div",1)(2,"h2",2),x(3,"Templates"),C(),b(4,"div",3)(5,"span",4),x(6,"search"),C(),b(7,"input",5),E("ngModelChange",function(o){return n.searchQuery.set(o)}),C()()(),b(8,"div",6)(9,"div",7)(10,"button",8),E("click",function(){return n.setCategory("All")}),x(11,"All"),C(),b(12,"button",8),E("click",function(){return n.setCategory("Festival")}),x(13,"Festival"),C(),b(14,"button",8),E("click",function(){return n.setCategory("Business")}),x(15,"Business"),C(),b(16,"button",8),E("click",function(){return n.setCategory("Personal")}),x(17,"Personal"),C(),b(18,"button",8),E("click",function(){return n.setCategory("Motivation")}),x(19,"Motivation"),C()(),b(20,"div",9)(21,"div",10),At(22,Ev,5,3,"div",11),C()()()()),t&2&&(F(7),he("ngModel",n.searchQuery()),F(3),Z("active",n.selectedCategory()==="All"),F(2),Z("active",n.selectedCategory()==="Festival"),F(2),Z("active",n.selectedCategory()==="Business"),F(2),Z("active",n.selectedCategory()==="Personal"),F(2),Z("active",n.selectedCategory()==="Motivation"),F(4),he("ngForOf",n.filteredTemplates()))},dependencies:[mt,fo,Gs,Hs,Xr,Vs,Yi],styles:[".templates-panel[_ngcontent-%COMP%]{width:260px;height:100%;background:#fff;border-left:1px solid #e5e7eb;display:flex;flex-direction:column;overflow:hidden;font-family:Inter,sans-serif}.panel-header-search[_ngcontent-%COMP%]{padding:20px 16px 12px;display:flex;flex-direction:column;gap:12px}.panel-header-search[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%]{font-family:Outfit,sans-serif;font-size:16px;font-weight:700;color:#111827;margin:0}.panel-header-search[_ngcontent-%COMP%]   .search-box-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.panel-header-search[_ngcontent-%COMP%]   .search-box-wrapper[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:10px;font-size:18px;color:#6b7280}.panel-header-search[_ngcontent-%COMP%]   .search-box-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:8px 12px 8px 36px;border:1px solid #e5e7eb;border-radius:8px;font-size:13px;background:#f9fafb;outline:none;transition:border-color .2s}.panel-header-search[_ngcontent-%COMP%]   .search-box-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{border-color:#7c3aed;background:#fff}.panel-content-wrapper[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}.category-tabs-row[_ngcontent-%COMP%]{display:flex;padding:0 16px 12px;gap:8px;overflow-x:auto;scrollbar-width:none}.category-tabs-row[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.category-tabs-row[_ngcontent-%COMP%]   .cat-chip[_ngcontent-%COMP%]{padding:6px 14px;font-size:12px;font-weight:600;background:#f3f4f6;border:none;border-radius:20px;color:#6b7280;cursor:pointer;white-space:nowrap;transition:all .2s}.category-tabs-row[_ngcontent-%COMP%]   .cat-chip[_ngcontent-%COMP%]:hover{background:#e5e7eb}.category-tabs-row[_ngcontent-%COMP%]   .cat-chip.active[_ngcontent-%COMP%]{background:#7c3aed;color:#fff}.template-grid-scroll[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:0 16px 20px}.template-grid-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.template-grid-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#e5e7eb;border-radius:10px}.template-grid-modern[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}.template-card-modern[_ngcontent-%COMP%]{position:relative;border-radius:8px;overflow:hidden;cursor:pointer;background:#f3f4f6;aspect-ratio:1;transition:transform .2s}.template-card-modern[_ngcontent-%COMP%]   .template-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.template-card-modern[_ngcontent-%COMP%]   .template-placeholder-colored[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center}.template-card-modern[_ngcontent-%COMP%]   .template-placeholder-colored[_ngcontent-%COMP%]   .template-label[_ngcontent-%COMP%]{position:absolute;bottom:8px;left:8px;right:8px;background:#00000080;color:#fff;font-size:9px;font-weight:700;padding:4px;border-radius:4px;text-align:center}.template-card-modern[_ngcontent-%COMP%]:hover{transform:scale(1.03);box-shadow:0 4px 12px #0000001a}"]})};var qs=class i{title=re("BannerStudio");sidebarWidth=280;isResizing=!1;startResizing(e){this.isResizing=!0,e.preventDefault()}onResizing(e){if(this.isResizing){let t=e.clientX;t>150&&t<600&&(this.sidebarWidth=t)}}stopResizing(){this.isResizing=!1}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Me({type:i,selectors:[["app-root"]],decls:12,vars:2,consts:[[1,"editor-shell"],[1,"top-nav"],[1,"main-layout"],[1,"sidebar-resizer",3,"mousedown"],[1,"resizer-inner"],[1,"center-content",3,"mousemove","mouseup"]],template:function(t,n){t&1&&(b(0,"div",0),Pe(1,"app-toolbar",1),b(2,"div",2),Pe(3,"app-sidebar"),b(4,"div",3),E("mousedown",function(o){return n.startResizing(o)}),b(5,"div",4),Pe(6,"span")(7,"span")(8,"span"),C()(),b(9,"div",5),E("mousemove",function(o){return n.onResizing(o)})("mouseup",function(){return n.stopResizing()}),Pe(10,"app-canvas-editor"),C(),Pe(11,"app-templates-panel"),C()()),t&2&&(F(3),wn("width",n.sidebarWidth,"px"))},dependencies:[Rs,Ws,Ys,Xs],styles:[".editor-shell[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;width:100vw;overflow:hidden;background:#fff}.top-nav[_ngcontent-%COMP%]{flex-shrink:0;z-index:1000}.main-layout[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1;min-height:0;position:relative;overflow:hidden}app-sidebar[_ngcontent-%COMP%]{display:block;height:100%;z-index:10;flex-shrink:0}.sidebar-resizer[_ngcontent-%COMP%]{width:4px;background:#f1f3f5;cursor:col-resize;position:relative;transition:background .2s;z-index:20}.sidebar-resizer[_ngcontent-%COMP%]:hover{background:#7c3aed}.center-content[_ngcontent-%COMP%]{flex:1;min-width:0;height:100%;display:flex;flex-direction:column;overflow:hidden;position:relative;background:#f3f4f6}app-templates-panel[_ngcontent-%COMP%]{display:block;width:260px;height:100%;flex-shrink:0;z-index:10}"]})};_a(qs,xh).catch(i=>console.error(i));
